<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>计算机图形学</title>
      <link href="/2022/11/24/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9B%BE%E5%BD%A2%E5%AD%A6/"/>
      <url>/2022/11/24/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9B%BE%E5%BD%A2%E5%AD%A6/</url>
      
        <content type="html"><![CDATA[<h2 id="计算机图形学"><a href="#计算机图形学" class="headerlink" title="计算机图形学"></a>计算机图形学</h2>]]></content>
      
      
      <categories>
          
          <category> 图形学 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 图形学 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hexo可视化脚本</title>
      <link href="/2022/11/07/Hexo%E5%8F%AF%E8%A7%86%E5%8C%96%E8%84%9A%E6%9C%AC/"/>
      <url>/2022/11/07/Hexo%E5%8F%AF%E8%A7%86%E5%8C%96%E8%84%9A%E6%9C%AC/</url>
      
        <content type="html"><![CDATA[<h1 id="Hexo可视化脚本"><a href="#Hexo可视化脚本" class="headerlink" title="Hexo可视化脚本"></a>Hexo可视化脚本</h1><p>由于每次都需要切换到Hexo目录，在CMD输入Hexo指令，为了简化该操作，使用了Python自带的tkinter简单的开发了一款可视化界面！！！</p><img src="/images/Hexo%E5%8F%AF%E8%A7%86%E5%8C%96%E8%84%9A%E6%9C%AC/image-20221107120308554.png" alt="Hexo可视化脚本效果图" style="zoom: 40%;" /><p>Tkinter是Python GUI界面开发的库，并不需要额外引入相关库</p><p>博客链接：<a href="https://wxydaydayup.github.io/2022/11/07/Hexo%E5%8F%AF%E8%A7%86%E5%8C%96%E8%84%9A%E6%9C%AC/">Hexo可视化脚本 | Wxy’s blogs </a></p><p>代码仓库：<a href="https://github.com/wxydaydayup/HexoPanel">Hexo可视化控制台(自制)</a></p><h3 id="一、引入相关库，并构建主界面"><a href="#一、引入相关库，并构建主界面" class="headerlink" title="一、引入相关库，并构建主界面"></a>一、引入相关库，并构建主界面</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> tkinter <span class="token keyword">as</span> tk  <span class="token comment"># 导入Tkinter</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    <span class="token comment"># 建立主窗口</span>    root <span class="token operator">=</span> tk<span class="token punctuation">.</span>Tk<span class="token punctuation">(</span><span class="token punctuation">)</span>    mytitle <span class="token operator">=</span> <span class="token string">'hexo控制台'</span>    root<span class="token punctuation">.</span>title<span class="token punctuation">(</span>mytitle<span class="token punctuation">)</span>    root<span class="token punctuation">.</span>geometry<span class="token punctuation">(</span><span class="token string">'&#123;&#125;x&#123;&#125;+&#123;&#125;+&#123;&#125;'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token number">700</span><span class="token punctuation">,</span> <span class="token number">600</span><span class="token punctuation">,</span> <span class="token number">400</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token comment"># 进入Tkinter消息循环</span>    root<span class="token punctuation">.</span>mainloop<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>效果如图所示：</p><img src="/images/Hexo%E5%8F%AF%E8%A7%86%E5%8C%96%E8%84%9A%E6%9C%AC/image-20221108094922069.png" alt="构建主页面" style="zoom:40%;" /><h3 id="二、添加输入框、确定和草稿按钮"><a href="#二、添加输入框、确定和草稿按钮" class="headerlink" title="二、添加输入框、确定和草稿按钮"></a>二、添加输入框、确定和草稿按钮</h3><ul><li>实现Print重定向到Tkinter(StdoutRedirector是重定向位置，打印框下一步骤添加)</li><li>添加新建文件输入框、确定按钮、草稿按钮</li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> tkinter <span class="token keyword">as</span> tk  <span class="token comment"># 导入Tkinter</span><span class="token keyword">from</span> tkinter<span class="token punctuation">.</span>scrolledtext <span class="token keyword">import</span> ScrolledText  <span class="token comment"># 导入ScrolledText</span>rootDir <span class="token operator">=</span> <span class="token string">"F:/MyBlog"</span> <span class="token comment">#这个需要改成自己Hexo的根目录</span><span class="token comment"># Print重定向类</span><span class="token keyword">class</span> <span class="token class-name">StdoutRedirector</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> ScrolledText<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>text_space <span class="token operator">=</span> ScrolledText        <span class="token comment"># 备份</span>        self<span class="token punctuation">.</span>stdoutbak <span class="token operator">=</span> sys<span class="token punctuation">.</span>stdout        self<span class="token punctuation">.</span>stderrbak <span class="token operator">=</span> sys<span class="token punctuation">.</span>stderr    <span class="token keyword">def</span> <span class="token function">write</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>text_space<span class="token punctuation">.</span>insert<span class="token punctuation">(</span>tk<span class="token punctuation">.</span>END<span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>text_space<span class="token punctuation">.</span>see<span class="token punctuation">(</span>tk<span class="token punctuation">.</span>END<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>text_space<span class="token punctuation">.</span>update<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 刷新显示</span>    <span class="token comment"># 还原</span>    <span class="token keyword">def</span> <span class="token function">restoreStd</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        sys<span class="token punctuation">.</span>stdout <span class="token operator">=</span> self<span class="token punctuation">.</span>stdoutbak        sys<span class="token punctuation">.</span>stderr <span class="token operator">=</span> self<span class="token punctuation">.</span>stderrbak    <span class="token comment"># 这个类必须得有，不然会报错</span>    <span class="token keyword">def</span> <span class="token function">flush</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">pass</span><span class="token keyword">def</span> <span class="token function">sh</span><span class="token punctuation">(</span>command<span class="token punctuation">)</span><span class="token punctuation">:</span>    p <span class="token operator">=</span> subprocess<span class="token punctuation">.</span>Popen<span class="token punctuation">(</span>command<span class="token punctuation">,</span> shell<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> stdout<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>PIPE<span class="token punctuation">)</span>     <span class="token comment">#如需要将打印信息打印到tkinter，则取消下面注释。若出现乱码问题，换为GDK编码</span>    <span class="token comment"># lines = []</span>    <span class="token comment"># for line in iter(p.stdout.readline, b''):</span>    <span class="token comment">#     line = line.strip().decode("utf-8","ignore")</span>    <span class="token comment">#     print(">>>", line)</span>    <span class="token comment">#     lines.append(line)</span>    <span class="token comment"># return lines</span><span class="token keyword">def</span> <span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>       <span class="token comment"># 新建</span>    last <span class="token operator">=</span> NameEntry<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span>                    <span class="token comment"># 获取输入框内容</span>    output <span class="token operator">=</span> sys<span class="token punctuation">.</span>stdout                       <span class="token comment"># 备份</span>    sys<span class="token punctuation">.</span>stdout <span class="token operator">=</span> StdoutRedirector<span class="token punctuation">(</span>textMess<span class="token punctuation">)</span>   <span class="token comment"># Print重定向类</span>    os<span class="token punctuation">.</span>chdir<span class="token punctuation">(</span>rootDir<span class="token punctuation">)</span>     sh<span class="token punctuation">(</span><span class="token string">"hexo new "</span><span class="token operator">+</span>last<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>last<span class="token operator">+</span><span class="token string">" 新建成功"</span><span class="token punctuation">)</span>    sys<span class="token punctuation">.</span>stdout <span class="token operator">=</span> output                       <span class="token comment"># 恢复到备份</span><span class="token keyword">def</span> <span class="token function">newDraft</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># 新建草稿</span>    last <span class="token operator">=</span> NameEntry<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span>                    <span class="token comment"># 获取输入框内容</span>    output <span class="token operator">=</span> sys<span class="token punctuation">.</span>stdout                       <span class="token comment"># 备份</span>    sys<span class="token punctuation">.</span>stdout <span class="token operator">=</span> StdoutRedirector<span class="token punctuation">(</span>textMess<span class="token punctuation">)</span>   <span class="token comment"># Print重定向类</span>    os<span class="token punctuation">.</span>chdir<span class="token punctuation">(</span>rootDir<span class="token punctuation">)</span>     sh<span class="token punctuation">(</span><span class="token string">"hexo new draft"</span><span class="token operator">+</span>last<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>last<span class="token operator">+</span><span class="token string">" 新建草稿成功"</span><span class="token punctuation">)</span>    sys<span class="token punctuation">.</span>stdout <span class="token operator">=</span> output                        <span class="token comment"># 恢复到备份</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    <span class="token comment"># 建立主窗口</span>    root <span class="token operator">=</span> tk<span class="token punctuation">.</span>Tk<span class="token punctuation">(</span><span class="token punctuation">)</span>    mytitle <span class="token operator">=</span> <span class="token string">'hexo控制台'</span>    root<span class="token punctuation">.</span>title<span class="token punctuation">(</span>mytitle<span class="token punctuation">)</span>    root<span class="token punctuation">.</span>geometry<span class="token punctuation">(</span><span class="token string">'&#123;&#125;x&#123;&#125;+&#123;&#125;+&#123;&#125;'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token number">700</span><span class="token punctuation">,</span> <span class="token number">600</span><span class="token punctuation">,</span> <span class="token number">400</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment"># 新建文件输入框</span>    frame <span class="token operator">=</span> tk<span class="token punctuation">.</span>Frame<span class="token punctuation">(</span>root<span class="token punctuation">)</span>    lb <span class="token operator">=</span> tk<span class="token punctuation">.</span>Label<span class="token punctuation">(</span>frame<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">'新建文件名:'</span><span class="token punctuation">,</span>font<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'楷体'</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">13</span><span class="token punctuation">,</span> height<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>    NameEntry <span class="token operator">=</span> tk<span class="token punctuation">.</span>Entry<span class="token punctuation">(</span>frame<span class="token punctuation">,</span> font<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'楷体'</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">23</span><span class="token punctuation">)</span>    <span class="token comment"># 确定按钮与草稿按钮</span>    updateButton <span class="token operator">=</span> tk<span class="token punctuation">.</span>Button<span class="token punctuation">(</span>frame<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">'确定'</span><span class="token punctuation">,</span> font<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'楷体'</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span> height<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>    draftButton <span class="token operator">=</span> tk<span class="token punctuation">.</span>Button<span class="token punctuation">(</span>frame<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">'草稿'</span><span class="token punctuation">,</span> font<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'楷体'</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span> height<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>    updateButton<span class="token punctuation">[</span><span class="token string">'command'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">lambda</span><span class="token punctuation">:</span> new<span class="token punctuation">(</span><span class="token punctuation">)</span>    draftButton<span class="token punctuation">[</span><span class="token string">'command'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">lambda</span><span class="token punctuation">:</span> newDraft<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token comment"># 新建文件输入框、确定按钮与草稿按钮的布局</span>    lb<span class="token punctuation">.</span>pack<span class="token punctuation">(</span>side<span class="token operator">=</span>tk<span class="token punctuation">.</span>LEFT<span class="token punctuation">)</span>    NameEntry<span class="token punctuation">.</span>pack<span class="token punctuation">(</span>side<span class="token operator">=</span>tk<span class="token punctuation">.</span>LEFT<span class="token punctuation">)</span>    updateButton<span class="token punctuation">.</span>pack<span class="token punctuation">(</span>side<span class="token operator">=</span>tk<span class="token punctuation">.</span>LEFT<span class="token punctuation">,</span>padx<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span>    draftButton<span class="token punctuation">.</span>pack<span class="token punctuation">(</span>side<span class="token operator">=</span>tk<span class="token punctuation">.</span>LEFT<span class="token punctuation">)</span>    frame<span class="token punctuation">.</span>pack<span class="token punctuation">(</span>side<span class="token operator">=</span>tk<span class="token punctuation">.</span>TOP<span class="token punctuation">,</span> fill<span class="token operator">=</span>tk<span class="token punctuation">.</span>BOTH<span class="token punctuation">)</span>    <span class="token comment"># 进入Tkinter消息循环</span>    root<span class="token punctuation">.</span>mainloop<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>效果如图所示：</p><img src="/images/Hexo%E5%8F%AF%E8%A7%86%E5%8C%96%E8%84%9A%E6%9C%AC/image-20221108095140843.png" alt="添加输入框" style="zoom:40%;" /><h3 id="三、添加ScrolledText作为打印框"><a href="#三、添加ScrolledText作为打印框" class="headerlink" title="三、添加ScrolledText作为打印框"></a>三、添加ScrolledText作为打印框</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> tkinter <span class="token keyword">as</span> tk  <span class="token comment"># 导入Tkinter</span><span class="token keyword">from</span> tkinter<span class="token punctuation">.</span>scrolledtext <span class="token keyword">import</span> ScrolledText  <span class="token comment"># 导入ScrolledText</span>rootDir <span class="token operator">=</span> <span class="token string">"F:/MyBlog"</span> <span class="token comment">#这个需要改成自己Hexo的根目录</span><span class="token comment"># Print重定向类</span><span class="token keyword">class</span> <span class="token class-name">StdoutRedirector</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> ScrolledText<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>text_space <span class="token operator">=</span> ScrolledText        <span class="token comment"># 备份</span>        self<span class="token punctuation">.</span>stdoutbak <span class="token operator">=</span> sys<span class="token punctuation">.</span>stdout        self<span class="token punctuation">.</span>stderrbak <span class="token operator">=</span> sys<span class="token punctuation">.</span>stderr    <span class="token keyword">def</span> <span class="token function">write</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>text_space<span class="token punctuation">.</span>insert<span class="token punctuation">(</span>tk<span class="token punctuation">.</span>END<span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>text_space<span class="token punctuation">.</span>see<span class="token punctuation">(</span>tk<span class="token punctuation">.</span>END<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>text_space<span class="token punctuation">.</span>update<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 刷新显示</span>    <span class="token comment"># 还原</span>    <span class="token keyword">def</span> <span class="token function">restoreStd</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        sys<span class="token punctuation">.</span>stdout <span class="token operator">=</span> self<span class="token punctuation">.</span>stdoutbak        sys<span class="token punctuation">.</span>stderr <span class="token operator">=</span> self<span class="token punctuation">.</span>stderrbak    <span class="token comment"># 这个类必须得有，不然会报错</span>    <span class="token keyword">def</span> <span class="token function">flush</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">pass</span><span class="token keyword">def</span> <span class="token function">sh</span><span class="token punctuation">(</span>command<span class="token punctuation">)</span><span class="token punctuation">:</span>    p <span class="token operator">=</span> subprocess<span class="token punctuation">.</span>Popen<span class="token punctuation">(</span>command<span class="token punctuation">,</span> shell<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> stdout<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>PIPE<span class="token punctuation">)</span>     <span class="token comment">#如需要将打印信息打印到tkinter，则取消下面注释。若出现乱码问题，换为GDK编码</span>    <span class="token comment"># lines = []</span>    <span class="token comment"># for line in iter(p.stdout.readline, b''):</span>    <span class="token comment">#     line = line.strip().decode("utf-8","ignore")</span>    <span class="token comment">#     print(">>>", line)</span>    <span class="token comment">#     lines.append(line)</span>    <span class="token comment"># return lines</span><span class="token keyword">def</span> <span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>       <span class="token comment"># 新建</span>    last <span class="token operator">=</span> NameEntry<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span>                    <span class="token comment"># 获取输入框内容</span>    output <span class="token operator">=</span> sys<span class="token punctuation">.</span>stdout                       <span class="token comment"># 备份</span>    sys<span class="token punctuation">.</span>stdout <span class="token operator">=</span> StdoutRedirector<span class="token punctuation">(</span>textMess<span class="token punctuation">)</span>   <span class="token comment"># Print重定向类</span>    os<span class="token punctuation">.</span>chdir<span class="token punctuation">(</span>rootDir<span class="token punctuation">)</span>     sh<span class="token punctuation">(</span><span class="token string">"hexo new "</span><span class="token operator">+</span>last<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>last<span class="token operator">+</span><span class="token string">" 新建成功"</span><span class="token punctuation">)</span>    sys<span class="token punctuation">.</span>stdout <span class="token operator">=</span> output                       <span class="token comment"># 恢复到备份</span><span class="token keyword">def</span> <span class="token function">newDraft</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># 新建草稿</span>    last <span class="token operator">=</span> NameEntry<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span>                    <span class="token comment"># 获取输入框内容</span>    output <span class="token operator">=</span> sys<span class="token punctuation">.</span>stdout                       <span class="token comment"># 备份</span>    sys<span class="token punctuation">.</span>stdout <span class="token operator">=</span> StdoutRedirector<span class="token punctuation">(</span>textMess<span class="token punctuation">)</span>   <span class="token comment"># Print重定向类</span>    os<span class="token punctuation">.</span>chdir<span class="token punctuation">(</span>rootDir<span class="token punctuation">)</span>     sh<span class="token punctuation">(</span><span class="token string">"hexo new draft"</span><span class="token operator">+</span>last<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>last<span class="token operator">+</span><span class="token string">" 新建草稿成功"</span><span class="token punctuation">)</span>    sys<span class="token punctuation">.</span>stdout <span class="token operator">=</span> output                        <span class="token comment"># 恢复到备份</span><span class="token keyword">def</span> <span class="token function">clearMess</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># 清空打印</span>    <span class="token keyword">global</span> textMess    textMess<span class="token punctuation">.</span>delete<span class="token punctuation">(</span><span class="token number">1.0</span><span class="token punctuation">,</span> tk<span class="token punctuation">.</span>END<span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    <span class="token comment"># 建立主窗口</span>    root <span class="token operator">=</span> tk<span class="token punctuation">.</span>Tk<span class="token punctuation">(</span><span class="token punctuation">)</span>    mytitle <span class="token operator">=</span> <span class="token string">'hexo控制台'</span>    root<span class="token punctuation">.</span>title<span class="token punctuation">(</span>mytitle<span class="token punctuation">)</span>    root<span class="token punctuation">.</span>geometry<span class="token punctuation">(</span><span class="token string">'&#123;&#125;x&#123;&#125;+&#123;&#125;+&#123;&#125;'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token number">700</span><span class="token punctuation">,</span> <span class="token number">600</span><span class="token punctuation">,</span> <span class="token number">400</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token comment"># 新建文件输入框</span>    frame <span class="token operator">=</span> tk<span class="token punctuation">.</span>Frame<span class="token punctuation">(</span>root<span class="token punctuation">)</span>    lb <span class="token operator">=</span> tk<span class="token punctuation">.</span>Label<span class="token punctuation">(</span>frame<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">'新建文件名:'</span><span class="token punctuation">,</span>font<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'楷体'</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">13</span><span class="token punctuation">,</span> height<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>    NameEntry <span class="token operator">=</span> tk<span class="token punctuation">.</span>Entry<span class="token punctuation">(</span>frame<span class="token punctuation">,</span> font<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'楷体'</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">23</span><span class="token punctuation">)</span>    <span class="token comment"># 确定按钮与草稿按钮</span>    updateButton <span class="token operator">=</span> tk<span class="token punctuation">.</span>Button<span class="token punctuation">(</span>frame<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">'确定'</span><span class="token punctuation">,</span> font<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'楷体'</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span> height<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>    draftButton <span class="token operator">=</span> tk<span class="token punctuation">.</span>Button<span class="token punctuation">(</span>frame<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">'草稿'</span><span class="token punctuation">,</span> font<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'楷体'</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span> height<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>    updateButton<span class="token punctuation">[</span><span class="token string">'command'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">lambda</span><span class="token punctuation">:</span> new<span class="token punctuation">(</span><span class="token punctuation">)</span>    draftButton<span class="token punctuation">[</span><span class="token string">'command'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">lambda</span><span class="token punctuation">:</span> newDraft<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token comment"># 新建文件输入框、确定按钮与草稿按钮的布局</span>    lb<span class="token punctuation">.</span>pack<span class="token punctuation">(</span>side<span class="token operator">=</span>tk<span class="token punctuation">.</span>LEFT<span class="token punctuation">)</span>    NameEntry<span class="token punctuation">.</span>pack<span class="token punctuation">(</span>side<span class="token operator">=</span>tk<span class="token punctuation">.</span>LEFT<span class="token punctuation">)</span>    updateButton<span class="token punctuation">.</span>pack<span class="token punctuation">(</span>side<span class="token operator">=</span>tk<span class="token punctuation">.</span>LEFT<span class="token punctuation">,</span>padx<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span>    draftButton<span class="token punctuation">.</span>pack<span class="token punctuation">(</span>side<span class="token operator">=</span>tk<span class="token punctuation">.</span>LEFT<span class="token punctuation">)</span>    frame<span class="token punctuation">.</span>pack<span class="token punctuation">(</span>side<span class="token operator">=</span>tk<span class="token punctuation">.</span>TOP<span class="token punctuation">,</span> fill<span class="token operator">=</span>tk<span class="token punctuation">.</span>BOTH<span class="token punctuation">)</span>        <span class="token comment">#为信息框设置一个容器作为信息输出窗口</span>    <span class="token keyword">global</span> textMess    frame2 <span class="token operator">=</span> tk<span class="token punctuation">.</span>LabelFrame<span class="token punctuation">(</span>root<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">'打印信息'</span><span class="token punctuation">,</span> height<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>    textMess <span class="token operator">=</span> ScrolledText<span class="token punctuation">(</span>frame2<span class="token punctuation">,</span> bg<span class="token operator">=</span><span class="token string">'white'</span><span class="token punctuation">,</span> height<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span>    textMess<span class="token punctuation">.</span>pack<span class="token punctuation">(</span>fill<span class="token operator">=</span>tk<span class="token punctuation">.</span>BOTH<span class="token punctuation">,</span> expand<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>    clearMessbutton <span class="token operator">=</span> tk<span class="token punctuation">.</span>Button<span class="token punctuation">(</span>frame2<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">'清空信息'</span><span class="token punctuation">,</span> font<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'楷体'</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">7</span><span class="token punctuation">,</span> height<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>    clearMessbutton<span class="token punctuation">.</span>pack<span class="token punctuation">(</span>anchor<span class="token operator">=</span><span class="token string">'se'</span><span class="token punctuation">)</span>    clearMessbutton<span class="token punctuation">[</span><span class="token string">'command'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">lambda</span><span class="token punctuation">:</span> clearMess<span class="token punctuation">(</span><span class="token punctuation">)</span>         <span class="token comment">#清空打印</span>    frame2<span class="token punctuation">.</span>pack<span class="token punctuation">(</span>fill<span class="token operator">=</span>tk<span class="token punctuation">.</span>BOTH<span class="token punctuation">,</span> expand<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>    <span class="token comment"># 进入Tkinter消息循环</span>    root<span class="token punctuation">.</span>mainloop<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>效果如图所示：</p><img src="/images/Hexo%E5%8F%AF%E8%A7%86%E5%8C%96%E8%84%9A%E6%9C%AC/image-20221108101447437.png" alt="添加打印框" style="zoom:40%;" /><h3 id="四、添加刷新，网址、发布、位置按钮"><a href="#四、添加刷新，网址、发布、位置按钮" class="headerlink" title="四、添加刷新，网址、发布、位置按钮"></a>四、添加刷新，网址、发布、位置按钮</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> tkinter <span class="token keyword">as</span> tk  <span class="token comment"># 导入Tkinter</span><span class="token keyword">from</span> tkinter<span class="token punctuation">.</span>scrolledtext <span class="token keyword">import</span> ScrolledText  <span class="token comment"># 导入ScrolledText</span><span class="token keyword">import</span> webbrowser<span class="token keyword">import</span> subprocess<span class="token keyword">import</span> signal<span class="token keyword">import</span> sys<span class="token keyword">import</span> osrootDir <span class="token operator">=</span> <span class="token string">"F:/MyBlog"</span> <span class="token comment">#这个需要改成自己Hexo的根目录</span><span class="token keyword">class</span> <span class="token class-name">StdoutRedirector</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># Print重定向类</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> ScrolledText<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>text_space <span class="token operator">=</span> ScrolledText        <span class="token comment"># 备份</span>        self<span class="token punctuation">.</span>stdoutbak <span class="token operator">=</span> sys<span class="token punctuation">.</span>stdout        self<span class="token punctuation">.</span>stderrbak <span class="token operator">=</span> sys<span class="token punctuation">.</span>stderr    <span class="token keyword">def</span> <span class="token function">write</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>text_space<span class="token punctuation">.</span>insert<span class="token punctuation">(</span>tk<span class="token punctuation">.</span>END<span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>text_space<span class="token punctuation">.</span>see<span class="token punctuation">(</span>tk<span class="token punctuation">.</span>END<span class="token punctuation">)</span>        <span class="token comment"># 刷新显示</span>        self<span class="token punctuation">.</span>text_space<span class="token punctuation">.</span>update<span class="token punctuation">(</span><span class="token punctuation">)</span>     <span class="token comment"># 还原</span>    <span class="token keyword">def</span> <span class="token function">restoreStd</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        sys<span class="token punctuation">.</span>stdout <span class="token operator">=</span> self<span class="token punctuation">.</span>stdoutbak        sys<span class="token punctuation">.</span>stderr <span class="token operator">=</span> self<span class="token punctuation">.</span>stderrbak    <span class="token comment"># 这个类必须得有，不然会报错</span>    <span class="token keyword">def</span> <span class="token function">flush</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">pass</span><span class="token keyword">def</span> <span class="token function">sh</span><span class="token punctuation">(</span>command<span class="token punctuation">)</span><span class="token punctuation">:</span>    p <span class="token operator">=</span> subprocess<span class="token punctuation">.</span>Popen<span class="token punctuation">(</span>command<span class="token punctuation">,</span> shell<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> stdout<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>PIPE<span class="token punctuation">)</span>     <span class="token comment">#如需要将打印信息打印到tkinter，则取消下面注释。若出现乱码问题，换为GDK编码</span>    <span class="token comment"># lines = []</span>    <span class="token comment"># for line in iter(p.stdout.readline, b''):</span>    <span class="token comment">#     line = line.strip().decode("utf-8","ignore")</span>    <span class="token comment">#     print(">>>", line)</span>    <span class="token comment">#     lines.append(line)</span>    <span class="token comment"># return lines</span><span class="token keyword">def</span> <span class="token function">killPort</span><span class="token punctuation">(</span>port<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment"># 关闭进程</span>    r <span class="token operator">=</span> os<span class="token punctuation">.</span>popen<span class="token punctuation">(</span><span class="token string">"netstat -ano | findstr "</span><span class="token operator">+</span>port<span class="token punctuation">)</span>    text <span class="token operator">=</span> r<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>    arr<span class="token operator">=</span>text<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> text0 <span class="token keyword">in</span> arr<span class="token punctuation">:</span>        arr2<span class="token operator">=</span>text0<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>arr2<span class="token punctuation">)</span><span class="token operator">></span><span class="token number">1</span><span class="token punctuation">:</span>            pid<span class="token operator">=</span>arr2<span class="token punctuation">[</span><span class="token builtin">len</span><span class="token punctuation">(</span>arr2<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'kill '</span><span class="token operator">+</span>pid<span class="token punctuation">)</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>pid <span class="token operator">==</span> <span class="token string">'0'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                <span class="token keyword">break</span>            os<span class="token punctuation">.</span>system<span class="token punctuation">(</span><span class="token string">"taskkill /PID "</span><span class="token operator">+</span>pid<span class="token operator">+</span><span class="token string">" /T /F"</span><span class="token punctuation">)</span>            <span class="token keyword">break</span>    r<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>      <span class="token keyword">def</span> <span class="token function">btnfunc01</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># 刷新 </span>    output <span class="token operator">=</span> sys<span class="token punctuation">.</span>stdout    sys<span class="token punctuation">.</span>stdout <span class="token operator">=</span> StdoutRedirector<span class="token punctuation">(</span>textMess<span class="token punctuation">)</span>    killPort<span class="token punctuation">(</span><span class="token string">'4000'</span><span class="token punctuation">)</span>    os<span class="token punctuation">.</span>chdir<span class="token punctuation">(</span>rootDir<span class="token punctuation">)</span>    sh<span class="token punctuation">(</span><span class="token string">"hexo clean"</span><span class="token punctuation">)</span>    sh<span class="token punctuation">(</span><span class="token string">"hexo s"</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"刷新成功"</span><span class="token punctuation">)</span>    sys<span class="token punctuation">.</span>stdout <span class="token operator">=</span> output    <span class="token keyword">def</span> <span class="token function">btnfunc02</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment"># 打开网址</span>    output <span class="token operator">=</span> sys<span class="token punctuation">.</span>stdout    sys<span class="token punctuation">.</span>stdout <span class="token operator">=</span> StdoutRedirector<span class="token punctuation">(</span>textMess<span class="token punctuation">)</span>    webbrowser<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"http://localhost:4000/"</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"打开网址成功"</span><span class="token punctuation">)</span>    sys<span class="token punctuation">.</span>stdout <span class="token operator">=</span> output    <span class="token keyword">def</span> <span class="token function">btnfunc03</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># 发布</span>    output <span class="token operator">=</span> sys<span class="token punctuation">.</span>stdout    sys<span class="token punctuation">.</span>stdout <span class="token operator">=</span> StdoutRedirector<span class="token punctuation">(</span>textMess<span class="token punctuation">)</span>    os<span class="token punctuation">.</span>chdir<span class="token punctuation">(</span>rootDir<span class="token punctuation">)</span>    sh<span class="token punctuation">(</span><span class="token string">"hexo clean"</span><span class="token punctuation">)</span>    sh<span class="token punctuation">(</span><span class="token string">"hexo d"</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"已发布到Github"</span><span class="token punctuation">)</span>    sys<span class="token punctuation">.</span>stdout <span class="token operator">=</span> output<span class="token keyword">def</span> <span class="token function">btnfunc04</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># 打开文件位置</span>    output <span class="token operator">=</span> sys<span class="token punctuation">.</span>stdout    sys<span class="token punctuation">.</span>stdout <span class="token operator">=</span> StdoutRedirector<span class="token punctuation">(</span>textMess<span class="token punctuation">)</span>    os<span class="token punctuation">.</span>system<span class="token punctuation">(</span><span class="token string">"start "</span> <span class="token operator">+</span> rootDir<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"已打开文件所在位置"</span><span class="token punctuation">)</span>    sys<span class="token punctuation">.</span>stdout <span class="token operator">=</span> output    <span class="token keyword">def</span> <span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>       <span class="token comment"># 新建</span>    last <span class="token operator">=</span> NameEntry<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span>                    <span class="token comment"># 获取输入框内容</span>    output <span class="token operator">=</span> sys<span class="token punctuation">.</span>stdout                       <span class="token comment"># 备份</span>    sys<span class="token punctuation">.</span>stdout <span class="token operator">=</span> StdoutRedirector<span class="token punctuation">(</span>textMess<span class="token punctuation">)</span>   <span class="token comment"># Print重定向类</span>    os<span class="token punctuation">.</span>chdir<span class="token punctuation">(</span>rootDir<span class="token punctuation">)</span>     sh<span class="token punctuation">(</span><span class="token string">"hexo new "</span><span class="token operator">+</span>last<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>last<span class="token operator">+</span><span class="token string">" 新建成功"</span><span class="token punctuation">)</span>    sys<span class="token punctuation">.</span>stdout <span class="token operator">=</span> output                       <span class="token comment"># 恢复到备份</span><span class="token keyword">def</span> <span class="token function">newDraft</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># 新建草稿</span>    last <span class="token operator">=</span> NameEntry<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span>                    <span class="token comment"># 获取输入框内容</span>    output <span class="token operator">=</span> sys<span class="token punctuation">.</span>stdout                       <span class="token comment"># 备份</span>    sys<span class="token punctuation">.</span>stdout <span class="token operator">=</span> StdoutRedirector<span class="token punctuation">(</span>textMess<span class="token punctuation">)</span>   <span class="token comment"># Print重定向类</span>    os<span class="token punctuation">.</span>chdir<span class="token punctuation">(</span>rootDir<span class="token punctuation">)</span>     sh<span class="token punctuation">(</span><span class="token string">"hexo new draft"</span><span class="token operator">+</span>last<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>last<span class="token operator">+</span><span class="token string">" 新建草稿成功"</span><span class="token punctuation">)</span>    sys<span class="token punctuation">.</span>stdout <span class="token operator">=</span> output                        <span class="token comment"># 恢复到备份</span><span class="token keyword">def</span> <span class="token function">clearMess</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># 清空打印</span>    <span class="token keyword">global</span> textMess    textMess<span class="token punctuation">.</span>delete<span class="token punctuation">(</span><span class="token number">1.0</span><span class="token punctuation">,</span> tk<span class="token punctuation">.</span>END<span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    <span class="token comment"># 建立主窗口</span>    root <span class="token operator">=</span> tk<span class="token punctuation">.</span>Tk<span class="token punctuation">(</span><span class="token punctuation">)</span>    mytitle <span class="token operator">=</span> <span class="token string">'hexo控制台'</span>    root<span class="token punctuation">.</span>title<span class="token punctuation">(</span>mytitle<span class="token punctuation">)</span>    root<span class="token punctuation">.</span>geometry<span class="token punctuation">(</span><span class="token string">'&#123;&#125;x&#123;&#125;+&#123;&#125;+&#123;&#125;'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token number">700</span><span class="token punctuation">,</span> <span class="token number">600</span><span class="token punctuation">,</span> <span class="token number">400</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token comment"># 新建文件输入框</span>    frame <span class="token operator">=</span> tk<span class="token punctuation">.</span>Frame<span class="token punctuation">(</span>root<span class="token punctuation">)</span>    lb <span class="token operator">=</span> tk<span class="token punctuation">.</span>Label<span class="token punctuation">(</span>frame<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">'新建文件名:'</span><span class="token punctuation">,</span>font<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'楷体'</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">13</span><span class="token punctuation">,</span> height<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>    NameEntry <span class="token operator">=</span> tk<span class="token punctuation">.</span>Entry<span class="token punctuation">(</span>frame<span class="token punctuation">,</span> font<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'楷体'</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">23</span><span class="token punctuation">)</span>    <span class="token comment"># 确定按钮与草稿按钮</span>    updateButton <span class="token operator">=</span> tk<span class="token punctuation">.</span>Button<span class="token punctuation">(</span>frame<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">'确定'</span><span class="token punctuation">,</span> font<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'楷体'</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span> height<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>    draftButton <span class="token operator">=</span> tk<span class="token punctuation">.</span>Button<span class="token punctuation">(</span>frame<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">'草稿'</span><span class="token punctuation">,</span> font<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'楷体'</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span> height<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>    updateButton<span class="token punctuation">[</span><span class="token string">'command'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">lambda</span><span class="token punctuation">:</span> new<span class="token punctuation">(</span><span class="token punctuation">)</span>    draftButton<span class="token punctuation">[</span><span class="token string">'command'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">lambda</span><span class="token punctuation">:</span> newDraft<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token comment"># 新建文件输入框、确定按钮与草稿按钮的布局</span>    lb<span class="token punctuation">.</span>pack<span class="token punctuation">(</span>side<span class="token operator">=</span>tk<span class="token punctuation">.</span>LEFT<span class="token punctuation">)</span>    NameEntry<span class="token punctuation">.</span>pack<span class="token punctuation">(</span>side<span class="token operator">=</span>tk<span class="token punctuation">.</span>LEFT<span class="token punctuation">)</span>    updateButton<span class="token punctuation">.</span>pack<span class="token punctuation">(</span>side<span class="token operator">=</span>tk<span class="token punctuation">.</span>LEFT<span class="token punctuation">,</span>padx<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span>    draftButton<span class="token punctuation">.</span>pack<span class="token punctuation">(</span>side<span class="token operator">=</span>tk<span class="token punctuation">.</span>LEFT<span class="token punctuation">)</span>    frame<span class="token punctuation">.</span>pack<span class="token punctuation">(</span>side<span class="token operator">=</span>tk<span class="token punctuation">.</span>TOP<span class="token punctuation">,</span> fill<span class="token operator">=</span>tk<span class="token punctuation">.</span>BOTH<span class="token punctuation">)</span>        <span class="token comment"># 设置按钮的样式和位置</span>    frame1 <span class="token operator">=</span> tk<span class="token punctuation">.</span>Frame<span class="token punctuation">(</span>root<span class="token punctuation">)</span>    <span class="token keyword">global</span> button1<span class="token punctuation">,</span>button2<span class="token punctuation">,</span>button3<span class="token punctuation">,</span>button4    button1 <span class="token operator">=</span> tk<span class="token punctuation">.</span>Button<span class="token punctuation">(</span>frame1<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">'刷新'</span><span class="token punctuation">,</span> bg<span class="token operator">=</span><span class="token string">'green'</span><span class="token punctuation">,</span> font<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'楷体'</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">7</span><span class="token punctuation">,</span> height<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>    button2 <span class="token operator">=</span> tk<span class="token punctuation">.</span>Button<span class="token punctuation">(</span>frame1<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">'网址'</span><span class="token punctuation">,</span> bg<span class="token operator">=</span><span class="token string">'green'</span><span class="token punctuation">,</span> font<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'楷体'</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">7</span><span class="token punctuation">,</span> height<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>    button3 <span class="token operator">=</span> tk<span class="token punctuation">.</span>Button<span class="token punctuation">(</span>frame1<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">'发布'</span><span class="token punctuation">,</span> bg<span class="token operator">=</span><span class="token string">'green'</span><span class="token punctuation">,</span> font<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'楷体'</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">7</span><span class="token punctuation">,</span> height<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>    button4 <span class="token operator">=</span> tk<span class="token punctuation">.</span>Button<span class="token punctuation">(</span>frame1<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">'打开文件位置'</span><span class="token punctuation">,</span> font<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'楷体'</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">12</span><span class="token punctuation">,</span> height<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>    <span class="token comment"># 设置按钮设置布局</span>    button1<span class="token punctuation">.</span>pack<span class="token punctuation">(</span>side<span class="token operator">=</span>tk<span class="token punctuation">.</span>LEFT<span class="token punctuation">,</span>padx<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span>    button2<span class="token punctuation">.</span>pack<span class="token punctuation">(</span>side<span class="token operator">=</span>tk<span class="token punctuation">.</span>LEFT<span class="token punctuation">,</span>padx<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span>    button3<span class="token punctuation">.</span>pack<span class="token punctuation">(</span>side<span class="token operator">=</span>tk<span class="token punctuation">.</span>LEFT<span class="token punctuation">,</span>padx<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span>    button4<span class="token punctuation">.</span>pack<span class="token punctuation">(</span>side<span class="token operator">=</span>tk<span class="token punctuation">.</span>RIGHT<span class="token punctuation">)</span>    frame1<span class="token punctuation">.</span>pack<span class="token punctuation">(</span>side<span class="token operator">=</span>tk<span class="token punctuation">.</span>TOP<span class="token punctuation">,</span> fill<span class="token operator">=</span>tk<span class="token punctuation">.</span>BOTH<span class="token punctuation">)</span>    <span class="token comment"># 为按钮设置功能</span>    button1<span class="token punctuation">[</span><span class="token string">'command'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">lambda</span><span class="token punctuation">:</span> btnfunc01<span class="token punctuation">(</span><span class="token punctuation">)</span>            <span class="token comment"># 刷新</span>    button2<span class="token punctuation">[</span><span class="token string">'command'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">lambda</span><span class="token punctuation">:</span> btnfunc02<span class="token punctuation">(</span><span class="token punctuation">)</span>            <span class="token comment"># 打开网址</span>    button3<span class="token punctuation">[</span><span class="token string">'command'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">lambda</span><span class="token punctuation">:</span> btnfunc03<span class="token punctuation">(</span><span class="token punctuation">)</span>            <span class="token comment"># 新建</span>    button4<span class="token punctuation">[</span><span class="token string">'command'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">lambda</span><span class="token punctuation">:</span> btnfunc04<span class="token punctuation">(</span><span class="token punctuation">)</span>            <span class="token comment"># 打开文件分配位置</span>    <span class="token comment">#为信息框设置一个容器作为信息输出窗口</span>    <span class="token keyword">global</span> textMess    frame2 <span class="token operator">=</span> tk<span class="token punctuation">.</span>LabelFrame<span class="token punctuation">(</span>root<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">'打印信息'</span><span class="token punctuation">,</span> height<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>    textMess <span class="token operator">=</span> ScrolledText<span class="token punctuation">(</span>frame2<span class="token punctuation">,</span> bg<span class="token operator">=</span><span class="token string">'white'</span><span class="token punctuation">,</span> height<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span>    textMess<span class="token punctuation">.</span>pack<span class="token punctuation">(</span>fill<span class="token operator">=</span>tk<span class="token punctuation">.</span>BOTH<span class="token punctuation">,</span> expand<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>    clearMessbutton <span class="token operator">=</span> tk<span class="token punctuation">.</span>Button<span class="token punctuation">(</span>frame2<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">'清空信息'</span><span class="token punctuation">,</span> font<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'楷体'</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">7</span><span class="token punctuation">,</span> height<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>    clearMessbutton<span class="token punctuation">.</span>pack<span class="token punctuation">(</span>anchor<span class="token operator">=</span><span class="token string">'se'</span><span class="token punctuation">)</span>    clearMessbutton<span class="token punctuation">[</span><span class="token string">'command'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">lambda</span><span class="token punctuation">:</span> clearMess<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token comment">#清空打印</span>    frame2<span class="token punctuation">.</span>pack<span class="token punctuation">(</span>fill<span class="token operator">=</span>tk<span class="token punctuation">.</span>BOTH<span class="token punctuation">,</span> expand<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>    <span class="token comment"># 进入Tkinter消息循环</span>    root<span class="token punctuation">.</span>mainloop<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>最终效果：</p><img src="/images/Hexo%E5%8F%AF%E8%A7%86%E5%8C%96%E8%84%9A%E6%9C%AC/image-20221108102346610.png" alt="最终效果图" style="zoom:40%;" /><p>代码以全部放代码仓库：<a href="https://github.com/wxydaydayup/HexoPanel">Hexo可视化控制台(自制)</a></p>]]></content>
      
      
      <categories>
          
          <category> Python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Python爬虫</title>
      <link href="/2022/10/24/Python%E7%88%AC%E8%99%AB/"/>
      <url>/2022/10/24/Python%E7%88%AC%E8%99%AB/</url>
      
        <content type="html"><![CDATA[<h1 id="Python爬虫-采集免费IP代理"><a href="#Python爬虫-采集免费IP代理" class="headerlink" title="Python爬虫-采集免费IP代理"></a>Python爬虫-采集免费IP代理</h1><h3 id="一、网站分析与请求数据"><a href="#一、网站分析与请求数据" class="headerlink" title="一、网站分析与请求数据"></a>一、网站分析与请求数据</h3><pre class="line-numbers language-none"><code class="language-none">dict &#x3D; &#123;&#39;http&#39;: &#39;http:&#x2F;&#x2F;&#39; + IP:端口号&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>下载 requests包</p><pre class="line-numbers language-none"><code class="language-none">pip install requests<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>请求数据</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requestsurl <span class="token operator">=</span> <span class="token string">'https://www.kuaidaili.com/free/'</span>headers <span class="token operator">=</span> <span class="token punctuation">&#123;</span>    <span class="token string">'User-Agent'</span><span class="token punctuation">:</span> <span class="token string">'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/107.0.0.0 Safari/537.36 Edg/107.0.1418.42'</span><span class="token punctuation">&#125;</span>response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url <span class="token operator">=</span> url<span class="token punctuation">,</span>headers <span class="token operator">=</span> headers<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="二、解析数据"><a href="#二、解析数据" class="headerlink" title="二、解析数据"></a>二、解析数据</h3><p>解析数据的3种写法</p><h4 id="1、可以使用re正则提取数据"><a href="#1、可以使用re正则提取数据" class="headerlink" title="1、可以使用re正则提取数据"></a>1、可以使用re正则提取数据</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> reIP_list <span class="token operator">=</span> re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token string">'&lt;td data-title="IP">(.*?)&lt;/td>'</span><span class="token punctuation">,</span>response<span class="token punctuation">.</span>text<span class="token punctuation">)</span>Post_list <span class="token operator">=</span> re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token string">'&lt;td data-title="PORT">(.*?)&lt;/td>'</span><span class="token punctuation">,</span>response<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h4 id="2、CSS提取数据"><a href="#2、CSS提取数据" class="headerlink" title="2、CSS提取数据"></a>2、CSS提取数据</h4><pre class="line-numbers language-none"><code class="language-none">pip install parsel<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>转换数据类型,根据标签层层定位</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> parselselector <span class="token operator">=</span> parsel<span class="token punctuation">.</span>Selector<span class="token punctuation">(</span>response<span class="token punctuation">.</span>text<span class="token punctuation">)</span>IP_list <span class="token operator">=</span> selector<span class="token punctuation">.</span>css<span class="token punctuation">(</span><span class="token string">'#list tbody tr td:nth-child(1)::text'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>getall<span class="token punctuation">(</span><span class="token punctuation">)</span>Post_list <span class="token operator">=</span> selector<span class="token punctuation">.</span>css<span class="token punctuation">(</span><span class="token string">'#list tbody tr td:nth-child(2)::text'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>getall<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>IP_list<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>Post_list<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="3、xpath提取数据"><a href="#3、xpath提取数据" class="headerlink" title="3、xpath提取数据"></a>3、xpath提取数据</h4><pre class="line-numbers language-none"><code class="language-none">pip install parsel<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>转换数据类型,根据标签层层定位</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> parselselector <span class="token operator">=</span> parsel<span class="token punctuation">.</span>Selector<span class="token punctuation">(</span>response<span class="token punctuation">.</span>text<span class="token punctuation">)</span>IP_list <span class="token operator">=</span> selector<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//*[@id ="list"]//tbody/tr/td[1]/text()'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>getall<span class="token punctuation">(</span><span class="token punctuation">)</span>Post_list <span class="token operator">=</span> selector<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//*[@id ="list"]//tbody/tr/td[2]/text()'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>getall<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h3 id="三、检测IP并进行打印"><a href="#三、检测IP并进行打印" class="headerlink" title="三、检测IP并进行打印"></a>三、检测IP并进行打印</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python">all_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>use_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>err_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>num <span class="token operator">=</span> <span class="token number">0</span><span class="token keyword">for</span> page <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    url <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f'https://www.kuaidaili.com/free/inha/</span><span class="token interpolation"><span class="token punctuation">&#123;</span>page<span class="token punctuation">&#125;</span></span><span class="token string">/'</span></span>    headers <span class="token operator">=</span> <span class="token punctuation">&#123;</span>        <span class="token string">'User-Agent'</span><span class="token punctuation">:</span> <span class="token string">'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/107.0.0.0 Safari/537.36 Edg/107.0.1418.42'</span>    <span class="token punctuation">&#125;</span>    response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url <span class="token operator">=</span> url<span class="token punctuation">,</span>headers <span class="token operator">=</span> headers<span class="token punctuation">)</span>    IP_list <span class="token operator">=</span> re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token string">'&lt;td data-title="IP">(.*?)&lt;/td>'</span><span class="token punctuation">,</span>response<span class="token punctuation">.</span>text<span class="token punctuation">)</span>    Post_list <span class="token operator">=</span> re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token string">'&lt;td data-title="PORT">(.*?)&lt;/td>'</span><span class="token punctuation">,</span>response<span class="token punctuation">.</span>text<span class="token punctuation">)</span>    <span class="token keyword">for</span> IP<span class="token punctuation">,</span>Post <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>IP_list<span class="token punctuation">,</span>Post_list<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token builtin">dict</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">'http'</span><span class="token punctuation">:</span> <span class="token string">'http://'</span> <span class="token operator">+</span> IP <span class="token operator">+</span> <span class="token string">':'</span> <span class="token operator">+</span> Post<span class="token punctuation">&#125;</span>        all_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">dict</span><span class="token punctuation">)</span>        <span class="token keyword">try</span><span class="token punctuation">:</span>            num <span class="token operator">+=</span> <span class="token number">1</span>            checkResponse <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token operator">=</span><span class="token string">'https://www.baidu.com/'</span><span class="token punctuation">,</span>headers <span class="token operator">=</span> headers<span class="token punctuation">,</span>proxies <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">)</span>            <span class="token keyword">if</span> checkResponse<span class="token punctuation">.</span>status_code <span class="token operator">==</span> <span class="token number">200</span><span class="token punctuation">:</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>num <span class="token operator">%</span> <span class="token number">20</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'已采集有效代理</span><span class="token interpolation"><span class="token punctuation">&#123;</span>num<span class="token punctuation">&#125;</span></span><span class="token string">条'</span></span><span class="token punctuation">)</span>                use_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">dict</span><span class="token punctuation">)</span>        <span class="token keyword">except</span><span class="token punctuation">:</span>            err_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">dict</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'一共采集到</span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token builtin">len</span><span class="token punctuation">(</span>all_list<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">条代理,其中有效代理</span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token builtin">len</span><span class="token punctuation">(</span>use_list<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">条'</span></span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="四、保存IP"><a href="#四、保存IP" class="headerlink" title="四、保存IP"></a>四、保存IP</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'target.txt'</span><span class="token punctuation">,</span>mode<span class="token operator">=</span><span class="token string">'r'</span><span class="token punctuation">,</span>encoding <span class="token operator">=</span> <span class="token string">'utf-8'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> use_list<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"已保存为可用http代理.txt"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h1 id="八爪鱼"><a href="#八爪鱼" class="headerlink" title="八爪鱼"></a>八爪鱼</h1><p><strong>1. 打开网页</strong></p><p>所有的采集默认第一项都是打开网页。所以在新建任务之后，系统会提示你输入网址。当你输入之后，八爪鱼就会自动建立一个“打开网页”的流程。</p><p><strong>2. 点击元素</strong></p><p>这里元素的定义比较广泛，它可以是某个按钮，或者某个链接，也或者是某个图片或文字。使用这个步骤是你在搜索或者提交某个请求。当你点击元素后，八爪鱼会提示你想要达到的目的：点击该按钮、采集该元素文本、还是鼠标移到该链接上。然后再选择“点击该按钮”进行确认即可。</p><p>如果我们点击某个元素的目的是循环翻页，或者提取数据，那么在点击之后，八爪鱼会确认你的目的，你只要点击相关的按钮即可。</p><p><strong>3. 循环翻页</strong></p><p>很多数据都存在翻页的情况，通常你需要找到翻页的位置，比如网页底部的“下一页”按钮，点击它，会提示你“循环点击下一页”、“采集该链接文本”还是“点击该链接”。你需要确认这里是进行的“循环点击下一页”。</p><p><strong>4. 提取数据</strong></p><p>在网页上选择你想要提取的页面范围，鼠标移动到页面上会呈现蓝色的阴影面积，它表明了你想提取的数据范围。然后点击鼠标后，在右侧选择“采集数据”即可。</p><p>这4个基本操作就像它们的名称一样简单直接，这里我给你一些使用的建议：</p><ol><li>尽量使用用户操作视角进行模拟的方式进行操作，而不是在“流程视图”中手动创建相应的步骤。因为八爪鱼最大的特点就是所见即所得，所以一切就按照用户使用的流程进行操作即可。</li><li>使用“流程视图”方便管理和调整。右侧有“流程视图”的按钮，点击之后进入到流程视图，会把你之前的操作以流程图的方式进行展示</li></ol>]]></content>
      
      
      <categories>
          
          <category> Python </category>
          
          <category> 爬虫 </category>
          
          <category> 八爪鱼 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
            <tag> 爬虫 </tag>
            
            <tag> 八爪鱼 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>机器学习比赛及常用函数</title>
      <link href="/2022/10/24/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E6%AF%94%E8%B5%9B%E5%8F%8A%E5%B8%B8%E7%94%A8%E5%87%BD%E6%95%B0/"/>
      <url>/2022/10/24/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E6%AF%94%E8%B5%9B%E5%8F%8A%E5%B8%B8%E7%94%A8%E5%87%BD%E6%95%B0/</url>
      
        <content type="html"><![CDATA[<h1 id="机器学习比赛"><a href="#机器学习比赛" class="headerlink" title="机器学习比赛"></a>机器学习比赛</h1><h2 id="机器学习建模流程及常用函数"><a href="#机器学习建模流程及常用函数" class="headerlink" title="机器学习建模流程及常用函数"></a>机器学习建模流程及常用函数</h2><h3 id="一、数据探索"><a href="#一、数据探索" class="headerlink" title="一、数据探索"></a>一、数据探索</h3><ul><li>观察字段的缺失值</li><li>观察Label分布</li><li>观察唯一值的个数</li><li>观察字段的相关性</li></ul><h4 id="1、以直方图的形式展示数据信息"><a href="#1、以直方图的形式展示数据信息" class="headerlink" title="1、以直方图的形式展示数据信息"></a>1、以直方图的形式展示数据信息</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt<span class="token keyword">import</span> seaborn <span class="token keyword">as</span> sns<span class="token comment"># 以直方图的形式展示，isDefault表示显示数量</span>sns<span class="token punctuation">.</span>countplot<span class="token punctuation">(</span>x <span class="token operator">=</span> <span class="token string">'grade'</span><span class="token punctuation">,</span>hue<span class="token operator">=</span><span class="token string">'isDefault'</span><span class="token punctuation">,</span>data<span class="token operator">=</span>train<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h4 id="2、进行字段之间的相关性相关性分析"><a href="#2、进行字段之间的相关性相关性分析" class="headerlink" title="2、进行字段之间的相关性相关性分析"></a>2、进行字段之间的相关性相关性分析</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 对特征列进行相关性分析</span><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt<span class="token operator">%</span>matplotlib inline<span class="token keyword">import</span> seaborn <span class="token keyword">as</span> snsplt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span>sns<span class="token punctuation">.</span>heatmap<span class="token punctuation">(</span>train<span class="token punctuation">.</span>corr<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>cbar<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>annot<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>cmap<span class="token operator">=</span><span class="token string">'Blues'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="二、数据预处理"><a href="#二、数据预处理" class="headerlink" title="二、数据预处理"></a>二、数据预处理</h3><ul><li>数值类型和类别类型缺失值处理</li><li>处理唯一值的个数为1字段</li><li>数据规范化(深度学习才需要)</li></ul><h4 id="1、删除全部唯一值为1字段"><a href="#1、删除全部唯一值为1字段" class="headerlink" title="1、删除全部唯一值为1字段"></a>1、删除全部唯一值为1字段</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python">features <span class="token operator">=</span> train<span class="token punctuation">.</span>columns<span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">for</span> feature <span class="token keyword">in</span> features<span class="token punctuation">:</span>    <span class="token keyword">if</span> train<span class="token punctuation">[</span>feature<span class="token punctuation">]</span><span class="token punctuation">.</span>nunique<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">:</span>        train<span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token punctuation">[</span>feature<span class="token punctuation">]</span><span class="token punctuation">,</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>        test<span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token punctuation">[</span>feature<span class="token punctuation">]</span><span class="token punctuation">,</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'删除全部唯一值为1字段完成'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="2、将数值类型的缺失值全部以中位数补全"><a href="#2、将数值类型的缺失值全部以中位数补全" class="headerlink" title="2、将数值类型的缺失值全部以中位数补全"></a>2、将数值类型的缺失值全部以中位数补全</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#将数值类型的缺失值全部以中位数补全</span>numerical_fea <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>train<span class="token punctuation">.</span>select_dtypes<span class="token punctuation">(</span>include<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'float'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>columns<span class="token punctuation">)</span>train<span class="token punctuation">[</span>numerical_fea<span class="token punctuation">]</span> <span class="token operator">=</span> train<span class="token punctuation">[</span>numerical_fea<span class="token punctuation">]</span><span class="token punctuation">.</span>fillna<span class="token punctuation">(</span>train<span class="token punctuation">[</span>numerical_fea<span class="token punctuation">]</span><span class="token punctuation">.</span>median<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>test<span class="token punctuation">[</span>numerical_fea<span class="token punctuation">]</span> <span class="token operator">=</span> test<span class="token punctuation">[</span>numerical_fea<span class="token punctuation">]</span><span class="token punctuation">.</span>fillna<span class="token punctuation">(</span>test<span class="token punctuation">[</span>numerical_fea<span class="token punctuation">]</span><span class="token punctuation">.</span>median<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'数值类型缺失值,中位数填充完成'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="3、将类别类型的缺失值全部以众数补全"><a href="#3、将类别类型的缺失值全部以众数补全" class="headerlink" title="3、将类别类型的缺失值全部以众数补全"></a>3、将类别类型的缺失值全部以众数补全</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#将类别类型的缺失值全部以众数补全</span><span class="token keyword">from</span> scipy <span class="token keyword">import</span> stats cat_fea <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>train<span class="token punctuation">.</span>select_dtypes<span class="token punctuation">(</span>exclude<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'float'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>columns<span class="token punctuation">)</span><span class="token keyword">for</span> cf <span class="token keyword">in</span> cat_fea<span class="token punctuation">:</span>    <span class="token keyword">if</span> train<span class="token punctuation">[</span>cf<span class="token punctuation">]</span><span class="token punctuation">.</span>isnull<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        train<span class="token punctuation">[</span>cf<span class="token punctuation">]</span> <span class="token operator">=</span> train<span class="token punctuation">[</span>cf<span class="token punctuation">]</span><span class="token punctuation">.</span>fillna<span class="token punctuation">(</span>stats<span class="token punctuation">.</span>mode<span class="token punctuation">(</span>train<span class="token punctuation">[</span>cf<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>cat_fea <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>test<span class="token punctuation">.</span>select_dtypes<span class="token punctuation">(</span>exclude<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'float'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>columns<span class="token punctuation">)</span><span class="token keyword">for</span> cf <span class="token keyword">in</span> cat_fea<span class="token punctuation">:</span>    <span class="token keyword">if</span> test<span class="token punctuation">[</span>cf<span class="token punctuation">]</span><span class="token punctuation">.</span>isnull<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        test<span class="token punctuation">[</span>cf<span class="token punctuation">]</span> <span class="token operator">=</span> test<span class="token punctuation">[</span>cf<span class="token punctuation">]</span><span class="token punctuation">.</span>fillna<span class="token punctuation">(</span>stats<span class="token punctuation">.</span>mode<span class="token punctuation">(</span>test<span class="token punctuation">[</span>cf<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'类别类型缺失值,众数填充完成'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="三、特征工程"><a href="#三、特征工程" class="headerlink" title="三、特征工程"></a>三、特征工程</h3><p>特征编码（原来是个类别类型，比如说是个字符串，还需要把它变成数值类型），构造新特征，特征变换，</p><h4 id="1、特征编码，将object转换为数值类型"><a href="#1、特征编码，将object转换为数值类型" class="headerlink" title="1、特征编码，将object转换为数值类型"></a>1、特征编码，将object转换为数值类型</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>preprocessing <span class="token keyword">import</span> LabelEncoderle <span class="token operator">=</span> LabelEncoder<span class="token punctuation">(</span><span class="token punctuation">)</span>train<span class="token punctuation">[</span><span class="token string">'grade'</span><span class="token punctuation">]</span> <span class="token operator">=</span> le<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>train<span class="token punctuation">[</span><span class="token string">'grade'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>testA<span class="token punctuation">[</span><span class="token string">'grade'</span><span class="token punctuation">]</span> <span class="token operator">=</span> le<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>testA<span class="token punctuation">[</span><span class="token string">'grade'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>或者利用map自定义特征，</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#数据清洗特征添加</span><span class="token keyword">for</span> data <span class="token keyword">in</span> <span class="token punctuation">[</span>train<span class="token punctuation">]</span><span class="token punctuation">:</span>    data<span class="token punctuation">[</span><span class="token string">'grade'</span><span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">'grade'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token string">'A'</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'B'</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token string">'C'</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token string">'D'</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token string">'E'</span><span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token string">'F'</span><span class="token punctuation">:</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token string">'G'</span><span class="token punctuation">:</span><span class="token number">7</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>        data<span class="token punctuation">[</span><span class="token string">'employmentLength'</span><span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">'employmentLength'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">map</span><span class="token punctuation">(</span>    <span class="token punctuation">&#123;</span><span class="token string">'1 year'</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'2 years'</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token string">'3 years'</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token string">'4 years'</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token string">'5 years'</span><span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token string">'6 years'</span><span class="token punctuation">:</span><span class="token number">6</span><span class="token punctuation">,</span>    <span class="token string">'7 years'</span><span class="token punctuation">:</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token string">'8 years'</span><span class="token punctuation">:</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token string">'9 years'</span><span class="token punctuation">:</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token string">'10+ years'</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token string">'&lt; 1 year'</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>        data<span class="token punctuation">[</span><span class="token string">'subGrade'</span><span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">'subGrade'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">map</span><span class="token punctuation">(</span>    <span class="token punctuation">&#123;</span><span class="token string">'E2'</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'D2'</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token string">'D3'</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token string">'A4'</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token string">'C2'</span><span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token string">'A5'</span><span class="token punctuation">:</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token string">'C3'</span><span class="token punctuation">:</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token string">'B4'</span><span class="token punctuation">:</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token string">'B5'</span><span class="token punctuation">:</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token string">'E5'</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">,</span>    <span class="token string">'D4'</span><span class="token punctuation">:</span><span class="token number">11</span><span class="token punctuation">,</span><span class="token string">'B3'</span><span class="token punctuation">:</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token string">'B2'</span><span class="token punctuation">:</span><span class="token number">13</span><span class="token punctuation">,</span><span class="token string">'D1'</span><span class="token punctuation">:</span><span class="token number">14</span><span class="token punctuation">,</span><span class="token string">'E1'</span><span class="token punctuation">:</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token string">'C5'</span><span class="token punctuation">:</span><span class="token number">16</span><span class="token punctuation">,</span><span class="token string">'C1'</span><span class="token punctuation">:</span><span class="token number">17</span><span class="token punctuation">,</span><span class="token string">'A2'</span><span class="token punctuation">:</span><span class="token number">18</span><span class="token punctuation">,</span><span class="token string">'A3'</span><span class="token punctuation">:</span><span class="token number">19</span><span class="token punctuation">,</span><span class="token string">'B1'</span><span class="token punctuation">:</span><span class="token number">20</span><span class="token punctuation">,</span>    <span class="token string">'E3'</span><span class="token punctuation">:</span><span class="token number">21</span><span class="token punctuation">,</span><span class="token string">'F1'</span><span class="token punctuation">:</span><span class="token number">22</span><span class="token punctuation">,</span><span class="token string">'C4'</span><span class="token punctuation">:</span><span class="token number">23</span><span class="token punctuation">,</span><span class="token string">'A1'</span><span class="token punctuation">:</span><span class="token number">24</span><span class="token punctuation">,</span><span class="token string">'D5'</span><span class="token punctuation">:</span><span class="token number">25</span><span class="token punctuation">,</span><span class="token string">'F2'</span><span class="token punctuation">:</span><span class="token number">26</span><span class="token punctuation">,</span><span class="token string">'E4'</span><span class="token punctuation">:</span><span class="token number">27</span><span class="token punctuation">,</span><span class="token string">'F3'</span><span class="token punctuation">:</span><span class="token number">28</span><span class="token punctuation">,</span><span class="token string">'G2'</span><span class="token punctuation">:</span><span class="token number">29</span><span class="token punctuation">,</span><span class="token string">'F5'</span><span class="token punctuation">:</span><span class="token number">30</span><span class="token punctuation">,</span>    <span class="token string">'G3'</span><span class="token punctuation">:</span><span class="token number">31</span><span class="token punctuation">,</span><span class="token string">'G1'</span><span class="token punctuation">:</span><span class="token number">32</span><span class="token punctuation">,</span><span class="token string">'F4'</span><span class="token punctuation">:</span><span class="token number">33</span><span class="token punctuation">,</span><span class="token string">'G4'</span><span class="token punctuation">:</span><span class="token number">34</span><span class="token punctuation">,</span><span class="token string">'G5'</span><span class="token punctuation">:</span><span class="token number">35</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="2、时间多尺度变换与时间差计算"><a href="#2、时间多尺度变换与时间差计算" class="headerlink" title="2、时间多尺度变换与时间差计算"></a>2、时间多尺度变换与时间差计算</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> datetime<span class="token keyword">def</span> <span class="token function">create_days_diff</span><span class="token punctuation">(</span>selected_cols<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> selected <span class="token keyword">in</span> selected_cols<span class="token punctuation">:</span>        train<span class="token punctuation">[</span>selected<span class="token punctuation">]</span> <span class="token operator">=</span> pd<span class="token punctuation">.</span>to_datetime<span class="token punctuation">(</span>train<span class="token punctuation">[</span>selected<span class="token punctuation">]</span><span class="token punctuation">)</span>        tmp_str <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>train<span class="token punctuation">[</span>selected<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>year<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'-'</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span><span class="token string">"%02d"</span> <span class="token operator">%</span> train<span class="token punctuation">[</span>selected<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>month<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'-'</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span><span class="token string">"%02d"</span> <span class="token operator">%</span> train<span class="token punctuation">[</span>selected<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>day<span class="token punctuation">)</span>        startdate <span class="token operator">=</span> datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>strptime<span class="token punctuation">(</span>tmp_str<span class="token punctuation">,</span> <span class="token string">'%Y-%m-%d'</span><span class="token punctuation">)</span>        train<span class="token punctuation">[</span>selected<span class="token operator">+</span><span class="token string">'_diff'</span><span class="token punctuation">]</span> <span class="token operator">=</span> train<span class="token punctuation">[</span>selected<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x<span class="token operator">-</span>startdate<span class="token punctuation">)</span><span class="token punctuation">.</span>dt<span class="token punctuation">.</span>days                test<span class="token punctuation">[</span>selected<span class="token punctuation">]</span> <span class="token operator">=</span> pd<span class="token punctuation">.</span>to_datetime<span class="token punctuation">(</span>test<span class="token punctuation">[</span>selected<span class="token punctuation">]</span><span class="token punctuation">)</span>        tmp_str <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>test<span class="token punctuation">[</span>selected<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>year<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'-'</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span><span class="token string">"%02d"</span> <span class="token operator">%</span> test<span class="token punctuation">[</span>selected<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>month<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'-'</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span><span class="token string">"%02d"</span> <span class="token operator">%</span> test<span class="token punctuation">[</span>selected<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>day<span class="token punctuation">)</span>        startdate <span class="token operator">=</span> datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>strptime<span class="token punctuation">(</span>tmp_str<span class="token punctuation">,</span> <span class="token string">'%Y-%m-%d'</span><span class="token punctuation">)</span>        test<span class="token punctuation">[</span>selected<span class="token operator">+</span><span class="token string">'_diff'</span><span class="token punctuation">]</span> <span class="token operator">=</span> test<span class="token punctuation">[</span>selected<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x<span class="token operator">-</span>startdate<span class="token punctuation">)</span><span class="token punctuation">.</span>dt<span class="token punctuation">.</span>days                <span class="token keyword">print</span><span class="token punctuation">(</span>selected<span class="token operator">+</span><span class="token string">'_diff'</span><span class="token operator">+</span><span class="token string">' 时间差字段 已经创建'</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">create_ymd_features</span><span class="token punctuation">(</span>selected_cols<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> selected <span class="token keyword">in</span> selected_cols<span class="token punctuation">:</span>        test<span class="token punctuation">[</span>selected<span class="token punctuation">]</span> <span class="token operator">=</span> pd<span class="token punctuation">.</span>to_datetime<span class="token punctuation">(</span>test<span class="token punctuation">[</span>selected<span class="token punctuation">]</span><span class="token punctuation">)</span>        train_temp <span class="token operator">=</span> pd<span class="token punctuation">.</span>DatetimeIndex<span class="token punctuation">(</span>train<span class="token punctuation">[</span>selected<span class="token punctuation">]</span><span class="token punctuation">)</span>        test_temp <span class="token operator">=</span> pd<span class="token punctuation">.</span>DatetimeIndex<span class="token punctuation">(</span>test<span class="token punctuation">[</span>selected<span class="token punctuation">]</span><span class="token punctuation">)</span>                train<span class="token punctuation">[</span>selected<span class="token operator">+</span><span class="token string">'_year'</span><span class="token punctuation">]</span> <span class="token operator">=</span> train_temp<span class="token punctuation">.</span>year        test<span class="token punctuation">[</span>selected<span class="token operator">+</span><span class="token string">'_year'</span><span class="token punctuation">]</span> <span class="token operator">=</span> test_temp<span class="token punctuation">.</span>year        <span class="token keyword">print</span><span class="token punctuation">(</span>selected<span class="token operator">+</span><span class="token string">'_year'</span><span class="token operator">+</span><span class="token string">'字段 已经创建'</span><span class="token punctuation">)</span>                train<span class="token punctuation">[</span>selected<span class="token operator">+</span><span class="token string">'_month'</span><span class="token punctuation">]</span> <span class="token operator">=</span> train_temp<span class="token punctuation">.</span>month        test<span class="token punctuation">[</span>selected<span class="token operator">+</span><span class="token string">'_month'</span><span class="token punctuation">]</span> <span class="token operator">=</span> test_temp<span class="token punctuation">.</span>month        <span class="token keyword">print</span><span class="token punctuation">(</span>selected<span class="token operator">+</span><span class="token string">'_month'</span><span class="token operator">+</span><span class="token string">'字段 已经创建'</span><span class="token punctuation">)</span>                train<span class="token punctuation">[</span>selected<span class="token operator">+</span><span class="token string">'_day'</span><span class="token punctuation">]</span> <span class="token operator">=</span> train_temp<span class="token punctuation">.</span>day        test<span class="token punctuation">[</span>selected<span class="token operator">+</span><span class="token string">'_day'</span><span class="token punctuation">]</span> <span class="token operator">=</span> test_temp<span class="token punctuation">.</span>day        <span class="token keyword">print</span><span class="token punctuation">(</span>selected<span class="token operator">+</span><span class="token string">'_day'</span><span class="token operator">+</span><span class="token string">'字段 已经创建'</span><span class="token punctuation">)</span><span class="token comment">#只需要在selected_cols列表中加入需要转换的字段</span>selected_cols <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'issueDate'</span><span class="token punctuation">]</span>create_ymd_features<span class="token punctuation">(</span>selected_cols<span class="token punctuation">)</span>create_days_diff<span class="token punctuation">(</span>selected_cols<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="3、类别特征"><a href="#3、类别特征" class="headerlink" title="3、类别特征"></a>3、类别特征</h4><p><strong>min，max，mean，std没有意义，因为是单一特征</strong></p><p><strong>只增加count，isDefault_mean（唯一值个数少的情况，如果唯一值多，会造成成标签泄露问题）</strong></p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#cat_fea 为类别特征（一般是出float以外，时间类型也不算）</span>cat_fea <span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'term'</span><span class="token punctuation">,</span><span class="token string">'grade'</span><span class="token punctuation">,</span><span class="token string">'subGrade'</span><span class="token punctuation">,</span><span class="token string">'employmentLength'</span><span class="token punctuation">,</span><span class="token string">'homeOwnership'</span><span class="token punctuation">,</span><span class="token string">'verificationStatus'</span><span class="token punctuation">,</span><span class="token string">'purpose'</span><span class="token punctuation">,</span><span class="token string">'regionCode'</span><span class="token punctuation">,</span><span class="token string">'initialListStatus'</span><span class="token punctuation">,</span><span class="token string">'applicationType'</span><span class="token punctuation">]</span><span class="token comment">#先看一下类别特征唯一值的个数</span><span class="token keyword">for</span> feature <span class="token keyword">in</span> cat_fea<span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>feature<span class="token punctuation">,</span>train<span class="token punctuation">[</span>feature<span class="token punctuation">]</span><span class="token punctuation">.</span>nunique<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>df <span class="token operator">=</span> pd<span class="token punctuation">.</span>concat<span class="token punctuation">(</span><span class="token punctuation">[</span>train<span class="token punctuation">,</span>test<span class="token punctuation">]</span><span class="token punctuation">,</span>axis <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token keyword">for</span> col <span class="token keyword">in</span> cat_fea<span class="token punctuation">:</span>    temp <span class="token operator">=</span> train<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span>col<span class="token punctuation">,</span>as_index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">[</span>col<span class="token punctuation">]</span><span class="token punctuation">.</span>agg<span class="token punctuation">(</span><span class="token punctuation">&#123;</span>col<span class="token operator">+</span><span class="token string">'_count'</span><span class="token punctuation">:</span> <span class="token string">'count'</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>    df <span class="token operator">=</span> pd<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>df<span class="token punctuation">,</span>temp<span class="token punctuation">,</span>on <span class="token operator">=</span> col<span class="token punctuation">,</span>how <span class="token operator">=</span> <span class="token string">'left'</span><span class="token punctuation">)</span>    <span class="token comment">#isDefault为标签项，需要替换</span>    temp <span class="token operator">=</span> train<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span>col<span class="token punctuation">,</span>as_index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'isDefault'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>agg<span class="token punctuation">(</span><span class="token punctuation">&#123;</span>col<span class="token operator">+</span><span class="token string">'_isDefault_mean'</span><span class="token punctuation">:</span> <span class="token string">'mean'</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>    df <span class="token operator">=</span> pd<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>df<span class="token punctuation">,</span>temp<span class="token punctuation">,</span>on <span class="token operator">=</span> col<span class="token punctuation">,</span>how <span class="token operator">=</span> <span class="token string">'left'</span><span class="token punctuation">)</span>train <span class="token operator">=</span> df<span class="token punctuation">[</span>df<span class="token punctuation">[</span><span class="token string">'isDefault'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>notnull<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span>test <span class="token operator">=</span> df<span class="token punctuation">[</span>df<span class="token punctuation">[</span><span class="token string">'isDefault'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>isnull<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="4、批量删除字段为object的字段"><a href="#4、批量删除字段为object的字段" class="headerlink" title="4、批量删除字段为object的字段"></a>4、批量删除字段为object的字段</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># features = list(train.select_dtypes(include=['object']).columns)</span>features <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'lan'</span><span class="token punctuation">,</span> <span class="token string">'os'</span><span class="token punctuation">,</span> <span class="token string">'osv'</span><span class="token punctuation">,</span> <span class="token string">'version'</span><span class="token punctuation">,</span> <span class="token string">'label'</span><span class="token punctuation">,</span> <span class="token string">'sid'</span><span class="token punctuation">,</span><span class="token string">'timestamp'</span><span class="token punctuation">]</span> <span class="token comment">#自定义删除字段</span><span class="token keyword">for</span> feature <span class="token keyword">in</span> features<span class="token punctuation">:</span>        train<span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token punctuation">[</span>feature<span class="token punctuation">]</span><span class="token punctuation">,</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'批量删除字段已完成'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="四、模型建立"><a href="#四、模型建立" class="headerlink" title="四、模型建立"></a>四、模型建立</h3><p>机器学习神器：XGBoost，LightGBM，Catboost</p><p>图像&#x2F;文本分类：各种NN</p><p>通常LightGBM更快（在CPU机上，优先使用）</p><h3 id="五、参数调优"><a href="#五、参数调优" class="headerlink" title="五、参数调优"></a>五、参数调优</h3><p>1、可视化的方式查看特征的重要程度</p><p>lightgbm</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> lightgbm <span class="token keyword">as</span> lgb<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> pltfig<span class="token punctuation">,</span>ax <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span>lgb<span class="token punctuation">.</span>plot_importance<span class="token punctuation">(</span>model_lgb<span class="token punctuation">,</span>ax <span class="token operator">=</span>ax<span class="token punctuation">,</span>max_num_features <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token comment">#模型训练结果为model_lgb</span>plt<span class="token punctuation">.</span>tirle<span class="token punctuation">(</span><span class="token string">'Important Features'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>xgboost </p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> xgboost <span class="token keyword">import</span> plot_importance<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> pltfig<span class="token punctuation">,</span>ax <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span>plot_importance<span class="token punctuation">(</span>model_xgb<span class="token punctuation">,</span>ax <span class="token operator">=</span>ax<span class="token punctuation">,</span>max_num_features <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token comment">#模型训练结果为model_xgb</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>贝叶斯优化(主要是调树的深度)</p><h3 id="六、模型融合"><a href="#六、模型融合" class="headerlink" title="六、模型融合"></a>六、模型融合</h3><p>五折交叉验证融合</p><p>不同模型之间的融合</p>]]></content>
      
      
      <categories>
          
          <category> 机器学习 </category>
          
          <category> 数据分析 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 机器学习 </tag>
            
            <tag> 数据分析 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>百度飞桨-用户购买预测</title>
      <link href="/2022/10/24/%E7%99%BE%E5%BA%A6%E9%A3%9E%E6%A1%A8-%E7%94%A8%E6%88%B7%E8%B4%AD%E4%B9%B0%E9%A2%84%E6%B5%8B/"/>
      <url>/2022/10/24/%E7%99%BE%E5%BA%A6%E9%A3%9E%E6%A1%A8-%E7%94%A8%E6%88%B7%E8%B4%AD%E4%B9%B0%E9%A2%84%E6%B5%8B/</url>
      
        <content type="html"><![CDATA[<h1 id="百度飞桨-用户购买预测"><a href="#百度飞桨-用户购买预测" class="headerlink" title="百度飞桨-用户购买预测"></a>百度飞桨-用户购买预测</h1><h2 id="赛题说明"><a href="#赛题说明" class="headerlink" title="赛题说明"></a>赛题说明</h2><p>赛题链接：<a href="https://aistudio.baidu.com/aistudio/competition/detail/51/0/introduction">百度飞桨:  用户购买预测 </a></p><p>代码仓库：</p><h3 id="一、背景介绍"><a href="#一、背景介绍" class="headerlink" title="一、背景介绍"></a>一、背景介绍</h3><h3 id="二、任务介绍"><a href="#二、任务介绍" class="headerlink" title="二、任务介绍"></a>二、任务介绍</h3><h3 id="三、数据集"><a href="#三、数据集" class="headerlink" title="三、数据集"></a>三、数据集</h3><h3 id="四、字段说明"><a href="#四、字段说明" class="headerlink" title="四、字段说明"></a>四、字段说明</h3>]]></content>
      
      
      <categories>
          
          <category> 机器学习 </category>
          
          <category> 数据分析 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 机器学习 </tag>
            
            <tag> 数据分析 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>阿里云天池-恶意程序检测</title>
      <link href="/2022/10/24/%E9%98%BF%E9%87%8C%E4%BA%91%E5%A4%A9%E6%B1%A0-%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E6%A3%80%E6%B5%8B/"/>
      <url>/2022/10/24/%E9%98%BF%E9%87%8C%E4%BA%91%E5%A4%A9%E6%B1%A0-%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E6%A3%80%E6%B5%8B/</url>
      
        <content type="html"><![CDATA[<h1 id="阿里云天池-恶意程序检测"><a href="#阿里云天池-恶意程序检测" class="headerlink" title="阿里云天池-恶意程序检测"></a>阿里云天池-恶意程序检测</h1><h2 id="赛题说明"><a href="#赛题说明" class="headerlink" title="赛题说明"></a>赛题说明</h2><p>赛题链接：<a href="https://tianchi.aliyun.com/competition/entrance/231694/information">阿里云天池-安全恶意程序检测</a></p><p>代码仓库：<a href="https://github.com/wxydaydayup/Aliyun_MalwareDetection/tree/master">阿里云天池-安全恶意程序检测–代码仓库</a></p><h3 id="一、背景介绍"><a href="#一、背景介绍" class="headerlink" title="一、背景介绍"></a>一、背景介绍</h3><p>恶意软件是一种被设计用来对目标计算机造成破坏或者占用目标计算机资源的软件，传统的恶意软件包括蠕虫、木马等，这些恶意软件严重侵犯用户合法权益，甚至将为用户及他人带来巨大的经济或其他形式的利益损失。近年来随着虚拟货币进入大众视野，挖矿类的恶意程序也开始大量涌现，黑客通过入侵恶意挖矿程序获取巨额收益。当前恶意软件的检测技术主要有特征码检测、行为检测和启发式检测等，配合使用机器学习可以在一定程度上提高泛化能力，提升恶意样本的识别率。</p><h3 id="二、任务介绍"><a href="#二、任务介绍" class="headerlink" title="二、任务介绍"></a>二、任务介绍</h3><p>本题目提供的数据来自文件（windows 可执行程序）经过沙箱程序模拟运行后的API指令序列，全为windows二进制可执行程序，经过脱敏处理。<br>其中恶意文件的类型有感染型病毒、木马程序、挖矿程序、DDOS木马、勒索病毒等，数据总计6亿条。</p><h3 id="三、数据集"><a href="#三、数据集" class="headerlink" title="三、数据集"></a>三、数据集</h3><p>1、训练数据（train.zip）：调用记录近9000万次，文件1万多个（以文件编号汇总）</p><ul><li><p>一个文件调用的api数量有可能很多，对于一个tid中调用超过5000个api的文件，我们进行了截断，按照顺序保留了每个tid前5000个api的记录。</p></li><li><p>不同线程tid之间没有顺序关系，同一个tid里的index由小到大代表调用的先后顺序关系。<br>  注3：index是单个文件在沙箱执行时的全局顺序，由于沙箱执行时间有精度限制，所以会出现一个index上出现同线程或者不同线程都在执行多次api的情况，可以保证同tid内部的顺序，但不保证连续。</p></li></ul><p>2、测试数据（test.zip）：调用记录近8000万次，文件1万多个。</p><p>说明：格式除了没有label字段，其他数据规格与训练数据一致。</p><h3 id="四、字段说明"><a href="#四、字段说明" class="headerlink" title="四、字段说明"></a>四、字段说明</h3><p>train.csv和test.csv字段说明</p><table><thead><tr><th>字段</th><th>类型</th><th>解释</th></tr></thead><tbody><tr><td>file_id</td><td>bigint</td><td>文件编号</td></tr><tr><td>label</td><td>bigint</td><td>文件标签，0-正常&#x2F;1-勒索病毒&#x2F;2-挖矿程序&#x2F;3-DDoS木马&#x2F;4-蠕虫病毒&#x2F;5-感染型病毒&#x2F;6-后门程序&#x2F;7-木马程序</td></tr><tr><td>api</td><td>string</td><td>文件调用的API名称</td></tr><tr><td>tid</td><td>bigint</td><td>调用API的线程编号</td></tr><tr><td>index</td><td>string</td><td>线程中API调用的顺序编号</td></tr></tbody></table><h2 id="BaseLine-V1-lgb–分数-0-715840"><a href="#BaseLine-V1-lgb–分数-0-715840" class="headerlink" title="BaseLine V1_lgb–分数: 0.715840"></a>BaseLine V1_lgb–分数: 0.715840</h2><h3 id="一、数据探索"><a href="#一、数据探索" class="headerlink" title="一、数据探索"></a>一、数据探索</h3><p><strong>写法1</strong></p><p>Pandas使用chunksize分块处理大型csv文件，加载数据</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd<span class="token comment"># 分段数据加载基础方法</span><span class="token keyword">def</span> <span class="token function">get_data</span><span class="token punctuation">(</span>file_name<span class="token punctuation">)</span><span class="token punctuation">:</span>    result <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    chunk_index <span class="token operator">=</span> <span class="token number">0</span>    <span class="token keyword">for</span> df <span class="token keyword">in</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token builtin">open</span><span class="token punctuation">(</span>file_name<span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> chunksize <span class="token operator">=</span> <span class="token number">1000000</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        result<span class="token punctuation">.</span>append<span class="token punctuation">(</span>df<span class="token punctuation">)</span>        chunk_index <span class="token operator">+=</span> <span class="token number">1</span>    result <span class="token operator">=</span> pd<span class="token punctuation">.</span>concat<span class="token punctuation">(</span>result<span class="token punctuation">,</span> ignore_index<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> result<span class="token comment">#数据加载</span>train <span class="token operator">=</span> get_data<span class="token punctuation">(</span><span class="token string">'./security_train.csv'</span><span class="token punctuation">)</span>test <span class="token operator">=</span> get_data<span class="token punctuation">(</span><span class="token string">'./security_test.csv'</span><span class="token punctuation">)</span><span class="token comment">#将数据采用pickle方式存储，加快文件的读取速度</span><span class="token keyword">import</span> pickle<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'./train.pkl'</span><span class="token punctuation">,</span> <span class="token string">'wb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">file</span><span class="token punctuation">:</span>    pickle<span class="token punctuation">.</span>dump<span class="token punctuation">(</span>train<span class="token punctuation">,</span><span class="token builtin">file</span><span class="token punctuation">)</span><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'./test.pkl'</span><span class="token punctuation">,</span> <span class="token string">'wb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">file</span><span class="token punctuation">:</span>    pickle<span class="token punctuation">.</span>dump<span class="token punctuation">(</span>test<span class="token punctuation">,</span><span class="token builtin">file</span><span class="token punctuation">)</span><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'./train.pkl'</span><span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>    train <span class="token operator">=</span> pickle<span class="token punctuation">.</span>load<span class="token punctuation">(</span>f<span class="token punctuation">)</span>    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'./test.pkl'</span><span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>    test <span class="token operator">=</span> pickle<span class="token punctuation">.</span>load<span class="token punctuation">(</span>f<span class="token punctuation">)</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>写法2</strong></p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 获取读文件指针 </span>data<span class="token operator">=</span>pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span>filename<span class="token punctuation">,</span> iterator<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token comment"># 顺序读取100000行数据 </span>chunk <span class="token operator">=</span> data<span class="token punctuation">.</span>get_chunk<span class="token punctuation">(</span><span class="token number">100000</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>查看内存使用情况</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> os<span class="token keyword">import</span> psutilmem <span class="token operator">=</span> psutil<span class="token punctuation">.</span>virtual_memory<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'总内存：'</span><span class="token punctuation">,</span>mem<span class="token punctuation">.</span>total<span class="token operator">/</span><span class="token number">1024</span><span class="token operator">/</span><span class="token number">1024</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'已使用内存：'</span><span class="token punctuation">,</span>mem<span class="token punctuation">.</span>used<span class="token operator">/</span><span class="token number">1024</span><span class="token operator">/</span><span class="token number">1024</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'空闲内存：'</span><span class="token punctuation">,</span>mem<span class="token punctuation">.</span>free<span class="token operator">/</span><span class="token number">1024</span><span class="token operator">/</span><span class="token number">1024</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'使用占卜：'</span><span class="token punctuation">,</span>mem<span class="token punctuation">.</span>percent<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'当前线程PID：'</span><span class="token punctuation">,</span>os<span class="token punctuation">.</span>getpid<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>查看某个变量的资源使用情况</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> syssys<span class="token punctuation">.</span>getsizeof<span class="token punctuation">(</span>df_all<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">1024</span><span class="token operator">/</span><span class="token number">1024</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>针对不同的变量，进行内存释放</p><h3 id="二、特征工程"><a href="#二、特征工程" class="headerlink" title="二、特征工程"></a>二、特征工程</h3><h4 id="1、对api字段做LabelEncoder"><a href="#1、对api字段做LabelEncoder" class="headerlink" title="1、对api字段做LabelEncoder"></a>1、对api字段做LabelEncoder</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 对api字段进行LabelEncoder</span><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>preprocessing <span class="token keyword">import</span> LabelEncoderle <span class="token operator">=</span> LabelEncoder<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment"># 将训练集和测试集进行合并</span>df_all <span class="token operator">=</span> pd<span class="token punctuation">.</span>concat<span class="token punctuation">(</span><span class="token punctuation">[</span>train<span class="token punctuation">,</span> test<span class="token punctuation">]</span><span class="token punctuation">)</span>df_all<span class="token punctuation">[</span><span class="token string">'api'</span><span class="token punctuation">]</span> <span class="token operator">=</span> le<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>df_all<span class="token punctuation">[</span><span class="token string">'api'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>train<span class="token punctuation">[</span><span class="token string">'api'</span><span class="token punctuation">]</span> <span class="token operator">=</span> df_all<span class="token punctuation">[</span>df_all<span class="token punctuation">[</span><span class="token string">'label'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>notnull<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'api'</span><span class="token punctuation">]</span>test<span class="token punctuation">[</span><span class="token string">'api'</span><span class="token punctuation">]</span> <span class="token operator">=</span> df_all<span class="token punctuation">[</span>df_all<span class="token punctuation">[</span><span class="token string">'label'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>isnull<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'api'</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="2、对File-id做聚合处理"><a href="#2、对File-id做聚合处理" class="headerlink" title="2、对File_id做聚合处理"></a>2、对File_id做聚合处理</h4><p>对File_id做聚合处理，并去重操作和使用统计特征，主要包括数量，最大值，最小值，平均值，并保存下来</p><ol><li>去除完全重复的行数据</li></ol><pre class="line-numbers language-python" data-language="python"><code class="language-python">data<span class="token punctuation">.</span>drop_duplicates<span class="token punctuation">(</span>inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ol start="2"><li>去除某几列重复的行数据</li></ol><pre class="line-numbers language-python" data-language="python"><code class="language-python">data<span class="token punctuation">.</span>drop_duplicates<span class="token punctuation">(</span>subset<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'A'</span><span class="token punctuation">,</span><span class="token string">'B'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>keep<span class="token operator">=</span><span class="token string">'first'</span><span class="token punctuation">,</span>inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li>subset： 列名，可选，默认为None</li><li>keep： {‘first’, ‘last’, False}, 默认值 ‘first’<ul><li>first： 保留第一次出现的重复行，删除后面的重复行。</li><li>last： 删除重复项，除了最后一次出现。</li><li>False： 删除所有重复项。</li></ul></li><li>inplace：布尔值，默认为False表示生成一个副本，inplace&#x3D;True表示直接在原来的DataFrame上删除重复项。</li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#定义重要特征，主要包括数量，最大值，最小值，平均值等等</span><span class="token keyword">def</span> <span class="token function">get_features</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span><span class="token punctuation">:</span>    df_file <span class="token operator">=</span> df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">'file_id'</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> <span class="token string">'label'</span> <span class="token keyword">in</span> df<span class="token punctuation">.</span>columns<span class="token punctuation">:</span>         df1 <span class="token operator">=</span> df<span class="token punctuation">.</span>drop_duplicates<span class="token punctuation">(</span>subset<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'file_id'</span><span class="token punctuation">,</span> <span class="token string">'label'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> keep<span class="token operator">=</span><span class="token string">'first'</span><span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        df1 <span class="token operator">=</span> df<span class="token punctuation">.</span>drop_duplicates<span class="token punctuation">(</span>subset<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'file_id'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> keep<span class="token operator">=</span><span class="token string">'first'</span><span class="token punctuation">)</span>    df1 <span class="token operator">=</span> df1<span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span><span class="token string">'file_id'</span><span class="token punctuation">)</span>    features <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'api'</span><span class="token punctuation">,</span> <span class="token string">'tid'</span><span class="token punctuation">,</span> <span class="token string">'index'</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> f <span class="token keyword">in</span> features<span class="token punctuation">:</span>        df1<span class="token punctuation">[</span>f<span class="token operator">+</span><span class="token string">'_count'</span><span class="token punctuation">]</span> <span class="token operator">=</span> df_file<span class="token punctuation">[</span>f<span class="token punctuation">]</span><span class="token punctuation">.</span>count<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>values        df1<span class="token punctuation">[</span>f<span class="token operator">+</span><span class="token string">'_nunique'</span><span class="token punctuation">]</span> <span class="token operator">=</span> df_file<span class="token punctuation">[</span>f<span class="token punctuation">]</span><span class="token punctuation">.</span>nunique<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>values        df1<span class="token punctuation">[</span>f<span class="token operator">+</span><span class="token string">'_min'</span><span class="token punctuation">]</span> <span class="token operator">=</span> df_file<span class="token punctuation">[</span>f<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>values        df1<span class="token punctuation">[</span>f<span class="token operator">+</span><span class="token string">'_max'</span><span class="token punctuation">]</span> <span class="token operator">=</span> df_file<span class="token punctuation">[</span>f<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>values        df1<span class="token punctuation">[</span>f<span class="token operator">+</span><span class="token string">'_mean'</span><span class="token punctuation">]</span> <span class="token operator">=</span> df_file<span class="token punctuation">[</span>f<span class="token punctuation">]</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>values          df1<span class="token punctuation">[</span>f<span class="token operator">+</span><span class="token string">'_median'</span><span class="token punctuation">]</span> <span class="token operator">=</span> df_file<span class="token punctuation">[</span>f<span class="token punctuation">]</span><span class="token punctuation">.</span>median<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>values          df1<span class="token punctuation">[</span>f<span class="token operator">+</span><span class="token string">'_std'</span><span class="token punctuation">]</span> <span class="token operator">=</span> df_file<span class="token punctuation">[</span>f<span class="token punctuation">]</span><span class="token punctuation">.</span>std<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>values          df1<span class="token punctuation">[</span>f<span class="token operator">+</span><span class="token string">'_ptp'</span><span class="token punctuation">]</span> <span class="token operator">=</span> df1<span class="token punctuation">[</span>f<span class="token operator">+</span><span class="token string">'_max'</span><span class="token punctuation">]</span> <span class="token operator">-</span> df1<span class="token punctuation">[</span>f<span class="token operator">+</span><span class="token string">'_min'</span><span class="token punctuation">]</span>    <span class="token keyword">return</span> df1<span class="token comment">#训练集与测试集添加特征</span>df_train <span class="token operator">=</span> get_features<span class="token punctuation">(</span>train<span class="token punctuation">)</span>df_test <span class="token operator">=</span> get_features<span class="token punctuation">(</span>test<span class="token punctuation">)</span><span class="token comment">#将特征的结果集保持，一遍后续直接使用</span>df_train<span class="token punctuation">.</span>to_pickle<span class="token punctuation">(</span><span class="token string">'.df_train.pkl'</span><span class="token punctuation">)</span>df_test<span class="token punctuation">.</span>to_pickle<span class="token punctuation">(</span><span class="token string">'./df_test.pkl'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="三、建立模型"><a href="#三、建立模型" class="headerlink" title="三、建立模型"></a>三、建立模型</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> lightgbm <span class="token keyword">as</span> lgb<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pdclf <span class="token operator">=</span> lgb<span class="token punctuation">.</span>LGBMClassifier<span class="token punctuation">(</span>num_leaves<span class="token operator">=</span><span class="token number">2</span><span class="token operator">**</span><span class="token number">5</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>reg_alpha<span class="token operator">=</span><span class="token number">0.25</span><span class="token punctuation">,</span>reg_lambda<span class="token operator">=</span><span class="token number">0.25</span><span class="token punctuation">,</span>objective<span class="token operator">=</span><span class="token string">'multiclass'</span><span class="token punctuation">,</span>                                                       max_depth<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>learning_rate<span class="token operator">=</span><span class="token number">0.005</span><span class="token punctuation">,</span>min_child_sample<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span>random_state<span class="token operator">=</span><span class="token number">2021</span><span class="token punctuation">,</span>                         n_estimators<span class="token operator">=</span><span class="token number">2000</span><span class="token punctuation">,</span>subsample<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>colsample_bytree<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span> clf<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>df_train<span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'label'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>df_train<span class="token punctuation">[</span><span class="token string">'label'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> result <span class="token operator">=</span> clf<span class="token punctuation">.</span>predict_proba<span class="token punctuation">(</span>df_test<span class="token punctuation">)</span>result_lgb <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>result<span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'prob0'</span><span class="token punctuation">,</span><span class="token string">'prob1'</span><span class="token punctuation">,</span><span class="token string">'prob2'</span><span class="token punctuation">,</span><span class="token string">'prob3'</span><span class="token punctuation">,</span><span class="token string">'prob4'</span><span class="token punctuation">,</span><span class="token string">'prob5'</span><span class="token punctuation">,</span><span class="token string">'prob6'</span><span class="token punctuation">,</span><span class="token string">'prob7'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>result_lgb<span class="token punctuation">[</span><span class="token string">'file_id'</span><span class="token punctuation">]</span> <span class="token operator">=</span> df_test<span class="token punctuation">[</span><span class="token string">'file_id'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>valuescolumns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'file_id'</span><span class="token punctuation">,</span><span class="token string">'prob0'</span><span class="token punctuation">,</span><span class="token string">'prob1'</span><span class="token punctuation">,</span><span class="token string">'prob2'</span><span class="token punctuation">,</span><span class="token string">'prob3'</span><span class="token punctuation">,</span><span class="token string">'prob4'</span><span class="token punctuation">,</span><span class="token string">'prob5'</span><span class="token punctuation">,</span><span class="token string">'prob6'</span><span class="token punctuation">,</span><span class="token string">'prob7'</span><span class="token punctuation">]</span>result_lgb<span class="token punctuation">.</span>to_csv<span class="token punctuation">(</span><span class="token string">'./baselineV1.csv'</span><span class="token punctuation">,</span>index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>columns <span class="token operator">=</span> columns <span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"已完成"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="BaseLine-V2-lgb–分数-0-517596"><a href="#BaseLine-V2-lgb–分数-0-517596" class="headerlink" title="BaseLine V2_lgb–分数: 0.517596"></a>BaseLine V2_lgb–分数: 0.517596</h2><h2 id="一、特征工程优化"><a href="#一、特征工程优化" class="headerlink" title="一、特征工程优化"></a>一、特征工程优化</h2><p>针对file_id 按照线程tid 和 顺序index进行排序 , 并拼接成字符串</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">get_apis</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment"># 按照file_id进行分组</span>    group_fileid <span class="token operator">=</span> df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">'file_id'</span><span class="token punctuation">)</span>        <span class="token comment"># 统计file_id 和对应的 api_sequence</span>    file_api <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>        <span class="token comment"># 计算每个file_id的api_sequence</span>    <span class="token keyword">for</span> file_id<span class="token punctuation">,</span> file_group <span class="token keyword">in</span> group_fileid<span class="token punctuation">:</span>        <span class="token comment"># 针对file_id 按照线程tid 和 顺序index进行排序</span>        result <span class="token operator">=</span> file_group<span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'tid'</span><span class="token punctuation">,</span> <span class="token string">'index'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ascending<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>        <span class="token comment">#得到api的调用序列</span>        api_sequence <span class="token operator">=</span> <span class="token string">' '</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>result<span class="token punctuation">[</span><span class="token string">'api'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token comment">#print(api_sequence)</span>        file_api<span class="token punctuation">[</span>file_id<span class="token punctuation">]</span> <span class="token operator">=</span> api_sequence    <span class="token keyword">return</span> file_apitrain_apis <span class="token operator">=</span> get_apis<span class="token punctuation">(</span>train<span class="token punctuation">)</span>test_apis <span class="token operator">=</span> get_apis<span class="token punctuation">(</span>test<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>将文本信息与BaselineV1中的统计特征合并</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'./df_train.pkl'</span><span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">file</span><span class="token punctuation">:</span>    df_train <span class="token operator">=</span> pickle<span class="token punctuation">.</span>load<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">)</span>    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'./df_test.pkl'</span><span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">file</span><span class="token punctuation">:</span>    df_test <span class="token operator">=</span> pickle<span class="token punctuation">.</span>load<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">)</span>    df_train<span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'api'</span><span class="token punctuation">,</span><span class="token string">'tid'</span><span class="token punctuation">,</span><span class="token string">'index'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>df_test<span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'api'</span><span class="token punctuation">,</span><span class="token string">'tid'</span><span class="token punctuation">,</span><span class="token string">'index'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>temp <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">.</span>from_dict<span class="token punctuation">(</span>train_apis<span class="token punctuation">,</span> orient<span class="token operator">=</span><span class="token string">'index'</span><span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'api'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>temp <span class="token operator">=</span> temp<span class="token punctuation">.</span>reset_index<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>rename<span class="token punctuation">(</span>columns<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">'index'</span><span class="token punctuation">:</span> <span class="token string">'file_id'</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>df_train <span class="token operator">=</span> df_train<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>temp<span class="token punctuation">,</span> on<span class="token operator">=</span><span class="token string">'file_id'</span><span class="token punctuation">,</span> how<span class="token operator">=</span><span class="token string">'left'</span><span class="token punctuation">)</span> temp <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">.</span>from_dict<span class="token punctuation">(</span>test_apis<span class="token punctuation">,</span> orient<span class="token operator">=</span><span class="token string">'index'</span><span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'api'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>temp <span class="token operator">=</span> temp<span class="token punctuation">.</span>reset_index<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>rename<span class="token punctuation">(</span>columns<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">'index'</span><span class="token punctuation">:</span> <span class="token string">'file_id'</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>df_test <span class="token operator">=</span> df_test<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>temp<span class="token punctuation">,</span> on<span class="token operator">=</span><span class="token string">'file_id'</span><span class="token punctuation">,</span> how<span class="token operator">=</span><span class="token string">'left'</span><span class="token punctuation">)</span> df_all <span class="token operator">=</span> pd<span class="token punctuation">.</span>concat<span class="token punctuation">(</span><span class="token punctuation">[</span>df_train<span class="token punctuation">,</span> df_test<span class="token punctuation">]</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>放入TfidfVectorizer做训练</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>feature_extraction<span class="token punctuation">.</span>text <span class="token keyword">import</span> TfidfVectorizer<span class="token comment">#使用1-3元语法（1元语法 + 2元语法 + 3 元语法）</span>vec<span class="token operator">=</span>TfidfVectorizer<span class="token punctuation">(</span>ngram_range<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>min_df<span class="token operator">=</span><span class="token number">0.01</span><span class="token punctuation">)</span>api_features<span class="token operator">=</span>vec<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>df_all<span class="token punctuation">[</span><span class="token string">'api'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>df_apis <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>api_features<span class="token punctuation">.</span>toarray<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> columns<span class="token operator">=</span>vec<span class="token punctuation">.</span>get_feature_names<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>df_apis<span class="token punctuation">.</span>to_pickle<span class="token punctuation">(</span><span class="token string">'./df_apis.pkl'</span><span class="token punctuation">)</span>df_apis<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>将tfidf特征 与原特征进行合并</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">df_train_apis<span class="token operator">=</span>df_apis<span class="token punctuation">[</span>df_apis<span class="token punctuation">.</span>index<span class="token operator">&lt;=</span><span class="token number">13886</span><span class="token punctuation">]</span>df_test_apis<span class="token operator">=</span>df_apis<span class="token punctuation">[</span>df_apis<span class="token punctuation">.</span>index<span class="token operator">></span><span class="token number">13886</span><span class="token punctuation">]</span><span class="token comment">#将tfidf特征前面的索引重新开始</span>df_test_apis<span class="token punctuation">.</span>index<span class="token operator">=</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>df_test_apis<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 将tfidf特征 与原特征进行合并</span>df_train <span class="token operator">=</span> df_train<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>df_train_apis<span class="token punctuation">,</span> left_index<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> right_index<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>df_test <span class="token operator">=</span> df_test<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>df_test_apis<span class="token punctuation">,</span> left_index<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> right_index<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token comment">#去掉object类型api后保存</span>df_train<span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token string">'api'</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>df_test<span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token string">'api'</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>df_train<span class="token punctuation">.</span>to_pickle<span class="token punctuation">(</span><span class="token string">'./df_train2.pkl'</span><span class="token punctuation">)</span>df_test<span class="token punctuation">.</span>to_pickle<span class="token punctuation">(</span><span class="token string">'./df_test2.pkl'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="BaseLine-V3-lgb-amp-xgb–分数-0-478824"><a href="#BaseLine-V3-lgb-amp-xgb–分数-0-478824" class="headerlink" title="BaseLine V3_lgb&amp;xgb–分数: 0.478824"></a>BaseLine V3_lgb&amp;xgb–分数: 0.478824</h2><h3 id="一、模型融合"><a href="#一、模型融合" class="headerlink" title="一、模型融合"></a>一、模型融合</h3><h4 id="1、lightgbm与xgboost做模型融合"><a href="#1、lightgbm与xgboost做模型融合" class="headerlink" title="1、lightgbm与xgboost做模型融合"></a>1、lightgbm与xgboost做模型融合</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> xgboost <span class="token keyword">as</span> xgbmodel_xgb <span class="token operator">=</span> xgb<span class="token punctuation">.</span>XGBClassifier<span class="token punctuation">(</span>            max_depth<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span> learning_rate<span class="token operator">=</span><span class="token number">0.005</span><span class="token punctuation">,</span> n_estimators<span class="token operator">=</span><span class="token number">3250</span><span class="token punctuation">,</span>             objective<span class="token operator">=</span><span class="token string">'multi:softprob'</span><span class="token punctuation">,</span> tree_method<span class="token operator">=</span><span class="token string">'gpu_hist'</span><span class="token punctuation">,</span>             subsample<span class="token operator">=</span><span class="token number">0.8</span><span class="token punctuation">,</span> colsample_bytree<span class="token operator">=</span><span class="token number">0.8</span><span class="token punctuation">,</span>             min_child_samples<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> eval_metric<span class="token operator">=</span><span class="token string">'logloss'</span><span class="token punctuation">,</span> reg_lambda<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span>model_xgb<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>df_train<span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token string">'label'</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> df_train<span class="token punctuation">[</span><span class="token string">'label'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>result_xgb <span class="token operator">=</span> model_xgb<span class="token punctuation">.</span>predict_proba<span class="token punctuation">(</span>df_test<span class="token punctuation">)</span>result_xgb <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>result_xgb<span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'prob0'</span><span class="token punctuation">,</span><span class="token string">'prob1'</span><span class="token punctuation">,</span><span class="token string">'prob2'</span><span class="token punctuation">,</span><span class="token string">'prob3'</span><span class="token punctuation">,</span><span class="token string">'prob4'</span><span class="token punctuation">,</span><span class="token string">'prob5'</span><span class="token punctuation">,</span><span class="token string">'prob6'</span><span class="token punctuation">,</span><span class="token string">'prob7'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>result_xgb<span class="token punctuation">[</span><span class="token string">'file_id'</span><span class="token punctuation">]</span> <span class="token operator">=</span> df_test<span class="token punctuation">[</span><span class="token string">'file_id'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>values <span class="token comment"># 对两个模型的结果 进行加权平均</span>result <span class="token operator">=</span> result_lgb<span class="token punctuation">.</span>copy<span class="token punctuation">(</span><span class="token punctuation">)</span>weight_lgb<span class="token punctuation">,</span> weight_xgb <span class="token operator">=</span> <span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">0.5</span>result<span class="token punctuation">[</span><span class="token string">'prob0'</span><span class="token punctuation">]</span> <span class="token operator">=</span> result<span class="token punctuation">[</span><span class="token string">'prob0'</span><span class="token punctuation">]</span> <span class="token operator">*</span> weight_lgb <span class="token operator">+</span> result_xgb<span class="token punctuation">[</span><span class="token string">'prob0'</span><span class="token punctuation">]</span> <span class="token operator">*</span> weight_xgbresult<span class="token punctuation">[</span><span class="token string">'prob1'</span><span class="token punctuation">]</span> <span class="token operator">=</span> result<span class="token punctuation">[</span><span class="token string">'prob1'</span><span class="token punctuation">]</span> <span class="token operator">*</span> weight_lgb <span class="token operator">+</span> result_xgb<span class="token punctuation">[</span><span class="token string">'prob1'</span><span class="token punctuation">]</span> <span class="token operator">*</span> weight_xgbresult<span class="token punctuation">[</span><span class="token string">'prob2'</span><span class="token punctuation">]</span> <span class="token operator">=</span> result<span class="token punctuation">[</span><span class="token string">'prob2'</span><span class="token punctuation">]</span> <span class="token operator">*</span> weight_lgb <span class="token operator">+</span> result_xgb<span class="token punctuation">[</span><span class="token string">'prob2'</span><span class="token punctuation">]</span> <span class="token operator">*</span> weight_xgbresult<span class="token punctuation">[</span><span class="token string">'prob3'</span><span class="token punctuation">]</span> <span class="token operator">=</span> result<span class="token punctuation">[</span><span class="token string">'prob3'</span><span class="token punctuation">]</span> <span class="token operator">*</span> weight_lgb <span class="token operator">+</span> result_xgb<span class="token punctuation">[</span><span class="token string">'prob3'</span><span class="token punctuation">]</span> <span class="token operator">*</span> weight_xgbresult<span class="token punctuation">[</span><span class="token string">'prob4'</span><span class="token punctuation">]</span> <span class="token operator">=</span> result<span class="token punctuation">[</span><span class="token string">'prob4'</span><span class="token punctuation">]</span> <span class="token operator">*</span> weight_lgb <span class="token operator">+</span> result_xgb<span class="token punctuation">[</span><span class="token string">'prob4'</span><span class="token punctuation">]</span> <span class="token operator">*</span> weight_xgbresult<span class="token punctuation">[</span><span class="token string">'prob5'</span><span class="token punctuation">]</span> <span class="token operator">=</span> result<span class="token punctuation">[</span><span class="token string">'prob5'</span><span class="token punctuation">]</span> <span class="token operator">*</span> weight_lgb <span class="token operator">+</span> result_xgb<span class="token punctuation">[</span><span class="token string">'prob5'</span><span class="token punctuation">]</span> <span class="token operator">*</span> weight_xgbresult<span class="token punctuation">[</span><span class="token string">'prob6'</span><span class="token punctuation">]</span> <span class="token operator">=</span> result<span class="token punctuation">[</span><span class="token string">'prob6'</span><span class="token punctuation">]</span> <span class="token operator">*</span> weight_lgb <span class="token operator">+</span> result_xgb<span class="token punctuation">[</span><span class="token string">'prob6'</span><span class="token punctuation">]</span> <span class="token operator">*</span> weight_xgbresult<span class="token punctuation">[</span><span class="token string">'prob7'</span><span class="token punctuation">]</span> <span class="token operator">=</span> result<span class="token punctuation">[</span><span class="token string">'prob7'</span><span class="token punctuation">]</span> <span class="token operator">*</span> weight_lgb <span class="token operator">+</span> result_xgb<span class="token punctuation">[</span><span class="token string">'prob7'</span><span class="token punctuation">]</span> <span class="token operator">*</span> weight_xgbcolumns <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'file_id'</span><span class="token punctuation">,</span> <span class="token string">'prob0'</span><span class="token punctuation">,</span><span class="token string">'prob1'</span><span class="token punctuation">,</span><span class="token string">'prob2'</span><span class="token punctuation">,</span><span class="token string">'prob3'</span><span class="token punctuation">,</span><span class="token string">'prob4'</span><span class="token punctuation">,</span><span class="token string">'prob5'</span><span class="token punctuation">,</span><span class="token string">'prob6'</span><span class="token punctuation">,</span><span class="token string">'prob7'</span><span class="token punctuation">]</span>result<span class="token punctuation">.</span>to_csv<span class="token punctuation">(</span><span class="token string">'./baselineV3.csv'</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> columns<span class="token operator">=</span>columns<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>2、百度Al Studio训练</p><p>（1）百度Al Studio最高使用python3.7，从python3.8移到百度Al Studio的，pickle保存的时候需要protocol&#x3D;4</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">pickle<span class="token punctuation">.</span>dump<span class="token punctuation">(</span>df_train<span class="token punctuation">,</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"./df_train3.pkl"</span><span class="token punctuation">,</span><span class="token string">"wb"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> protocol<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">)</span>pickle<span class="token punctuation">.</span>dump<span class="token punctuation">(</span>df_test<span class="token punctuation">,</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"./df_test3.pkl"</span><span class="token punctuation">,</span><span class="token string">"wb"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> protocol<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>并且最大只能上传150MB，需要压缩再上传</p><p>分卷压缩<br>右键需要压缩的文件 &gt; 添加到压缩文件 &gt; 压缩分卷大小设置为140M。</p><p>确定后，压缩得到各个分卷，名为filename.z01，filename.z02，···，filename.zip。</p><p>(2) 分卷合并<br>将分卷上传到AIstudio的项目中后，进行分卷合并，首先cd到分卷所在的目录，然后运行指令</p><pre class="line-numbers language-none"><code class="language-none">cat filename.* &gt; filename_all.zip<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>得到合并后的压缩卷filename_all.zip。</p><p>(3 )解压缩<br>运行指令 得到最终的压缩文件。</p><pre class="line-numbers language-none"><code class="language-none">unzip filename_all.zip<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>全部代码已放代码仓库：</strong><a href="https://github.com/wxydaydayup/Aliyun_MalwareDetection/tree/master">阿里云天池-安全恶意程序检测</a></p>]]></content>
      
      
      <categories>
          
          <category> 机器学习 </category>
          
          <category> 数据分析 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 机器学习 </tag>
            
            <tag> 数据分析 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>阿里云天池-新闻文本分类</title>
      <link href="/2022/10/24/%E9%98%BF%E9%87%8C%E4%BA%91%E5%A4%A9%E6%B1%A0-%E6%96%B0%E9%97%BB%E6%96%87%E6%9C%AC%E5%88%86%E7%B1%BB/"/>
      <url>/2022/10/24/%E9%98%BF%E9%87%8C%E4%BA%91%E5%A4%A9%E6%B1%A0-%E6%96%B0%E9%97%BB%E6%96%87%E6%9C%AC%E5%88%86%E7%B1%BB/</url>
      
        <content type="html"><![CDATA[<h1 id="阿里云天池-新闻文本分类"><a href="#阿里云天池-新闻文本分类" class="headerlink" title="阿里云天池-新闻文本分类"></a>阿里云天池-新闻文本分类</h1><h2 id="赛题说明"><a href="#赛题说明" class="headerlink" title="赛题说明"></a>赛题说明</h2><p>赛题链接：<a href="https://aistudio.baidu.com/aistudio/competition/detail/51/0/introduction">百度飞桨:  用户购买预测 </a></p><p>代码仓库：</p><h3 id="一、背景介绍"><a href="#一、背景介绍" class="headerlink" title="一、背景介绍"></a>一、背景介绍</h3><h3 id="二、任务介绍"><a href="#二、任务介绍" class="headerlink" title="二、任务介绍"></a>二、任务介绍</h3><h3 id="三、数据集"><a href="#三、数据集" class="headerlink" title="三、数据集"></a>三、数据集</h3><h3 id="四、字段说明"><a href="#四、字段说明" class="headerlink" title="四、字段说明"></a>四、字段说明</h3>]]></content>
      
      
      <categories>
          
          <category> 机器学习 </category>
          
          <category> 数据分析 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 机器学习 </tag>
            
            <tag> 数据分析 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>阿里云天池-贷款违约预测</title>
      <link href="/2022/10/24/%E9%98%BF%E9%87%8C%E4%BA%91%E5%A4%A9%E6%B1%A0-%E8%B4%B7%E6%AC%BE%E8%BF%9D%E7%BA%A6%E9%A2%84%E6%B5%8B/"/>
      <url>/2022/10/24/%E9%98%BF%E9%87%8C%E4%BA%91%E5%A4%A9%E6%B1%A0-%E8%B4%B7%E6%AC%BE%E8%BF%9D%E7%BA%A6%E9%A2%84%E6%B5%8B/</url>
      
        <content type="html"><![CDATA[<h1 id="阿里云天池-贷款违约预测"><a href="#阿里云天池-贷款违约预测" class="headerlink" title="阿里云天池-贷款违约预测"></a>阿里云天池-贷款违约预测</h1><h2 id="赛题说明"><a href="#赛题说明" class="headerlink" title="赛题说明"></a>赛题说明</h2><p>赛题链接：<a href="https://tianchi.aliyun.com/competition/entrance/531830/introduction">阿里云天池-贷款违约预测</a></p><p>代码仓库：<a href="https://github.com/wxydaydayup/LoanDefaultDetection/tree/master">阿里云天池-贷款违约预测—代码仓库</a></p><h3 id="一、背景介绍"><a href="#一、背景介绍" class="headerlink" title="一、背景介绍"></a>一、背景介绍</h3><p>赛题以金融风控中的个人信贷为背景，要求选手根据贷款申请人的数据信息预测其是否有违约的可能，以此判断是否通过此项贷款，这是一个典型的分类问题。</p><h3 id="二、任务介绍"><a href="#二、任务介绍" class="headerlink" title="二、任务介绍"></a>二、任务介绍</h3><p>赛题以预测用户贷款是否违约为任务，数据集报名后可见并可下载，该数据来自某信贷平台的贷款记录，总数据量超过120w，包含47列变量信息，其中15列为匿名变量。为了保证比赛的公平性，将会从中抽取80万条作为训练集，20万条作为测试集A，20万条作为测试集B，同时会对employmentTitle、purpose、postCode和title等信息进行脱敏。</p><h3 id="三、数据集"><a href="#三、数据集" class="headerlink" title="三、数据集"></a>三、数据集</h3><p>提交结果为每个测试样本是1的概率，也就是y为1的概率。评价方法为AUC评估模型效果（越大越好）。</p><p>提交前请确保预测结果的格式与sample_submit.csv中的格式一致，以及提交文件后缀名为csv。</p><p>形式如下：</p><pre class="line-numbers language-none"><code class="language-none">id,isDefault800000,0.5800001,0.5800002,0.5800003,0.5<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="四、字段说明"><a href="#四、字段说明" class="headerlink" title="四、字段说明"></a>四、字段说明</h3><table><thead><tr><th align="center"><strong>Field</strong></th><th align="center"><strong>Description</strong></th></tr></thead><tbody><tr><td align="center">id</td><td align="center">为贷款清单分配的唯一信用证标识</td></tr><tr><td align="center">loanAmnt</td><td align="center">贷款金额</td></tr><tr><td align="center">term</td><td align="center">贷款期限（year）</td></tr><tr><td align="center">interestRate</td><td align="center">贷款利率</td></tr><tr><td align="center">installment</td><td align="center">分期付款金额</td></tr><tr><td align="center">grade</td><td align="center">贷款等级</td></tr><tr><td align="center">subGrade</td><td align="center">贷款等级之子级</td></tr><tr><td align="center">employmentTitle</td><td align="center">就业职称</td></tr><tr><td align="center">employmentLength</td><td align="center">就业年限（年）</td></tr><tr><td align="center">homeOwnership</td><td align="center">借款人在登记时提供的房屋所有权状况</td></tr><tr><td align="center">annualIncome</td><td align="center">年收入</td></tr><tr><td align="center">verificationStatus</td><td align="center">验证状态</td></tr><tr><td align="center">issueDate</td><td align="center">贷款发放的月份</td></tr><tr><td align="center">purpose</td><td align="center">借款人在贷款申请时的贷款用途类别</td></tr><tr><td align="center">postCode</td><td align="center">借款人在贷款申请中提供的邮政编码的前3位数字</td></tr><tr><td align="center">regionCode</td><td align="center">地区编码</td></tr><tr><td align="center">dti</td><td align="center">债务收入比</td></tr><tr><td align="center">delinquency_2years</td><td align="center">借款人过去2年信用档案中逾期30天以上的违约事件数</td></tr><tr><td align="center">ficoRangeLow</td><td align="center">借款人在贷款发放时的fico所属的下限范围</td></tr><tr><td align="center">ficoRangeHigh</td><td align="center">借款人在贷款发放时的fico所属的上限范围</td></tr><tr><td align="center">openAcc</td><td align="center">借款人信用档案中未结信用额度的数量</td></tr><tr><td align="center">pubRec</td><td align="center">贬损公共记录的数量</td></tr><tr><td align="center">pubRecBankruptcies</td><td align="center">公开记录清除的数量</td></tr><tr><td align="center">revolBal</td><td align="center">信贷周转余额合计</td></tr><tr><td align="center">revolUtil</td><td align="center">循环额度利用率，或借款人使用的相对于所有可用循环信贷的信贷金额</td></tr><tr><td align="center">totalAcc</td><td align="center">借款人信用档案中当前的信用额度总数</td></tr><tr><td align="center">initialListStatus</td><td align="center">贷款的初始列表状态</td></tr><tr><td align="center">applicationType</td><td align="center">表明贷款是个人申请还是与两个共同借款人的联合申请</td></tr><tr><td align="center">earliesCreditLine</td><td align="center">借款人最早报告的信用额度开立的月份</td></tr><tr><td align="center">title</td><td align="center">借款人提供的贷款名称</td></tr><tr><td align="center">policyCode</td><td align="center">公开可用的策略_代码&#x3D;1新产品不公开可用的策略_代码&#x3D;2</td></tr><tr><td align="center">n系列匿名特征</td><td align="center">匿名特征n0-n14，为一些贷款人行为计数特征的处理</td></tr></tbody></table><h2 id="BaseLine-V1-cbt–分数-0-7345"><a href="#BaseLine-V1-cbt–分数-0-7345" class="headerlink" title="BaseLine V1_cbt–分数: 0.7345"></a>BaseLine V1_cbt–分数: 0.7345</h2><h3 id="一、数据探索"><a href="#一、数据探索" class="headerlink" title="一、数据探索"></a>一、数据探索</h3><h4 id="1、以直方图的形式展示数据信息"><a href="#1、以直方图的形式展示数据信息" class="headerlink" title="1、以直方图的形式展示数据信息"></a>1、以直方图的形式展示数据信息</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt<span class="token keyword">import</span> seaborn <span class="token keyword">as</span> sns<span class="token comment"># 以直方图的形式展示，isDefault表示显示数量</span>sns<span class="token punctuation">.</span>countplot<span class="token punctuation">(</span>x <span class="token operator">=</span> <span class="token string">'grade'</span><span class="token punctuation">,</span>hue<span class="token operator">=</span><span class="token string">'isDefault'</span><span class="token punctuation">,</span>data<span class="token operator">=</span>train<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h4 id="2、将数值类型的缺失值全部以中位数补全"><a href="#2、将数值类型的缺失值全部以中位数补全" class="headerlink" title="2、将数值类型的缺失值全部以中位数补全"></a>2、将数值类型的缺失值全部以中位数补全</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd<span class="token keyword">import</span> warningswarnings<span class="token punctuation">.</span>filterwarnings<span class="token punctuation">(</span><span class="token string">'ignore'</span><span class="token punctuation">)</span><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> StratifiedKFold<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> roc_auc_score<span class="token keyword">from</span> catboost <span class="token keyword">import</span> CatBoostClassifier<span class="token comment">#数据加载</span>train<span class="token operator">=</span>pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">"./train.csv"</span><span class="token punctuation">)</span>testA<span class="token operator">=</span>pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">"./testA.csv"</span><span class="token punctuation">)</span><span class="token comment">#将数值类型的缺失值全部以中位数补全</span>numerical_fea <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>train<span class="token punctuation">.</span>select_dtypes<span class="token punctuation">(</span>include<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'float'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>columns<span class="token punctuation">)</span>train<span class="token punctuation">[</span>numerical_fea<span class="token punctuation">]</span> <span class="token operator">=</span> train<span class="token punctuation">[</span>numerical_fea<span class="token punctuation">]</span><span class="token punctuation">.</span>fillna<span class="token punctuation">(</span>train<span class="token punctuation">[</span>numerical_fea<span class="token punctuation">]</span><span class="token punctuation">.</span>median<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>test<span class="token punctuation">[</span>numerical_fea<span class="token punctuation">]</span> <span class="token operator">=</span> test<span class="token punctuation">[</span>numerical_fea<span class="token punctuation">]</span><span class="token punctuation">.</span>fillna<span class="token punctuation">(</span>test<span class="token punctuation">[</span>numerical_fea<span class="token punctuation">]</span><span class="token punctuation">.</span>median<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'数值类型缺失值,中位数填充完成'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="3、将类别类型的缺失值全部以众数补全"><a href="#3、将类别类型的缺失值全部以众数补全" class="headerlink" title="3、将类别类型的缺失值全部以众数补全"></a>3、将类别类型的缺失值全部以众数补全</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#将类别类型的缺失值全部以众数补全</span><span class="token keyword">from</span> scipy <span class="token keyword">import</span> stats cat_fea <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>train<span class="token punctuation">.</span>select_dtypes<span class="token punctuation">(</span>exclude<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'float'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>columns<span class="token punctuation">)</span><span class="token keyword">for</span> cf <span class="token keyword">in</span> cat_fea<span class="token punctuation">:</span>    <span class="token keyword">if</span> train<span class="token punctuation">[</span>cf<span class="token punctuation">]</span><span class="token punctuation">.</span>isnull<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        train<span class="token punctuation">[</span>cf<span class="token punctuation">]</span> <span class="token operator">=</span> train<span class="token punctuation">[</span>cf<span class="token punctuation">]</span><span class="token punctuation">.</span>fillna<span class="token punctuation">(</span>stats<span class="token punctuation">.</span>mode<span class="token punctuation">(</span>train<span class="token punctuation">[</span>cf<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>cat_fea <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>test<span class="token punctuation">.</span>select_dtypes<span class="token punctuation">(</span>exclude<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'float'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>columns<span class="token punctuation">)</span><span class="token keyword">for</span> cf <span class="token keyword">in</span> cat_fea<span class="token punctuation">:</span>    <span class="token keyword">if</span> test<span class="token punctuation">[</span>cf<span class="token punctuation">]</span><span class="token punctuation">.</span>isnull<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        test<span class="token punctuation">[</span>cf<span class="token punctuation">]</span> <span class="token operator">=</span> test<span class="token punctuation">[</span>cf<span class="token punctuation">]</span><span class="token punctuation">.</span>fillna<span class="token punctuation">(</span>stats<span class="token punctuation">.</span>mode<span class="token punctuation">(</span>test<span class="token punctuation">[</span>cf<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'类别类型缺失值,众数填充完成'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="二、特征工程"><a href="#二、特征工程" class="headerlink" title="二、特征工程"></a>二、特征工程</h3><h4 id="1、时间多尺度变换与时间差计算"><a href="#1、时间多尺度变换与时间差计算" class="headerlink" title="1、时间多尺度变换与时间差计算"></a>1、时间多尺度变换与时间差计算</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> datetime<span class="token keyword">def</span> <span class="token function">create_days_diff</span><span class="token punctuation">(</span>selected_cols<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> selected <span class="token keyword">in</span> selected_cols<span class="token punctuation">:</span>        train<span class="token punctuation">[</span>selected<span class="token punctuation">]</span> <span class="token operator">=</span> pd<span class="token punctuation">.</span>to_datetime<span class="token punctuation">(</span>train<span class="token punctuation">[</span>selected<span class="token punctuation">]</span><span class="token punctuation">)</span>        tmp_str <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>train<span class="token punctuation">[</span>selected<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>year<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'-'</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span><span class="token string">"%02d"</span> <span class="token operator">%</span> train<span class="token punctuation">[</span>selected<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>month<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'-'</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span><span class="token string">"%02d"</span> <span class="token operator">%</span> train<span class="token punctuation">[</span>selected<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>day<span class="token punctuation">)</span>        startdate <span class="token operator">=</span> datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>strptime<span class="token punctuation">(</span>tmp_str<span class="token punctuation">,</span> <span class="token string">'%Y-%m-%d'</span><span class="token punctuation">)</span>        train<span class="token punctuation">[</span>selected<span class="token operator">+</span><span class="token string">'_diff'</span><span class="token punctuation">]</span> <span class="token operator">=</span> train<span class="token punctuation">[</span>selected<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x<span class="token operator">-</span>startdate<span class="token punctuation">)</span><span class="token punctuation">.</span>dt<span class="token punctuation">.</span>days                test<span class="token punctuation">[</span>selected<span class="token punctuation">]</span> <span class="token operator">=</span> pd<span class="token punctuation">.</span>to_datetime<span class="token punctuation">(</span>test<span class="token punctuation">[</span>selected<span class="token punctuation">]</span><span class="token punctuation">)</span>        tmp_str <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>test<span class="token punctuation">[</span>selected<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>year<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'-'</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span><span class="token string">"%02d"</span> <span class="token operator">%</span> test<span class="token punctuation">[</span>selected<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>month<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'-'</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span><span class="token string">"%02d"</span> <span class="token operator">%</span> test<span class="token punctuation">[</span>selected<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>day<span class="token punctuation">)</span>        startdate <span class="token operator">=</span> datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>strptime<span class="token punctuation">(</span>tmp_str<span class="token punctuation">,</span> <span class="token string">'%Y-%m-%d'</span><span class="token punctuation">)</span>        test<span class="token punctuation">[</span>selected<span class="token operator">+</span><span class="token string">'_diff'</span><span class="token punctuation">]</span> <span class="token operator">=</span> test<span class="token punctuation">[</span>selected<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x<span class="token operator">-</span>startdate<span class="token punctuation">)</span><span class="token punctuation">.</span>dt<span class="token punctuation">.</span>days                <span class="token keyword">print</span><span class="token punctuation">(</span>selected<span class="token operator">+</span><span class="token string">'_diff'</span><span class="token operator">+</span><span class="token string">' 时间差字段 已经创建'</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">create_ym_features</span><span class="token punctuation">(</span>selected_cols<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> selected <span class="token keyword">in</span> selected_cols<span class="token punctuation">:</span>        test<span class="token punctuation">[</span>selected<span class="token punctuation">]</span> <span class="token operator">=</span> pd<span class="token punctuation">.</span>to_datetime<span class="token punctuation">(</span>test<span class="token punctuation">[</span>selected<span class="token punctuation">]</span><span class="token punctuation">)</span>        train_temp <span class="token operator">=</span> pd<span class="token punctuation">.</span>DatetimeIndex<span class="token punctuation">(</span>train<span class="token punctuation">[</span>selected<span class="token punctuation">]</span><span class="token punctuation">)</span>        test_temp <span class="token operator">=</span> pd<span class="token punctuation">.</span>DatetimeIndex<span class="token punctuation">(</span>test<span class="token punctuation">[</span>selected<span class="token punctuation">]</span><span class="token punctuation">)</span>                train<span class="token punctuation">[</span>selected<span class="token operator">+</span><span class="token string">'_year'</span><span class="token punctuation">]</span> <span class="token operator">=</span> train_temp<span class="token punctuation">.</span>year        test<span class="token punctuation">[</span>selected<span class="token operator">+</span><span class="token string">'_year'</span><span class="token punctuation">]</span> <span class="token operator">=</span> test_temp<span class="token punctuation">.</span>year        <span class="token keyword">print</span><span class="token punctuation">(</span>selected<span class="token operator">+</span><span class="token string">'_year'</span><span class="token operator">+</span><span class="token string">'字段 已经创建'</span><span class="token punctuation">)</span>                train<span class="token punctuation">[</span>selected<span class="token operator">+</span><span class="token string">'_month'</span><span class="token punctuation">]</span> <span class="token operator">=</span> train_temp<span class="token punctuation">.</span>month        test<span class="token punctuation">[</span>selected<span class="token operator">+</span><span class="token string">'_month'</span><span class="token punctuation">]</span> <span class="token operator">=</span> test_temp<span class="token punctuation">.</span>month        <span class="token keyword">print</span><span class="token punctuation">(</span>selected<span class="token operator">+</span><span class="token string">'_month'</span><span class="token operator">+</span><span class="token string">'字段 已经创建'</span><span class="token punctuation">)</span>        selected_cols <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'issueDate'</span><span class="token punctuation">,</span><span class="token string">'earliesCreditLine'</span><span class="token punctuation">]</span>create_ym_features<span class="token punctuation">(</span>selected_cols<span class="token punctuation">)</span>create_days_diff<span class="token punctuation">(</span>selected_cols<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="2、将object字段编码"><a href="#2、将object字段编码" class="headerlink" title="2、将object字段编码"></a>2、将object字段编码</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">for</span> data <span class="token keyword">in</span> <span class="token punctuation">[</span>train<span class="token punctuation">]</span><span class="token punctuation">:</span>    <span class="token comment">#贷款等级</span>    data<span class="token punctuation">[</span><span class="token string">'grade'</span><span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">'grade'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token string">'A'</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'B'</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token string">'C'</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token string">'D'</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token string">'E'</span><span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token string">'F'</span><span class="token punctuation">:</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token string">'G'</span><span class="token punctuation">:</span><span class="token number">7</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>    <span class="token comment">#就业年限（年）</span>    data<span class="token punctuation">[</span><span class="token string">'employmentLength'</span><span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">'employmentLength'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token string">'1 year'</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'2 years'</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token string">'3 years'</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token string">'4 years'</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token string">'5 years'</span><span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token string">'6 years'</span><span class="token punctuation">:</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token string">'7 years'</span><span class="token punctuation">:</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token string">'8 years'</span><span class="token punctuation">:</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token string">'9 years'</span><span class="token punctuation">:</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token string">'10+ years'</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token string">'&lt; 1 year'</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>    <span class="token comment">#贷款等级之子级</span>    data<span class="token punctuation">[</span><span class="token string">'subGrade'</span><span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">'subGrade'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token string">'E2'</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'D2'</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token string">'D3'</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token string">'A4'</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token string">'C2'</span><span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token string">'A5'</span><span class="token punctuation">:</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token string">'C3'</span><span class="token punctuation">:</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token string">'B4'</span><span class="token punctuation">:</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token string">'B5'</span><span class="token punctuation">:</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token string">'E5'</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">,</span>        <span class="token string">'D4'</span><span class="token punctuation">:</span><span class="token number">11</span><span class="token punctuation">,</span><span class="token string">'B3'</span><span class="token punctuation">:</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token string">'B2'</span><span class="token punctuation">:</span><span class="token number">13</span><span class="token punctuation">,</span><span class="token string">'D1'</span><span class="token punctuation">:</span><span class="token number">14</span><span class="token punctuation">,</span><span class="token string">'E1'</span><span class="token punctuation">:</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token string">'C5'</span><span class="token punctuation">:</span><span class="token number">16</span><span class="token punctuation">,</span><span class="token string">'C1'</span><span class="token punctuation">:</span><span class="token number">17</span><span class="token punctuation">,</span><span class="token string">'A2'</span><span class="token punctuation">:</span><span class="token number">18</span><span class="token punctuation">,</span><span class="token string">'A3'</span><span class="token punctuation">:</span><span class="token number">19</span><span class="token punctuation">,</span><span class="token string">'B1'</span><span class="token punctuation">:</span><span class="token number">20</span><span class="token punctuation">,</span>        <span class="token string">'E3'</span><span class="token punctuation">:</span><span class="token number">21</span><span class="token punctuation">,</span><span class="token string">'F1'</span><span class="token punctuation">:</span><span class="token number">22</span><span class="token punctuation">,</span><span class="token string">'C4'</span><span class="token punctuation">:</span><span class="token number">23</span><span class="token punctuation">,</span><span class="token string">'A1'</span><span class="token punctuation">:</span><span class="token number">24</span><span class="token punctuation">,</span><span class="token string">'D5'</span><span class="token punctuation">:</span><span class="token number">25</span><span class="token punctuation">,</span><span class="token string">'F2'</span><span class="token punctuation">:</span><span class="token number">26</span><span class="token punctuation">,</span><span class="token string">'E4'</span><span class="token punctuation">:</span><span class="token number">27</span><span class="token punctuation">,</span><span class="token string">'F3'</span><span class="token punctuation">:</span><span class="token number">28</span><span class="token punctuation">,</span><span class="token string">'G2'</span><span class="token punctuation">:</span><span class="token number">29</span><span class="token punctuation">,</span><span class="token string">'F5'</span><span class="token punctuation">:</span><span class="token number">30</span><span class="token punctuation">,</span>        <span class="token string">'G3'</span><span class="token punctuation">:</span><span class="token number">31</span><span class="token punctuation">,</span><span class="token string">'G1'</span><span class="token punctuation">:</span><span class="token number">32</span><span class="token punctuation">,</span><span class="token string">'F4'</span><span class="token punctuation">:</span><span class="token number">33</span><span class="token punctuation">,</span><span class="token string">'G4'</span><span class="token punctuation">:</span><span class="token number">34</span><span class="token punctuation">,</span><span class="token string">'G5'</span><span class="token punctuation">:</span><span class="token number">35</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>        <span class="token comment">#借款人信用档案中当前的信用额度总数 除以 贷款金额</span>    data<span class="token punctuation">[</span><span class="token string">'rato'</span><span class="token punctuation">]</span><span class="token operator">=</span>data<span class="token punctuation">[</span><span class="token string">'totalAcc'</span><span class="token punctuation">]</span><span class="token operator">/</span>data<span class="token punctuation">[</span><span class="token string">'loanAmnt'</span><span class="token punctuation">]</span><span class="token keyword">for</span> data <span class="token keyword">in</span> <span class="token punctuation">[</span>test<span class="token punctuation">]</span><span class="token punctuation">:</span>    <span class="token comment">#贷款等级</span>    data<span class="token punctuation">[</span><span class="token string">'grade'</span><span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">'grade'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token string">'A'</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'B'</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token string">'C'</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token string">'D'</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token string">'E'</span><span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token string">'F'</span><span class="token punctuation">:</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token string">'G'</span><span class="token punctuation">:</span><span class="token number">7</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>    <span class="token comment">#就业年限（年）</span>    data<span class="token punctuation">[</span><span class="token string">'employmentLength'</span><span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">'employmentLength'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token string">'1 year'</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'2 years'</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token string">'3 years'</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token string">'4 years'</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token string">'5 years'</span><span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token string">'6 years'</span><span class="token punctuation">:</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token string">'7 years'</span><span class="token punctuation">:</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token string">'8 years'</span><span class="token punctuation">:</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token string">'9 years'</span><span class="token punctuation">:</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token string">'10+ years'</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token string">'&lt; 1 year'</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>    <span class="token comment">#贷款等级之子级</span>    data<span class="token punctuation">[</span><span class="token string">'subGrade'</span><span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">'subGrade'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token string">'E2'</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'D2'</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token string">'D3'</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token string">'A4'</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token string">'C2'</span><span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token string">'A5'</span><span class="token punctuation">:</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token string">'C3'</span><span class="token punctuation">:</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token string">'B4'</span><span class="token punctuation">:</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token string">'B5'</span><span class="token punctuation">:</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token string">'E5'</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">,</span>        <span class="token string">'D4'</span><span class="token punctuation">:</span><span class="token number">11</span><span class="token punctuation">,</span><span class="token string">'B3'</span><span class="token punctuation">:</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token string">'B2'</span><span class="token punctuation">:</span><span class="token number">13</span><span class="token punctuation">,</span><span class="token string">'D1'</span><span class="token punctuation">:</span><span class="token number">14</span><span class="token punctuation">,</span><span class="token string">'E1'</span><span class="token punctuation">:</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token string">'C5'</span><span class="token punctuation">:</span><span class="token number">16</span><span class="token punctuation">,</span><span class="token string">'C1'</span><span class="token punctuation">:</span><span class="token number">17</span><span class="token punctuation">,</span><span class="token string">'A2'</span><span class="token punctuation">:</span><span class="token number">18</span><span class="token punctuation">,</span><span class="token string">'A3'</span><span class="token punctuation">:</span><span class="token number">19</span><span class="token punctuation">,</span><span class="token string">'B1'</span><span class="token punctuation">:</span><span class="token number">20</span><span class="token punctuation">,</span>        <span class="token string">'E3'</span><span class="token punctuation">:</span><span class="token number">21</span><span class="token punctuation">,</span><span class="token string">'F1'</span><span class="token punctuation">:</span><span class="token number">22</span><span class="token punctuation">,</span><span class="token string">'C4'</span><span class="token punctuation">:</span><span class="token number">23</span><span class="token punctuation">,</span><span class="token string">'A1'</span><span class="token punctuation">:</span><span class="token number">24</span><span class="token punctuation">,</span><span class="token string">'D5'</span><span class="token punctuation">:</span><span class="token number">25</span><span class="token punctuation">,</span><span class="token string">'F2'</span><span class="token punctuation">:</span><span class="token number">26</span><span class="token punctuation">,</span><span class="token string">'E4'</span><span class="token punctuation">:</span><span class="token number">27</span><span class="token punctuation">,</span><span class="token string">'F3'</span><span class="token punctuation">:</span><span class="token number">28</span><span class="token punctuation">,</span><span class="token string">'G2'</span><span class="token punctuation">:</span><span class="token number">29</span><span class="token punctuation">,</span><span class="token string">'F5'</span><span class="token punctuation">:</span><span class="token number">30</span><span class="token punctuation">,</span>        <span class="token string">'G3'</span><span class="token punctuation">:</span><span class="token number">31</span><span class="token punctuation">,</span><span class="token string">'G1'</span><span class="token punctuation">:</span><span class="token number">32</span><span class="token punctuation">,</span><span class="token string">'F4'</span><span class="token punctuation">:</span><span class="token number">33</span><span class="token punctuation">,</span><span class="token string">'G4'</span><span class="token punctuation">:</span><span class="token number">34</span><span class="token punctuation">,</span><span class="token string">'G5'</span><span class="token punctuation">:</span><span class="token number">35</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>        <span class="token comment">#借款人信用档案中当前的信用额度总数 除以 贷款金额</span>    data<span class="token punctuation">[</span><span class="token string">'rato'</span><span class="token punctuation">]</span><span class="token operator">=</span>data<span class="token punctuation">[</span><span class="token string">'totalAcc'</span><span class="token punctuation">]</span><span class="token operator">/</span>data<span class="token punctuation">[</span><span class="token string">'loanAmnt'</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="三、模型建立"><a href="#三、模型建立" class="headerlink" title="三、模型建立"></a>三、模型建立</h3><p>使用CatBoost模型</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#CatBoost模型</span>model<span class="token operator">=</span>model <span class="token operator">=</span> CatBoostClassifier<span class="token punctuation">(</span>    loss_function<span class="token operator">=</span><span class="token string">"Logloss"</span><span class="token punctuation">,</span>    <span class="token comment"># 分类任务常用损失函数</span>    eval_metric<span class="token operator">=</span><span class="token string">"Accuracy"</span><span class="token punctuation">,</span>     <span class="token comment"># 表示用于过度拟合检测和最佳模型选择的度量标准；</span>    learning_rate<span class="token operator">=</span><span class="token number">0.08</span><span class="token punctuation">,</span>         <span class="token comment"># 表示学习率</span>    iterations<span class="token operator">=</span><span class="token number">10000</span><span class="token punctuation">,</span>    random_seed<span class="token operator">=</span><span class="token number">42</span><span class="token punctuation">,</span>           <span class="token comment"># 设置随机种子进行固定</span>    od_type<span class="token operator">=</span><span class="token string">"Iter"</span><span class="token punctuation">,</span>    metric_period<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">,</span>           <span class="token comment"># 与交叉验证folds数匹配</span>    max_depth <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">,</span>              <span class="token comment"># 表示树模型最大深度</span>    early_stopping_rounds<span class="token operator">=</span><span class="token number">500</span><span class="token punctuation">,</span>  <span class="token comment"># 早停步数</span>    use_best_model<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>    task_type<span class="token operator">=</span><span class="token string">"GPU"</span><span class="token punctuation">,</span>          <span class="token comment"># 数据量较小，GPU加速效果不明显</span>    bagging_temperature<span class="token operator">=</span><span class="token number">0.9</span><span class="token punctuation">,</span>    leaf_estimation_method<span class="token operator">=</span><span class="token string">"Newton"</span><span class="token punctuation">,</span><span class="token punctuation">)</span>n_folds <span class="token operator">=</span><span class="token number">10</span> <span class="token comment">#十折交叉校验</span>answers <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>mean_score <span class="token operator">=</span> <span class="token number">0</span>data_x<span class="token operator">=</span>train<span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'isDefault'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>data_y<span class="token operator">=</span>train<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'isDefault'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>copy<span class="token punctuation">(</span><span class="token punctuation">)</span>sk <span class="token operator">=</span> StratifiedKFold<span class="token punctuation">(</span>n_splits<span class="token operator">=</span>n_folds<span class="token punctuation">,</span> shuffle<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">2021</span><span class="token punctuation">)</span>all_test <span class="token operator">=</span> test<span class="token punctuation">.</span>copy<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">for</span> train<span class="token punctuation">,</span> test <span class="token keyword">in</span> sk<span class="token punctuation">.</span>split<span class="token punctuation">(</span>data_x<span class="token punctuation">,</span> data_y<span class="token punctuation">)</span><span class="token punctuation">:</span>      x_train <span class="token operator">=</span> data_x<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span>train<span class="token punctuation">]</span>    y_train <span class="token operator">=</span> data_y<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span>train<span class="token punctuation">]</span>    x_test <span class="token operator">=</span> data_x<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span>test<span class="token punctuation">]</span>    y_test <span class="token operator">=</span> data_y<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span>test<span class="token punctuation">]</span>    clf <span class="token operator">=</span> model<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>x_train<span class="token punctuation">,</span>y_train<span class="token punctuation">,</span> eval_set<span class="token operator">=</span><span class="token punctuation">(</span>x_test<span class="token punctuation">,</span>y_test<span class="token punctuation">)</span><span class="token punctuation">,</span>verbose<span class="token operator">=</span><span class="token number">500</span><span class="token punctuation">)</span> <span class="token comment"># 500条打印一条日志</span>        yy_pred_valid<span class="token operator">=</span>clf<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>x_test<span class="token punctuation">,</span>prediction_type<span class="token operator">=</span><span class="token string">'Probability'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'cat验证的auc:&#123;&#125;'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>roc_auc_score<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> yy_pred_valid<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    mean_score <span class="token operator">+=</span> roc_auc_score<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> yy_pred_valid<span class="token punctuation">)</span> <span class="token operator">/</span> n_folds        y_pred_valid <span class="token operator">=</span> clf<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>all_test<span class="token punctuation">,</span>prediction_type<span class="token operator">=</span><span class="token string">'Probability'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>    answers<span class="token punctuation">.</span>append<span class="token punctuation">(</span>y_pred_valid<span class="token punctuation">)</span> <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'mean valAuc:&#123;&#125;'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>mean_score<span class="token punctuation">)</span><span class="token punctuation">)</span>cat_pre<span class="token operator">=</span><span class="token builtin">sum</span><span class="token punctuation">(</span>answers<span class="token punctuation">)</span><span class="token operator">/</span>n_foldsresult<span class="token punctuation">[</span><span class="token string">'isDefault'</span><span class="token punctuation">]</span><span class="token operator">=</span>cat_preresult<span class="token punctuation">.</span>to_csv<span class="token punctuation">(</span><span class="token string">'./baselinev1.csv'</span><span class="token punctuation">,</span>index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="BaseLine-V1-cbt–分数-0-7349"><a href="#BaseLine-V1-cbt–分数-0-7349" class="headerlink" title="BaseLine V1_cbt–分数: 0.7349"></a>BaseLine V1_cbt–分数: 0.7349</h2><h3 id="一、特征工程优化"><a href="#一、特征工程优化" class="headerlink" title="一、特征工程优化"></a>一、特征工程优化</h3><p>1、<strong>min，max，mean，std没有意义，因为是单一特征</strong></p><p><strong>只增加count，isDefault_mean（唯一值个数少的情况，如果唯一值多，会早成标签泄露问题）</strong></p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#cat_fea 为类别特征（一般是出float以外，时间类型也不算）</span>cat_fea <span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'term'</span><span class="token punctuation">,</span><span class="token string">'grade'</span><span class="token punctuation">,</span><span class="token string">'subGrade'</span><span class="token punctuation">,</span><span class="token string">'employmentLength'</span><span class="token punctuation">,</span><span class="token string">'homeOwnership'</span><span class="token punctuation">,</span><span class="token string">'verificationStatus'</span><span class="token punctuation">,</span><span class="token string">'purpose'</span><span class="token punctuation">,</span><span class="token string">'regionCode'</span><span class="token punctuation">,</span><span class="token string">'initialListStatus'</span><span class="token punctuation">,</span><span class="token string">'applicationType'</span><span class="token punctuation">]</span>df <span class="token operator">=</span> pd<span class="token punctuation">.</span>concat<span class="token punctuation">(</span><span class="token punctuation">[</span>train<span class="token punctuation">,</span>test<span class="token punctuation">]</span><span class="token punctuation">,</span>axis <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token keyword">for</span> col <span class="token keyword">in</span> cat_fea<span class="token punctuation">:</span>    temp <span class="token operator">=</span> train<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span>col<span class="token punctuation">,</span>as_index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">[</span>col<span class="token punctuation">]</span><span class="token punctuation">.</span>agg<span class="token punctuation">(</span><span class="token punctuation">&#123;</span>col<span class="token operator">+</span><span class="token string">'_count'</span><span class="token punctuation">:</span> <span class="token string">'count'</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>    df <span class="token operator">=</span> pd<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>df<span class="token punctuation">,</span>temp<span class="token punctuation">,</span>on <span class="token operator">=</span> col<span class="token punctuation">,</span>how <span class="token operator">=</span> <span class="token string">'left'</span><span class="token punctuation">)</span>    <span class="token comment">#isDefault为标签项，需要替换</span>    temp <span class="token operator">=</span> train<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span>col<span class="token punctuation">,</span>as_index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'isDefault'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>agg<span class="token punctuation">(</span><span class="token punctuation">&#123;</span>col<span class="token operator">+</span><span class="token string">'_isDefault_mean'</span><span class="token punctuation">:</span> <span class="token string">'mean'</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>    df <span class="token operator">=</span> pd<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>df<span class="token punctuation">,</span>temp<span class="token punctuation">,</span>on <span class="token operator">=</span> col<span class="token punctuation">,</span>how <span class="token operator">=</span> <span class="token string">'left'</span><span class="token punctuation">)</span>train <span class="token operator">=</span> df<span class="token punctuation">[</span>df<span class="token punctuation">[</span><span class="token string">'isDefault'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>notnull<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span>test <span class="token operator">=</span> df<span class="token punctuation">[</span>df<span class="token punctuation">[</span><span class="token string">'isDefault'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>isnull<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>全部代码已放代码仓库：</strong><a href="https://github.com/wxydaydayup/LoanDefaultDetection/tree/master">阿里云天池-贷款违约预测—代码仓库</a></p>]]></content>
      
      
      <categories>
          
          <category> 机器学习 </category>
          
          <category> 数据分析 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 机器学习 </tag>
            
            <tag> 数据分析 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>百度飞桨-点击反欺诈预测</title>
      <link href="/2022/10/24/%E7%99%BE%E5%BA%A6%E9%A3%9E%E6%A1%A8-%E7%82%B9%E5%87%BB%E5%8F%8D%E6%AC%BA%E8%AF%88%E9%A2%84%E6%B5%8B/"/>
      <url>/2022/10/24/%E7%99%BE%E5%BA%A6%E9%A3%9E%E6%A1%A8-%E7%82%B9%E5%87%BB%E5%8F%8D%E6%AC%BA%E8%AF%88%E9%A2%84%E6%B5%8B/</url>
      
        <content type="html"><![CDATA[<h1 id="百度飞桨-点击反欺诈预测"><a href="#百度飞桨-点击反欺诈预测" class="headerlink" title="百度飞桨-点击反欺诈预测"></a>百度飞桨-点击反欺诈预测</h1><h2 id="赛题说明"><a href="#赛题说明" class="headerlink" title="赛题说明"></a>赛题说明</h2><p>赛题链接：<a href="https://aistudio.baidu.com/aistudio/competition/detail/52/0/introduction">百度飞桨：点击反欺诈预测</a></p><p>代码仓库：<a href="https://github.com/wxydaydayup/Baidu_MarTechChallenge">百度飞桨：点击反欺诈预测–代码仓库</a></p><h3 id="一、背景介绍"><a href="#一、背景介绍" class="headerlink" title="一、背景介绍"></a>一、背景介绍</h3><p>点击反欺诈预测 广告欺诈是数字营销需要面临的重要挑战之一，点击会欺诈浪费广告主大量金钱，同时对点击数据会产生误导作用。本次比赛提供了约50万次点击数据。特别注意：我们对数据进行了模拟生成，对某些特征含义进行了隐藏，并进行了脱敏处理。 请预测用户的点击行为是否为正常点击，还是作弊行为。点击欺诈预测适用于各种信息流广告投放，banner广告投放，以及百度网盟平台，帮助商家鉴别点击欺诈，锁定精准真实用户。</p><h3 id="二、任务介绍"><a href="#二、任务介绍" class="headerlink" title="二、任务介绍"></a>二、任务介绍</h3><p>测试集中提供了会话sid及该会话的各维度特征值，基于训练集得出的模型进行预测，判断该会话sid是否为作弊行为。</p><h3 id="三、数据集"><a href="#三、数据集" class="headerlink" title="三、数据集"></a>三、数据集</h3><p>选手报名后，可在【数据集】tab获取数据集，以及基线系统。</p><p><strong>训练集</strong>： train.csv （50万条）<br><strong>测试集</strong>： test1.csv（15万条）</p><h3 id="四、字段说明"><a href="#四、字段说明" class="headerlink" title="四、字段说明"></a>四、字段说明</h3><p>train.csv和test.csv字段说明</p><table><thead><tr><th align="left">字段</th><th align="left">类型</th><th align="left">说明</th></tr></thead><tbody><tr><td align="left">sid</td><td align="left">string</td><td align="left">样本id&#x2F;请求会话sid</td></tr><tr><td align="left">package</td><td align="left">string</td><td align="left">媒体信息，包名（已加密）</td></tr><tr><td align="left">version</td><td align="left">string</td><td align="left">媒体信息，app版本</td></tr><tr><td align="left">android_id</td><td align="left">string</td><td align="left">媒体信息，对外广告位ID（已加密）</td></tr><tr><td align="left">media_id</td><td align="left">string</td><td align="left">媒体信息，对外媒体ID（已加密）</td></tr><tr><td align="left">apptype</td><td align="left">int</td><td align="left">媒体信息，app所属分类</td></tr><tr><td align="left">timestamp</td><td align="left">bigint</td><td align="left">请求到达服务时间，单位ms</td></tr><tr><td align="left">location</td><td align="left">int</td><td align="left">用户地理位置编码（精确到城市）</td></tr><tr><td align="left">fea_hash</td><td align="left">int</td><td align="left">用户特征编码（具体物理含义略去）</td></tr><tr><td align="left">fea1_hash</td><td align="left">int</td><td align="left">用户特征编码（具体物理含义略去）</td></tr><tr><td align="left">cus_type</td><td align="left">int</td><td align="left">用户特征编码（具体物理含义略去）</td></tr><tr><td align="left">ntt</td><td align="left">int</td><td align="left">网络类型 0-未知, 1-有线网, 2-WIFI, 3-蜂窝网络未知, 4-2G, 5-3G, 6–4G</td></tr><tr><td align="left">carrier</td><td align="left">string</td><td align="left">设备使用的运营商 0-未知, 46000-移动, 46001-联通, 46003-电信</td></tr><tr><td align="left">os</td><td align="left">string</td><td align="left">操作系统，默认为android</td></tr><tr><td align="left">osv</td><td align="left">string</td><td align="left">操作系统版本</td></tr><tr><td align="left">lan</td><td align="left">string</td><td align="left">设备采用的语言，默认为中文</td></tr><tr><td align="left">dev_height</td><td align="left">int</td><td align="left">设备高</td></tr><tr><td align="left">dev_width</td><td align="left">int</td><td align="left">设备宽</td></tr><tr><td align="left">dev_ppi</td><td align="left">int</td><td align="left">屏幕分辨率</td></tr></tbody></table><h2 id="BaseLine-V1-lgb–分数-86-746"><a href="#BaseLine-V1-lgb–分数-86-746" class="headerlink" title="BaseLine V1_lgb–分数: 86.746"></a>BaseLine V1_lgb–分数: 86.746</h2><p>切换盘符：</p><pre class="line-numbers language-none"><code class="language-none">jupyter notebook D:\<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="一、数据探索"><a href="#一、数据探索" class="headerlink" title="一、数据探索"></a>一、数据探索</h3><h4 id="1、去除Unnameed字段"><a href="#1、去除Unnameed字段" class="headerlink" title="1、去除Unnameed字段"></a>1、去除Unnameed字段</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python">train <span class="token operator">=</span> train<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span>test <span class="token operator">=</span> test<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h4 id="2、查看字段类型"><a href="#2、查看字段类型" class="headerlink" title="2、查看字段类型"></a>2、查看字段类型</h4><p><strong>写法1:</strong></p><pre class="line-numbers language-python" data-language="python"><code class="language-python">train<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>写法2:</strong></p><p>或者直接查看类型为object的列</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">train<span class="token punctuation">.</span>select_dtypes<span class="token punctuation">(</span>include<span class="token operator">=</span><span class="token string">'object'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>columns<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>发现以下字段为object类型需要进行数值变换</p><pre class="line-numbers language-none"><code class="language-none">7   lan         316720 non-null  object 10  os          500000 non-null  object 11  osv         493439 non-null  object 15  version     500000 non-null  object 16  fea_hash    500000 non-null  object  <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>以lan为例查看里面数据情况</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">train<span class="token punctuation">[</span><span class="token string">'lan'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value_counts<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="3、查看缺失值的个数"><a href="#3、查看缺失值的个数" class="headerlink" title="3、查看缺失值的个数"></a>3、查看缺失值的个数</h4><p><strong>写法1：</strong></p><pre class="line-numbers language-python" data-language="python"><code class="language-python">train<span class="token punctuation">.</span>isnull<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>写法2：</strong></p><pre class="line-numbers language-python" data-language="python"><code class="language-python">t <span class="token operator">=</span> train<span class="token punctuation">.</span>isnull<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span>t<span class="token punctuation">[</span>t<span class="token operator">></span><span class="token number">0</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>发现以下字段缺少比较多</p><pre class="line-numbers language-none"><code class="language-none">lan           183280osv             6561<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h4 id="4、唯一值的个数"><a href="#4、唯一值的个数" class="headerlink" title="4、唯一值的个数"></a>4、唯一值的个数</h4><p>查看唯一值的个数</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">features <span class="token operator">=</span> train<span class="token punctuation">.</span>columns<span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">for</span> feature <span class="token keyword">in</span> features<span class="token punctuation">:</span>    <span class="token keyword">if</span> train<span class="token punctuation">[</span>feature<span class="token punctuation">]</span><span class="token punctuation">.</span>nunique<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>feature<span class="token punctuation">,</span>train<span class="token punctuation">[</span>feature<span class="token punctuation">]</span><span class="token punctuation">.</span>nunique<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>发现os字段的唯一值个数太少</p><pre class="line-numbers language-none"><code class="language-none">os 2<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>查看os</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">train<span class="token punctuation">[</span><span class="token string">'os'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value_counts<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>发现os数据都为android </p><pre class="line-numbers language-none"><code class="language-none">android    303175Android    196825Name: os, dtype: int64<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h4 id="5、数据探索的结论"><a href="#5、数据探索的结论" class="headerlink" title="5、数据探索的结论"></a>5、数据探索的结论</h4><p>object类型字段有：lan、osv 、osv、version、fea_hash</p><p>缺失值较多的字段有：lan、osv </p><p>唯一值个数较少且意义不大：os</p><p>没有意义的字段：sid</p><p>BaselineV1中也先去除timestamp</p><h4 id="6、特征的相关性分析-补充"><a href="#6、特征的相关性分析-补充" class="headerlink" title="6、特征的相关性分析(补充)"></a>6、特征的相关性分析(补充)</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 对特征列进行相关性分析</span><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt<span class="token operator">%</span>matplotlib inline<span class="token keyword">import</span> seaborn <span class="token keyword">as</span> snsplt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span>sns<span class="token punctuation">.</span>heatmap<span class="token punctuation">(</span>train<span class="token punctuation">.</span>corr<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>cbar<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>annot<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>cmap<span class="token operator">=</span><span class="token string">'Blues'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="二、数据预处理"><a href="#二、数据预处理" class="headerlink" title="二、数据预处理"></a>二、数据预处理</h3><p>最终去掉：【lan】【os】【osv】【version】【label】【sid】【timestamp】</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">remove_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'lan'</span><span class="token punctuation">,</span> <span class="token string">'os'</span><span class="token punctuation">,</span> <span class="token string">'osv'</span><span class="token punctuation">,</span> <span class="token string">'version'</span><span class="token punctuation">,</span> <span class="token string">'label'</span><span class="token punctuation">,</span> <span class="token string">'sid'</span><span class="token punctuation">,</span><span class="token string">'timestamp'</span><span class="token punctuation">]</span>col <span class="token operator">=</span> features <span class="token comment">#字段名</span><span class="token keyword">for</span> i <span class="token keyword">in</span> remove_list<span class="token punctuation">:</span>    col<span class="token punctuation">.</span>remove<span class="token punctuation">(</span>i<span class="token punctuation">)</span>features <span class="token operator">=</span> train<span class="token punctuation">[</span>col<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="三、特征工程"><a href="#三、特征工程" class="headerlink" title="三、特征工程"></a>三、特征工程</h3><h4 id="1、fea-hash特征变换"><a href="#1、fea-hash特征变换" class="headerlink" title="1、fea_hash特征变换"></a>1、fea_hash特征变换</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#查看数据值</span>train<span class="token punctuation">[</span><span class="token string">'fea_hash'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value_counts<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#查看统计信息</span>train<span class="token punctuation">[</span><span class="token string">'fea_hash'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>describe<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#查看映射的长度特征情况</span>train<span class="token punctuation">[</span><span class="token string">'fea_hash'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span><span class="token builtin">len</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value_counts<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>fea_hash进行特征变换</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># fea_hash的长度为新特征</span>features<span class="token punctuation">[</span><span class="token string">'fea_hash_len'</span><span class="token punctuation">]</span> <span class="token operator">=</span> features<span class="token punctuation">[</span><span class="token string">'fea_hash'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token builtin">len</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>features<span class="token punctuation">[</span><span class="token string">'fea1_hash_len'</span><span class="token punctuation">]</span> <span class="token operator">=</span> features<span class="token punctuation">[</span><span class="token string">'fea1_hash'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token builtin">len</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># 如果fea_hash很长，都归为0，否则为自己的本身</span>features<span class="token punctuation">[</span><span class="token string">'fea_hash'</span><span class="token punctuation">]</span> <span class="token operator">=</span> features<span class="token punctuation">[</span><span class="token string">'fea_hash'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token number">0</span> <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token number">16</span> <span class="token keyword">else</span> <span class="token builtin">int</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>features<span class="token punctuation">[</span><span class="token string">'fea1_hash'</span><span class="token punctuation">]</span> <span class="token operator">=</span> features<span class="token punctuation">[</span><span class="token string">'fea1_hash'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token number">0</span> <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token number">16</span> <span class="token keyword">else</span> <span class="token builtin">int</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="四、模型建立"><a href="#四、模型建立" class="headerlink" title="四、模型建立"></a>四、模型建立</h3><p>test 做和train同样处理，利用lightgbm进行训练与预测，并保存，上诉过程全部合并代码如下：</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#BaselineV1</span><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd<span class="token keyword">import</span> warnings<span class="token keyword">import</span> lightgbm <span class="token keyword">as</span> lgbwarnings<span class="token punctuation">.</span>filterwarnings<span class="token punctuation">(</span><span class="token string">'ignore'</span><span class="token punctuation">)</span><span class="token comment"># 数据加载</span>train <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'./train.csv'</span><span class="token punctuation">)</span>test <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'./test1.csv'</span><span class="token punctuation">)</span><span class="token comment"># 去除Unnameed字段</span>train <span class="token operator">=</span> train<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span>test <span class="token operator">=</span> test<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token comment"># 去除数据探索发现问题的字段</span>col <span class="token operator">=</span> train<span class="token punctuation">.</span>columns<span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span>remove_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'lan'</span><span class="token punctuation">,</span> <span class="token string">'os'</span><span class="token punctuation">,</span> <span class="token string">'osv'</span><span class="token punctuation">,</span> <span class="token string">'version'</span><span class="token punctuation">,</span> <span class="token string">'label'</span><span class="token punctuation">,</span> <span class="token string">'sid'</span><span class="token punctuation">,</span><span class="token string">'timestamp'</span><span class="token punctuation">]</span><span class="token keyword">for</span> i <span class="token keyword">in</span> remove_list<span class="token punctuation">:</span>    col<span class="token punctuation">.</span>remove<span class="token punctuation">(</span>i<span class="token punctuation">)</span>features <span class="token operator">=</span> train<span class="token punctuation">[</span>col<span class="token punctuation">]</span>test_features <span class="token operator">=</span> test<span class="token punctuation">[</span>col<span class="token punctuation">]</span><span class="token comment"># fea_hash特征变换</span>features<span class="token punctuation">[</span><span class="token string">'fea_hash_len'</span><span class="token punctuation">]</span> <span class="token operator">=</span> features<span class="token punctuation">[</span><span class="token string">'fea_hash'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token builtin">len</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>features<span class="token punctuation">[</span><span class="token string">'fea1_hash_len'</span><span class="token punctuation">]</span> <span class="token operator">=</span> features<span class="token punctuation">[</span><span class="token string">'fea1_hash'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token builtin">len</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>features<span class="token punctuation">[</span><span class="token string">'fea_hash'</span><span class="token punctuation">]</span> <span class="token operator">=</span> features<span class="token punctuation">[</span><span class="token string">'fea_hash'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token number">0</span> <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token number">16</span> <span class="token keyword">else</span> <span class="token builtin">int</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>features<span class="token punctuation">[</span><span class="token string">'fea1_hash'</span><span class="token punctuation">]</span> <span class="token operator">=</span> features<span class="token punctuation">[</span><span class="token string">'fea1_hash'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token number">0</span> <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token number">16</span> <span class="token keyword">else</span> <span class="token builtin">int</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>test_features<span class="token punctuation">[</span><span class="token string">'fea_hash_len'</span><span class="token punctuation">]</span> <span class="token operator">=</span> test_features<span class="token punctuation">[</span><span class="token string">'fea_hash'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token builtin">len</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>test_features<span class="token punctuation">[</span><span class="token string">'fea1_hash_len'</span><span class="token punctuation">]</span> <span class="token operator">=</span> test_features<span class="token punctuation">[</span><span class="token string">'fea1_hash'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token builtin">len</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>test_features<span class="token punctuation">[</span><span class="token string">'fea_hash'</span><span class="token punctuation">]</span> <span class="token operator">=</span> test_features<span class="token punctuation">[</span><span class="token string">'fea_hash'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token number">0</span> <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token number">16</span> <span class="token keyword">else</span> <span class="token builtin">int</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>test_features<span class="token punctuation">[</span><span class="token string">'fea1_hash'</span><span class="token punctuation">]</span> <span class="token operator">=</span> test_features<span class="token punctuation">[</span><span class="token string">'fea1_hash'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token number">0</span> <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token number">16</span> <span class="token keyword">else</span> <span class="token builtin">int</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#lightgbm进行训练与预测</span>model <span class="token operator">=</span> lgb<span class="token punctuation">.</span>LGBMClassifier<span class="token punctuation">(</span><span class="token punctuation">)</span>model<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>features<span class="token punctuation">,</span>train<span class="token punctuation">[</span><span class="token string">'label'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>result <span class="token operator">=</span> model<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>test_features<span class="token punctuation">)</span><span class="token comment">#res包括sid字段与label字段</span>res <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>test<span class="token punctuation">[</span><span class="token string">'sid'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>res<span class="token punctuation">[</span><span class="token string">'label'</span><span class="token punctuation">]</span> <span class="token operator">=</span> result<span class="token comment">#保存在csv中</span>res<span class="token punctuation">.</span>to_csv<span class="token punctuation">(</span><span class="token string">'./baselineV1.csv'</span><span class="token punctuation">,</span>index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="BaseLine-V2-lgb–分数-88-2007"><a href="#BaseLine-V2-lgb–分数-88-2007" class="headerlink" title="BaseLine V2_lgb–分数: 88.2007"></a>BaseLine V2_lgb–分数: 88.2007</h2><h3 id="一、特征工程优化"><a href="#一、特征工程优化" class="headerlink" title="一、特征工程优化"></a>一、特征工程优化</h3><h4 id="1、利用osv特征"><a href="#1、利用osv特征" class="headerlink" title="1、利用osv特征"></a>1、利用osv特征</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 对osv进行数据清洗</span><span class="token keyword">def</span> <span class="token function">osv_trans</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">:</span>    x <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'Android_'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'Android '</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'W'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> <span class="token builtin">str</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token number">0</span><span class="token punctuation">:</span>        temp_index1 <span class="token operator">=</span> x<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> x<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token number">0</span><span class="token punctuation">:</span>            temp_index2 <span class="token operator">=</span> x<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            temp_index2 <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>         <span class="token keyword">if</span> x<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">'-'</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token number">0</span><span class="token punctuation">:</span>            temp_index2 <span class="token operator">=</span> x<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">'-'</span><span class="token punctuation">)</span>                    result <span class="token operator">=</span> x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span>temp_index1<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">'.'</span> <span class="token operator">+</span> x<span class="token punctuation">[</span>temp_index1<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">:</span>temp_index2<span class="token punctuation">]</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span>        <span class="token keyword">try</span><span class="token punctuation">:</span>            <span class="token keyword">return</span> <span class="token builtin">float</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>        <span class="token keyword">except</span><span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'有错误: '</span><span class="token operator">+</span>x<span class="token punctuation">)</span>            <span class="token keyword">return</span> <span class="token number">0</span>    <span class="token keyword">try</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token builtin">float</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>    <span class="token keyword">except</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'有错误: '</span><span class="token operator">+</span>x<span class="token punctuation">)</span>        <span class="token keyword">return</span> <span class="token number">0</span>features<span class="token punctuation">[</span><span class="token string">'osv'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>fillna<span class="token punctuation">(</span><span class="token string">'8.1.0'</span><span class="token punctuation">,</span> inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>features<span class="token punctuation">[</span><span class="token string">'osv'</span><span class="token punctuation">]</span> <span class="token operator">=</span> features<span class="token punctuation">[</span><span class="token string">'osv'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span>osv_trans<span class="token punctuation">)</span>test_features<span class="token punctuation">[</span><span class="token string">'osv'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>fillna<span class="token punctuation">(</span><span class="token string">'8.1.0'</span><span class="token punctuation">,</span> inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>test_features<span class="token punctuation">[</span><span class="token string">'osv'</span><span class="token punctuation">]</span> <span class="token operator">=</span> test_features<span class="token punctuation">[</span><span class="token string">'osv'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span>osv_trans<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="2、利用TimeStamp特征"><a href="#2、利用TimeStamp特征" class="headerlink" title="2、利用TimeStamp特征"></a>2、利用TimeStamp特征</h4><p>提取时间多尺度并计算时间diff(时间差)</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 对timestamp进行数据清洗与特征变换</span><span class="token keyword">from</span> datetime <span class="token keyword">import</span> datetimefeatures<span class="token punctuation">[</span><span class="token string">'timestamp'</span><span class="token punctuation">]</span> <span class="token operator">=</span> features<span class="token punctuation">[</span><span class="token string">'timestamp'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> datetime<span class="token punctuation">.</span>fromtimestamp<span class="token punctuation">(</span>x<span class="token operator">/</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">)</span>test_features<span class="token punctuation">[</span><span class="token string">'timestamp'</span><span class="token punctuation">]</span> <span class="token operator">=</span> test_features<span class="token punctuation">[</span><span class="token string">'timestamp'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> datetime<span class="token punctuation">.</span>fromtimestamp<span class="token punctuation">(</span>x<span class="token operator">/</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">)</span>temp <span class="token operator">=</span> pd<span class="token punctuation">.</span>DatetimeIndex<span class="token punctuation">(</span>features<span class="token punctuation">[</span><span class="token string">'timestamp'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>features<span class="token punctuation">[</span><span class="token string">'year'</span><span class="token punctuation">]</span> <span class="token operator">=</span> temp<span class="token punctuation">.</span>yearfeatures<span class="token punctuation">[</span><span class="token string">'month'</span><span class="token punctuation">]</span> <span class="token operator">=</span> temp<span class="token punctuation">.</span>monthfeatures<span class="token punctuation">[</span><span class="token string">'day'</span><span class="token punctuation">]</span> <span class="token operator">=</span> temp<span class="token punctuation">.</span>dayfeatures<span class="token punctuation">[</span><span class="token string">'hour'</span><span class="token punctuation">]</span> <span class="token operator">=</span> temp<span class="token punctuation">.</span>hourfeatures<span class="token punctuation">[</span><span class="token string">'minute'</span><span class="token punctuation">]</span> <span class="token operator">=</span> temp<span class="token punctuation">.</span>minutefeatures<span class="token punctuation">[</span><span class="token string">'week_day'</span><span class="token punctuation">]</span> <span class="token operator">=</span> temp<span class="token punctuation">.</span>weekday <span class="token comment">#星期几</span>start_time <span class="token operator">=</span> features<span class="token punctuation">[</span><span class="token string">'timestamp'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span>features<span class="token punctuation">[</span><span class="token string">'time_diff'</span><span class="token punctuation">]</span> <span class="token operator">=</span> features<span class="token punctuation">[</span><span class="token string">'timestamp'</span><span class="token punctuation">]</span> <span class="token operator">-</span> start_timefeatures<span class="token punctuation">[</span><span class="token string">'time_diff'</span><span class="token punctuation">]</span> <span class="token operator">=</span> features<span class="token punctuation">[</span><span class="token string">'time_diff'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>dt<span class="token punctuation">.</span>days <span class="token operator">+</span> features<span class="token punctuation">[</span><span class="token string">'time_diff'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>dt<span class="token punctuation">.</span>seconds<span class="token operator">/</span><span class="token number">3600</span><span class="token operator">/</span><span class="token number">24</span>temp <span class="token operator">=</span> pd<span class="token punctuation">.</span>DatetimeIndex<span class="token punctuation">(</span>test_features<span class="token punctuation">[</span><span class="token string">'timestamp'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>test_features<span class="token punctuation">[</span><span class="token string">'year'</span><span class="token punctuation">]</span> <span class="token operator">=</span> temp<span class="token punctuation">.</span>yeartest_features<span class="token punctuation">[</span><span class="token string">'month'</span><span class="token punctuation">]</span> <span class="token operator">=</span> temp<span class="token punctuation">.</span>monthtest_features<span class="token punctuation">[</span><span class="token string">'day'</span><span class="token punctuation">]</span> <span class="token operator">=</span> temp<span class="token punctuation">.</span>daytest_features<span class="token punctuation">[</span><span class="token string">'hour'</span><span class="token punctuation">]</span> <span class="token operator">=</span> temp<span class="token punctuation">.</span>hourtest_features<span class="token punctuation">[</span><span class="token string">'minute'</span><span class="token punctuation">]</span> <span class="token operator">=</span> temp<span class="token punctuation">.</span>minutetest_features<span class="token punctuation">[</span><span class="token string">'week_day'</span><span class="token punctuation">]</span> <span class="token operator">=</span> temp<span class="token punctuation">.</span>weekday <span class="token comment">#星期几 </span>test_features<span class="token punctuation">[</span><span class="token string">'time_diff'</span><span class="token punctuation">]</span> <span class="token operator">=</span> test_features<span class="token punctuation">[</span><span class="token string">'timestamp'</span><span class="token punctuation">]</span> <span class="token operator">-</span> start_timetest_features<span class="token punctuation">[</span><span class="token string">'time_diff'</span><span class="token punctuation">]</span> <span class="token operator">=</span> test_features<span class="token punctuation">[</span><span class="token string">'time_diff'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>dt<span class="token punctuation">.</span>days <span class="token operator">+</span> test_features<span class="token punctuation">[</span><span class="token string">'time_diff'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>dt<span class="token punctuation">.</span>seconds<span class="token operator">/</span><span class="token number">3600</span><span class="token operator">/</span><span class="token number">24</span>col <span class="token operator">=</span> features<span class="token punctuation">.</span>columns<span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span>col<span class="token punctuation">.</span>remove<span class="token punctuation">(</span><span class="token string">'timestamp'</span><span class="token punctuation">)</span>features <span class="token operator">=</span> features<span class="token punctuation">[</span>col<span class="token punctuation">]</span>test_features <span class="token operator">=</span> test_features<span class="token punctuation">[</span>col<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="3、利用Version特征"><a href="#3、利用Version特征" class="headerlink" title="3、利用Version特征"></a>3、利用Version特征</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 对version进行数据清洗与特征变换</span><span class="token keyword">def</span> <span class="token function">version_trans</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> x<span class="token operator">==</span><span class="token string">'V3'</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token number">3</span>    <span class="token keyword">if</span> x<span class="token operator">==</span><span class="token string">'v1'</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token number">1</span>    <span class="token keyword">if</span> x<span class="token operator">==</span><span class="token string">'P_Final_6'</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token number">6</span>    <span class="token keyword">if</span> x<span class="token operator">==</span><span class="token string">'V6'</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token number">6</span>    <span class="token keyword">if</span> x<span class="token operator">==</span><span class="token string">'GA3'</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token number">3</span>    <span class="token keyword">if</span> x<span class="token operator">==</span><span class="token string">'GA2'</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token number">2</span>    <span class="token keyword">if</span> x<span class="token operator">==</span><span class="token string">'V2'</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token number">2</span>    <span class="token keyword">if</span> x<span class="token operator">==</span><span class="token string">'50'</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token number">5</span>    <span class="token keyword">return</span> <span class="token builtin">int</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>features<span class="token punctuation">[</span><span class="token string">'version'</span><span class="token punctuation">]</span> <span class="token operator">=</span> features<span class="token punctuation">[</span><span class="token string">'version'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span>version_trans<span class="token punctuation">)</span>test_features<span class="token punctuation">[</span><span class="token string">'version'</span><span class="token punctuation">]</span> <span class="token operator">=</span> test_features<span class="token punctuation">[</span><span class="token string">'version'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span>version_trans<span class="token punctuation">)</span>features<span class="token punctuation">[</span><span class="token string">'version'</span><span class="token punctuation">]</span> <span class="token operator">=</span> features<span class="token punctuation">[</span><span class="token string">'version'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token string">'int'</span><span class="token punctuation">)</span>test_features<span class="token punctuation">[</span><span class="token string">'version'</span><span class="token punctuation">]</span> <span class="token operator">=</span> test_features<span class="token punctuation">[</span><span class="token string">'version'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token string">'int'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="二、模型建立"><a href="#二、模型建立" class="headerlink" title="二、模型建立"></a>二、模型建立</h3><p>上诉过程合并代码如下：</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd<span class="token keyword">import</span> warnings<span class="token keyword">import</span> lightgbm <span class="token keyword">as</span> lgbwarnings<span class="token punctuation">.</span>filterwarnings<span class="token punctuation">(</span><span class="token string">'ignore'</span><span class="token punctuation">)</span><span class="token comment"># 数据加载和去除Unnameed字段</span>train <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'./train.csv'</span><span class="token punctuation">)</span>test <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'./test1.csv'</span><span class="token punctuation">)</span>train <span class="token operator">=</span> train<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span>test <span class="token operator">=</span> test<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token comment"># 去除数据探索发现问题的字段</span>col <span class="token operator">=</span> train<span class="token punctuation">.</span>columns<span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span>remove_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'lan'</span><span class="token punctuation">,</span> <span class="token string">'os'</span><span class="token punctuation">,</span><span class="token string">'label'</span><span class="token punctuation">,</span> <span class="token string">'sid'</span><span class="token punctuation">]</span><span class="token keyword">for</span> i <span class="token keyword">in</span> remove_list<span class="token punctuation">:</span>    col<span class="token punctuation">.</span>remove<span class="token punctuation">(</span>i<span class="token punctuation">)</span>features <span class="token operator">=</span> train<span class="token punctuation">[</span>col<span class="token punctuation">]</span>test_features <span class="token operator">=</span> test<span class="token punctuation">[</span>col<span class="token punctuation">]</span><span class="token comment"># 对osv进行数据清洗</span><span class="token keyword">def</span> <span class="token function">osv_trans</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">:</span>    x <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'Android_'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'Android '</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'W'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> <span class="token builtin">str</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token number">0</span><span class="token punctuation">:</span>        temp_index1 <span class="token operator">=</span> x<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> x<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token number">0</span><span class="token punctuation">:</span>            temp_index2 <span class="token operator">=</span> x<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            temp_index2 <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>         <span class="token keyword">if</span> x<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">'-'</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token number">0</span><span class="token punctuation">:</span>            temp_index2 <span class="token operator">=</span> x<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">'-'</span><span class="token punctuation">)</span>                    result <span class="token operator">=</span> x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span>temp_index1<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">'.'</span> <span class="token operator">+</span> x<span class="token punctuation">[</span>temp_index1<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">:</span>temp_index2<span class="token punctuation">]</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span>        <span class="token keyword">try</span><span class="token punctuation">:</span>            <span class="token keyword">return</span> <span class="token builtin">float</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>        <span class="token keyword">except</span><span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'有错误: '</span><span class="token operator">+</span>x<span class="token punctuation">)</span>            <span class="token keyword">return</span> <span class="token number">0</span>    <span class="token keyword">try</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token builtin">float</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>    <span class="token keyword">except</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'有错误: '</span><span class="token operator">+</span>x<span class="token punctuation">)</span>        <span class="token keyword">return</span> <span class="token number">0</span>features<span class="token punctuation">[</span><span class="token string">'osv'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>fillna<span class="token punctuation">(</span><span class="token string">'8.1.0'</span><span class="token punctuation">,</span> inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>features<span class="token punctuation">[</span><span class="token string">'osv'</span><span class="token punctuation">]</span> <span class="token operator">=</span> features<span class="token punctuation">[</span><span class="token string">'osv'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span>osv_trans<span class="token punctuation">)</span>test_features<span class="token punctuation">[</span><span class="token string">'osv'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>fillna<span class="token punctuation">(</span><span class="token string">'8.1.0'</span><span class="token punctuation">,</span> inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>test_features<span class="token punctuation">[</span><span class="token string">'osv'</span><span class="token punctuation">]</span> <span class="token operator">=</span> test_features<span class="token punctuation">[</span><span class="token string">'osv'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span>osv_trans<span class="token punctuation">)</span><span class="token comment"># 对timestamp进行数据清洗与特征变换,</span><span class="token keyword">from</span> datetime <span class="token keyword">import</span> datetimefeatures<span class="token punctuation">[</span><span class="token string">'timestamp'</span><span class="token punctuation">]</span> <span class="token operator">=</span> features<span class="token punctuation">[</span><span class="token string">'timestamp'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> datetime<span class="token punctuation">.</span>fromtimestamp<span class="token punctuation">(</span>x<span class="token operator">/</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">)</span>test_features<span class="token punctuation">[</span><span class="token string">'timestamp'</span><span class="token punctuation">]</span> <span class="token operator">=</span> test_features<span class="token punctuation">[</span><span class="token string">'timestamp'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> datetime<span class="token punctuation">.</span>fromtimestamp<span class="token punctuation">(</span>x<span class="token operator">/</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">)</span>temp <span class="token operator">=</span> pd<span class="token punctuation">.</span>DatetimeIndex<span class="token punctuation">(</span>features<span class="token punctuation">[</span><span class="token string">'timestamp'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>features<span class="token punctuation">[</span><span class="token string">'year'</span><span class="token punctuation">]</span> <span class="token operator">=</span> temp<span class="token punctuation">.</span>yearfeatures<span class="token punctuation">[</span><span class="token string">'month'</span><span class="token punctuation">]</span> <span class="token operator">=</span> temp<span class="token punctuation">.</span>monthfeatures<span class="token punctuation">[</span><span class="token string">'day'</span><span class="token punctuation">]</span> <span class="token operator">=</span> temp<span class="token punctuation">.</span>dayfeatures<span class="token punctuation">[</span><span class="token string">'hour'</span><span class="token punctuation">]</span> <span class="token operator">=</span> temp<span class="token punctuation">.</span>hourfeatures<span class="token punctuation">[</span><span class="token string">'minute'</span><span class="token punctuation">]</span> <span class="token operator">=</span> temp<span class="token punctuation">.</span>minutefeatures<span class="token punctuation">[</span><span class="token string">'week_day'</span><span class="token punctuation">]</span> <span class="token operator">=</span> temp<span class="token punctuation">.</span>weekday <span class="token comment">#星期几</span>start_time <span class="token operator">=</span> features<span class="token punctuation">[</span><span class="token string">'timestamp'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span>features<span class="token punctuation">[</span><span class="token string">'time_diff'</span><span class="token punctuation">]</span> <span class="token operator">=</span> features<span class="token punctuation">[</span><span class="token string">'timestamp'</span><span class="token punctuation">]</span> <span class="token operator">-</span> start_timefeatures<span class="token punctuation">[</span><span class="token string">'time_diff'</span><span class="token punctuation">]</span> <span class="token operator">=</span> features<span class="token punctuation">[</span><span class="token string">'time_diff'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>dt<span class="token punctuation">.</span>days <span class="token operator">+</span> features<span class="token punctuation">[</span><span class="token string">'time_diff'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>dt<span class="token punctuation">.</span>seconds<span class="token operator">/</span><span class="token number">3600</span><span class="token operator">/</span><span class="token number">24</span>temp <span class="token operator">=</span> pd<span class="token punctuation">.</span>DatetimeIndex<span class="token punctuation">(</span>test_features<span class="token punctuation">[</span><span class="token string">'timestamp'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>test_features<span class="token punctuation">[</span><span class="token string">'year'</span><span class="token punctuation">]</span> <span class="token operator">=</span> temp<span class="token punctuation">.</span>yeartest_features<span class="token punctuation">[</span><span class="token string">'month'</span><span class="token punctuation">]</span> <span class="token operator">=</span> temp<span class="token punctuation">.</span>monthtest_features<span class="token punctuation">[</span><span class="token string">'day'</span><span class="token punctuation">]</span> <span class="token operator">=</span> temp<span class="token punctuation">.</span>daytest_features<span class="token punctuation">[</span><span class="token string">'hour'</span><span class="token punctuation">]</span> <span class="token operator">=</span> temp<span class="token punctuation">.</span>hourtest_features<span class="token punctuation">[</span><span class="token string">'minute'</span><span class="token punctuation">]</span> <span class="token operator">=</span> temp<span class="token punctuation">.</span>minutetest_features<span class="token punctuation">[</span><span class="token string">'week_day'</span><span class="token punctuation">]</span> <span class="token operator">=</span> temp<span class="token punctuation">.</span>weekday <span class="token comment">#星期几 </span>test_features<span class="token punctuation">[</span><span class="token string">'time_diff'</span><span class="token punctuation">]</span> <span class="token operator">=</span> test_features<span class="token punctuation">[</span><span class="token string">'timestamp'</span><span class="token punctuation">]</span> <span class="token operator">-</span> start_timetest_features<span class="token punctuation">[</span><span class="token string">'time_diff'</span><span class="token punctuation">]</span> <span class="token operator">=</span> test_features<span class="token punctuation">[</span><span class="token string">'time_diff'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>dt<span class="token punctuation">.</span>days <span class="token operator">+</span> test_features<span class="token punctuation">[</span><span class="token string">'time_diff'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>dt<span class="token punctuation">.</span>seconds<span class="token operator">/</span><span class="token number">3600</span><span class="token operator">/</span><span class="token number">24</span>features <span class="token operator">=</span> features<span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'timestamp'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>axis <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span>test_features <span class="token operator">=</span> test_features<span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'timestamp'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>axis <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token comment"># 对version进行数据清洗与特征变换</span><span class="token keyword">def</span> <span class="token function">version_trans</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> x<span class="token operator">==</span><span class="token string">'V3'</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token number">3</span>    <span class="token keyword">if</span> x<span class="token operator">==</span><span class="token string">'v1'</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token number">1</span>    <span class="token keyword">if</span> x<span class="token operator">==</span><span class="token string">'P_Final_6'</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token number">6</span>    <span class="token keyword">if</span> x<span class="token operator">==</span><span class="token string">'V6'</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token number">6</span>    <span class="token keyword">if</span> x<span class="token operator">==</span><span class="token string">'GA3'</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token number">3</span>    <span class="token keyword">if</span> x<span class="token operator">==</span><span class="token string">'GA2'</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token number">2</span>    <span class="token keyword">if</span> x<span class="token operator">==</span><span class="token string">'V2'</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token number">2</span>    <span class="token keyword">if</span> x<span class="token operator">==</span><span class="token string">'50'</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token number">5</span>    <span class="token keyword">return</span> <span class="token builtin">int</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>features<span class="token punctuation">[</span><span class="token string">'version'</span><span class="token punctuation">]</span> <span class="token operator">=</span> features<span class="token punctuation">[</span><span class="token string">'version'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span>version_trans<span class="token punctuation">)</span>test_features<span class="token punctuation">[</span><span class="token string">'version'</span><span class="token punctuation">]</span> <span class="token operator">=</span> test_features<span class="token punctuation">[</span><span class="token string">'version'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span>version_trans<span class="token punctuation">)</span>features<span class="token punctuation">[</span><span class="token string">'version'</span><span class="token punctuation">]</span> <span class="token operator">=</span> features<span class="token punctuation">[</span><span class="token string">'version'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token string">'int'</span><span class="token punctuation">)</span>test_features<span class="token punctuation">[</span><span class="token string">'version'</span><span class="token punctuation">]</span> <span class="token operator">=</span> test_features<span class="token punctuation">[</span><span class="token string">'version'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token string">'int'</span><span class="token punctuation">)</span><span class="token comment"># 对fea_hash与fea1_hash特征变换</span>features<span class="token punctuation">[</span><span class="token string">'fea_hash_len'</span><span class="token punctuation">]</span> <span class="token operator">=</span> features<span class="token punctuation">[</span><span class="token string">'fea_hash'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token builtin">len</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>features<span class="token punctuation">[</span><span class="token string">'fea1_hash_len'</span><span class="token punctuation">]</span> <span class="token operator">=</span> features<span class="token punctuation">[</span><span class="token string">'fea1_hash'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token builtin">len</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>features<span class="token punctuation">[</span><span class="token string">'fea_hash'</span><span class="token punctuation">]</span> <span class="token operator">=</span> features<span class="token punctuation">[</span><span class="token string">'fea_hash'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token number">0</span> <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token number">16</span> <span class="token keyword">else</span> <span class="token builtin">int</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>features<span class="token punctuation">[</span><span class="token string">'fea1_hash'</span><span class="token punctuation">]</span> <span class="token operator">=</span> features<span class="token punctuation">[</span><span class="token string">'fea1_hash'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token number">0</span> <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token number">16</span> <span class="token keyword">else</span> <span class="token builtin">int</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>test_features<span class="token punctuation">[</span><span class="token string">'fea_hash_len'</span><span class="token punctuation">]</span> <span class="token operator">=</span> test_features<span class="token punctuation">[</span><span class="token string">'fea_hash'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token builtin">len</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>test_features<span class="token punctuation">[</span><span class="token string">'fea1_hash_len'</span><span class="token punctuation">]</span> <span class="token operator">=</span> test_features<span class="token punctuation">[</span><span class="token string">'fea1_hash'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token builtin">len</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>test_features<span class="token punctuation">[</span><span class="token string">'fea_hash'</span><span class="token punctuation">]</span> <span class="token operator">=</span> test_features<span class="token punctuation">[</span><span class="token string">'fea_hash'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token number">0</span> <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token number">16</span> <span class="token keyword">else</span> <span class="token builtin">int</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>test_features<span class="token punctuation">[</span><span class="token string">'fea1_hash'</span><span class="token punctuation">]</span> <span class="token operator">=</span> test_features<span class="token punctuation">[</span><span class="token string">'fea1_hash'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token number">0</span> <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token number">16</span> <span class="token keyword">else</span> <span class="token builtin">int</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#lightgbm进行训练与预测</span>model <span class="token operator">=</span> lgb<span class="token punctuation">.</span>LGBMClassifier<span class="token punctuation">(</span><span class="token punctuation">)</span>model<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>features<span class="token punctuation">,</span>train<span class="token punctuation">[</span><span class="token string">'label'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>result <span class="token operator">=</span> model<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>test_features<span class="token punctuation">)</span><span class="token comment">#res包括sid字段与label字段</span>res <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>test<span class="token punctuation">[</span><span class="token string">'sid'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>res<span class="token punctuation">[</span><span class="token string">'label'</span><span class="token punctuation">]</span> <span class="token operator">=</span> result<span class="token comment">#保存在csv中</span>res<span class="token punctuation">.</span>to_csv<span class="token punctuation">(</span><span class="token string">'./baselineV2.csv'</span><span class="token punctuation">,</span>index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"已完成"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="BaseLine-V3-xgb–分数-88-5073"><a href="#BaseLine-V3-xgb–分数-88-5073" class="headerlink" title="BaseLine V3_xgb–分数: 88.5073"></a>BaseLine V3_xgb–分数: 88.5073</h2><h3 id="一、特征工程优化-1"><a href="#一、特征工程优化-1" class="headerlink" title="一、特征工程优化"></a>一、特征工程优化</h3><h4 id="1、构造面积特征和相除特征"><a href="#1、构造面积特征和相除特征" class="headerlink" title="1、构造面积特征和相除特征"></a>1、构造面积特征和相除特征</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python">features<span class="token punctuation">[</span><span class="token string">'dev_area'</span><span class="token punctuation">]</span> <span class="token operator">=</span> features<span class="token punctuation">[</span><span class="token string">'dev_height'</span><span class="token punctuation">]</span> <span class="token operator">*</span> features<span class="token punctuation">[</span><span class="token string">'dev_width'</span><span class="token punctuation">]</span>test_features<span class="token punctuation">[</span><span class="token string">'dev_area'</span><span class="token punctuation">]</span> <span class="token operator">=</span> test_features<span class="token punctuation">[</span><span class="token string">'dev_height'</span><span class="token punctuation">]</span> <span class="token operator">*</span> test_features<span class="token punctuation">[</span><span class="token string">'dev_width'</span><span class="token punctuation">]</span>features<span class="token punctuation">[</span><span class="token string">'dev_rato'</span><span class="token punctuation">]</span> <span class="token operator">=</span> features<span class="token punctuation">[</span><span class="token string">'dev_height'</span><span class="token punctuation">]</span> <span class="token operator">/</span> features<span class="token punctuation">[</span><span class="token string">'dev_width'</span><span class="token punctuation">]</span>test_features<span class="token punctuation">[</span><span class="token string">'dev_rato'</span><span class="token punctuation">]</span> <span class="token operator">=</span> test_features<span class="token punctuation">[</span><span class="token string">'dev_height'</span><span class="token punctuation">]</span> <span class="token operator">/</span> test_features<span class="token punctuation">[</span><span class="token string">'dev_width'</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h4 id="2、APP版本与操作系统版本差"><a href="#2、APP版本与操作系统版本差" class="headerlink" title="2、APP版本与操作系统版本差"></a>2、APP版本与操作系统版本差</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python">features<span class="token punctuation">[</span><span class="token string">'version_osv'</span><span class="token punctuation">]</span> <span class="token operator">=</span> features<span class="token punctuation">[</span><span class="token string">'osv'</span><span class="token punctuation">]</span> <span class="token operator">-</span> features<span class="token punctuation">[</span><span class="token string">'version'</span><span class="token punctuation">]</span>test_features<span class="token punctuation">[</span><span class="token string">'version_osv'</span><span class="token punctuation">]</span> <span class="token operator">=</span> test_features<span class="token punctuation">[</span><span class="token string">'osv'</span><span class="token punctuation">]</span> <span class="token operator">-</span> test_features<span class="token punctuation">[</span><span class="token string">'version'</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="二、xgboost模型"><a href="#二、xgboost模型" class="headerlink" title="二、xgboost模型"></a>二、xgboost模型</h3><h4 id="1、LightGBM-祖传参数"><a href="#1、LightGBM-祖传参数" class="headerlink" title="1、LightGBM 祖传参数"></a>1、LightGBM 祖传参数</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python">clf <span class="token operator">=</span> lgb<span class="token punctuation">.</span>LGBMClassifier<span class="token punctuation">(</span>            num_leaves<span class="token operator">=</span><span class="token number">2</span><span class="token operator">**</span><span class="token number">5</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> reg_alpha<span class="token operator">=</span><span class="token number">0.25</span><span class="token punctuation">,</span> reg_lambda<span class="token operator">=</span><span class="token number">0.25</span><span class="token punctuation">,</span> objective<span class="token operator">=</span><span class="token string">'multiclass'</span><span class="token punctuation">,</span>            max_depth<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> learning_rate<span class="token operator">=</span><span class="token number">0.005</span><span class="token punctuation">,</span> min_child_samples<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">2021</span><span class="token punctuation">,</span>            n_estimators<span class="token operator">=</span><span class="token number">2000</span><span class="token punctuation">,</span> subsample<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> colsample_bytree<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>device <span class="token operator">=</span> gpugpu_platform_id <span class="token operator">=</span> <span class="token number">0</span>gpu_device_id <span class="token operator">=</span> <span class="token number">0</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="2、XGBoost祖传参数"><a href="#2、XGBoost祖传参数" class="headerlink" title="2、XGBoost祖传参数"></a>2、XGBoost祖传参数</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python">model_xgb <span class="token operator">=</span> xgb<span class="token punctuation">.</span>XGBClassifier<span class="token punctuation">(</span>            max_depth<span class="token operator">=</span><span class="token number">9</span><span class="token punctuation">,</span> learning_rate<span class="token operator">=</span><span class="token number">0.005</span><span class="token punctuation">,</span> n_estimators<span class="token operator">=</span><span class="token number">2000</span><span class="token punctuation">,</span>             objective<span class="token operator">=</span><span class="token string">'multi:softprob'</span><span class="token punctuation">,</span> tree_method<span class="token operator">=</span><span class="token string">'gpu_hist'</span><span class="token punctuation">,</span>             subsample<span class="token operator">=</span><span class="token number">0.8</span><span class="token punctuation">,</span> colsample_bytree<span class="token operator">=</span><span class="token number">0.8</span><span class="token punctuation">,</span>             min_child_samples<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> eval_metric<span class="token operator">=</span><span class="token string">'logloss'</span><span class="token punctuation">,</span> reg_lambda<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="3、使用xgboost并使用祖传参数"><a href="#3、使用xgboost并使用祖传参数" class="headerlink" title="3、使用xgboost并使用祖传参数"></a>3、使用xgboost并使用祖传参数</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">%</span><span class="token operator">%</span>time<span class="token comment">#lightgbm进行训练与预测</span><span class="token keyword">import</span> xgboost <span class="token keyword">as</span> xgbmodel_xgb <span class="token operator">=</span> xgb<span class="token punctuation">.</span>XGBClassifier<span class="token punctuation">(</span>            max_depth<span class="token operator">=</span><span class="token number">15</span><span class="token punctuation">,</span> learning_rate<span class="token operator">=</span><span class="token number">0.05</span><span class="token punctuation">,</span> n_estimators<span class="token operator">=</span><span class="token number">5000</span><span class="token punctuation">,</span>             objective<span class="token operator">=</span><span class="token string">'binary:logistic'</span><span class="token punctuation">,</span> tree_method<span class="token operator">=</span><span class="token string">'gpu_hist'</span><span class="token punctuation">,</span>             subsample<span class="token operator">=</span><span class="token number">0.8</span><span class="token punctuation">,</span> colsample_bytree<span class="token operator">=</span><span class="token number">0.8</span><span class="token punctuation">,</span>             min_child_samples<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> eval_metric<span class="token operator">=</span><span class="token string">'auc'</span><span class="token punctuation">,</span> reg_lambda<span class="token operator">=</span><span class="token number">0.5</span>        <span class="token punctuation">)</span>model_xgb<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>features<span class="token punctuation">,</span>train<span class="token punctuation">[</span><span class="token string">'label'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>result_xgb <span class="token operator">=</span> model<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>test_features<span class="token punctuation">)</span>res <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>test<span class="token punctuation">[</span><span class="token string">'sid'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>res<span class="token punctuation">[</span><span class="token string">'label'</span><span class="token punctuation">]</span> <span class="token operator">=</span> result_xgbres<span class="token punctuation">.</span>to_csv<span class="token punctuation">(</span><span class="token string">'./baselineV3.csv'</span><span class="token punctuation">,</span>index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"已完成"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>xgboost的祖传参数</p><table><thead><tr><th align="center">参数</th><th align="left">含义</th></tr></thead><tbody><tr><td align="center">max_depth</td><td align="left">含义：树的最大深度，用来避免过拟合的。max_depth越大，模型会学到更具体更局部的样本，需要使用CV函数来进行调优。 <br />默认值：6，典型值：3-10。<br />调参：值越大，越容易过拟合；值越小，越容易欠拟合。</td></tr><tr><td align="center">learning_rate</td><td align="left">含义：学习率，控制每次迭代更新权重时的步长<br />默认值：0.3，典型值：0.01-0.2。 <br />调参：值越小，训练越慢。</td></tr><tr><td align="center">n_estimators</td><td align="left">总共迭代的次数，即决策树的个数，相当于训练的轮数</td></tr><tr><td align="center">objective</td><td align="left">回归任务：reg:linear (默认)  reg: logistic <br />二分类  binary:logistic (概率)  binary：logitraw  (类别) <br />多分类  multi：softmax num_class&#x3D;n (返回类别) multi：softprob  num_class&#x3D;n(返回概率)</td></tr><tr><td align="center">tree_method</td><td align="left">可调用gpu：gpu_hist。使用功能的树的构建方法，hist代表使用直方图优化的近似贪婪的算法</td></tr><tr><td align="center">subsample</td><td align="left">含义：训练样本采样率（行采样），训练每棵树时，使用的数据占全部训练集的比例。这个参数控制对于每棵树，随机采样的比例。 减小这个参数的值，算法会更加保守，避免过拟合。但是，如果这个值设置得过小，它可能会导致欠拟合。<br />默认值：1，典型值：0.5-1。<br />调参：防止过拟合。</td></tr><tr><td align="center">colsample_bytree</td><td align="left">含义：训练每棵树时，使用的数据占全部训练集的比例。默认值为1，典型值为0.5-1。和GBM中的subsample参数一模一样。这个参数控制对于每棵树，随机采样的比例。 减小这个参数的值，算法会更加保守，避免过拟合。但是，如果这个值设置得过小，它可能会导致欠拟合。 <br />典型值：0.5-1 <br />调参：防止过拟合。</td></tr><tr><td align="center">min_child_samples</td><td align="left"></td></tr><tr><td align="center">eval_metric</td><td align="left">用户可以添加多种评价指标，对于Python用户要以list传递参数对给程序<br />可供的选择如下:  <br />回归任务(默认rmse)  ：rmse–均方根误差         mae–平均绝对误差 <br />分类任务(默认error) ： auc–roc曲线下面积        error–错误率（二分类）    merror–错误率（多分类） logloss–负对数似然函数（二分类）     mlogloss–负对数似然函数（多分类）</td></tr><tr><td align="center">reg_lambda</td><td align="left">L2正则化系数</td></tr></tbody></table><h4 id="4、可视化的方式查看特征的重要程度"><a href="#4、可视化的方式查看特征的重要程度" class="headerlink" title="4、可视化的方式查看特征的重要程度"></a>4、可视化的方式查看特征的重要程度</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> xgboost <span class="token keyword">import</span> plot_importance<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> pltplot_importance<span class="token punctuation">(</span>model_xgb<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h2 id="BaseLine-V4-xgb–分数-88-946"><a href="#BaseLine-V4-xgb–分数-88-946" class="headerlink" title="BaseLine V4_xgb–分数: 88.946"></a>BaseLine V4_xgb–分数: 88.946</h2><h3 id="一、使用十折交叉验证优化"><a href="#一、使用十折交叉验证优化" class="headerlink" title="一、使用十折交叉验证优化"></a>一、使用十折交叉验证优化</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">%</span><span class="token operator">%</span>time<span class="token comment"># 定义10折子模型</span><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> StratifiedKFold<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> accuracy_score<span class="token keyword">def</span> <span class="token function">xgb_model</span><span class="token punctuation">(</span>clf<span class="token punctuation">,</span>train_x<span class="token punctuation">,</span>train_y<span class="token punctuation">,</span>test<span class="token punctuation">)</span><span class="token punctuation">:</span>    sk<span class="token operator">=</span>StratifiedKFold<span class="token punctuation">(</span>n_splits<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span>random_state<span class="token operator">=</span><span class="token number">2021</span><span class="token punctuation">,</span>shuffle <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">)</span>    prob<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>    mean_acc<span class="token operator">=</span><span class="token number">0</span>    <span class="token keyword">for</span> k<span class="token punctuation">,</span><span class="token punctuation">(</span>train_index<span class="token punctuation">,</span>val_index<span class="token punctuation">)</span> <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>sk<span class="token punctuation">.</span>split<span class="token punctuation">(</span>train_x<span class="token punctuation">,</span>train_y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        train_x_real<span class="token operator">=</span>train_x<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span>train_index<span class="token punctuation">]</span>        train_y_real<span class="token operator">=</span>train_y<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span>train_index<span class="token punctuation">]</span>        val_x<span class="token operator">=</span>train_x<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span>val_index<span class="token punctuation">]</span>        val_y<span class="token operator">=</span>train_y<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span>val_index<span class="token punctuation">]</span>        <span class="token comment">#模型训练及验证集测试</span>        clf<span class="token operator">=</span>clf<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>train_x_real<span class="token punctuation">,</span>train_y_real<span class="token punctuation">)</span>        val_y_pred<span class="token operator">=</span>clf<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>val_x<span class="token punctuation">)</span>        acc_val<span class="token operator">=</span>accuracy_score<span class="token punctuation">(</span>val_y<span class="token punctuation">,</span>val_y_pred<span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'第&#123;&#125;个子模型 accuracy&#123;&#125;'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>k<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>acc_val<span class="token punctuation">)</span><span class="token punctuation">)</span>        mean_acc<span class="token operator">+=</span>mean_acc<span class="token operator">/</span><span class="token number">10</span>        <span class="token comment">#预测测试集</span>        test_y_pred<span class="token operator">=</span>clf<span class="token punctuation">.</span>predict_proba<span class="token punctuation">(</span>test<span class="token punctuation">)</span>        prob<span class="token punctuation">.</span>append<span class="token punctuation">(</span>test_y_pred<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>mean_acc<span class="token punctuation">)</span>    mean_prob<span class="token operator">=</span><span class="token builtin">sum</span><span class="token punctuation">(</span>prob<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">10</span>    <span class="token keyword">return</span> mean_prob  <span class="token keyword">import</span> xgboost <span class="token keyword">as</span> xgbmodel_xgb2 <span class="token operator">=</span> xgb<span class="token punctuation">.</span>XGBClassifier<span class="token punctuation">(</span>            max_depth<span class="token operator">=</span><span class="token number">15</span><span class="token punctuation">,</span> learning_rate<span class="token operator">=</span><span class="token number">0.005</span><span class="token punctuation">,</span> n_estimators<span class="token operator">=</span><span class="token number">5300</span><span class="token punctuation">,</span>             objective<span class="token operator">=</span><span class="token string">'binary:logistic'</span><span class="token punctuation">,</span> tree_method<span class="token operator">=</span><span class="token string">'gpu_hist'</span><span class="token punctuation">,</span>             subsample<span class="token operator">=</span><span class="token number">0.7</span><span class="token punctuation">,</span> colsample_bytree<span class="token operator">=</span><span class="token number">0.7</span><span class="token punctuation">,</span>             min_child_samples<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> eval_metric<span class="token operator">=</span><span class="token string">'auc'</span><span class="token punctuation">,</span> reg_lambda<span class="token operator">=</span><span class="token number">0.5</span>        <span class="token punctuation">)</span>result_xgb<span class="token operator">=</span>xgb_model<span class="token punctuation">(</span>model_xgb2<span class="token punctuation">,</span>features<span class="token punctuation">,</span>train<span class="token punctuation">[</span><span class="token string">'label'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>test_features<span class="token punctuation">)</span> result_xgb2<span class="token operator">=</span><span class="token punctuation">[</span>x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> result_xgb<span class="token punctuation">]</span>result_xgb2<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">1</span> <span class="token keyword">if</span> x<span class="token operator">>=</span><span class="token number">0.5</span> <span class="token keyword">else</span> <span class="token number">0</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> result_xgb2<span class="token punctuation">]</span> res <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>test<span class="token punctuation">[</span><span class="token string">'sid'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>res<span class="token punctuation">[</span><span class="token string">'label'</span><span class="token punctuation">]</span> <span class="token operator">=</span> result_xgb2res<span class="token punctuation">.</span>to_csv<span class="token punctuation">(</span><span class="token string">'./baselineV4.csv'</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'已完成'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="BaseLine-V5-xgb–分数-89-0787"><a href="#BaseLine-V5-xgb–分数-89-0787" class="headerlink" title="BaseLine V5_xgb–分数: 89.0787"></a>BaseLine V5_xgb–分数: 89.0787</h2><h3 id="一、特征工程优化-2"><a href="#一、特征工程优化-2" class="headerlink" title="一、特征工程优化"></a>一、特征工程优化</h3><p>​通过特征比，寻找关键特征，构造新特征，新特征字段 &#x3D; 原始特征字段 + 1</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#通过特征比，寻找关键特征，构造新特征，新特征字段 = 原始特征字段 + 1</span><span class="token keyword">def</span> <span class="token function">find_key_feature</span><span class="token punctuation">(</span>train<span class="token punctuation">,</span> selected<span class="token punctuation">)</span><span class="token punctuation">:</span>    temp <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>columns <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    temp0 <span class="token operator">=</span> train<span class="token punctuation">[</span>train<span class="token punctuation">[</span><span class="token string">'label'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">]</span>    temp1 <span class="token operator">=</span> train<span class="token punctuation">[</span>train<span class="token punctuation">[</span><span class="token string">'label'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">]</span>    temp<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> temp0<span class="token punctuation">[</span>selected<span class="token punctuation">]</span><span class="token punctuation">.</span>value_counts<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token builtin">len</span><span class="token punctuation">(</span>temp0<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100</span>    temp<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> temp1<span class="token punctuation">[</span>selected<span class="token punctuation">]</span><span class="token punctuation">.</span>value_counts<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token builtin">len</span><span class="token punctuation">(</span>temp1<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100</span>    temp<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> temp<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">/</span> temp<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>    <span class="token comment">#选出大于10倍的特征</span>    result <span class="token operator">=</span> temp<span class="token punctuation">[</span>temp<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">></span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> ascending <span class="token operator">=</span> <span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">.</span>index    <span class="token keyword">return</span> resultselected_cols <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'osv'</span><span class="token punctuation">,</span><span class="token string">'apptype'</span><span class="token punctuation">,</span> <span class="token string">'carrier'</span><span class="token punctuation">,</span> <span class="token string">'dev_height'</span><span class="token punctuation">,</span> <span class="token string">'dev_ppi'</span><span class="token punctuation">,</span><span class="token string">'dev_width'</span><span class="token punctuation">,</span> <span class="token string">'media_id'</span><span class="token punctuation">,</span>                  <span class="token string">'package'</span><span class="token punctuation">,</span> <span class="token string">'version'</span><span class="token punctuation">,</span> <span class="token string">'fea_hash'</span><span class="token punctuation">,</span> <span class="token string">'location'</span><span class="token punctuation">,</span> <span class="token string">'fea1_hash'</span><span class="token punctuation">,</span><span class="token string">'cus_type'</span><span class="token punctuation">]</span>key_feature <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token keyword">for</span> selected <span class="token keyword">in</span> selected_cols<span class="token punctuation">:</span>    key_feature<span class="token punctuation">[</span>selected<span class="token punctuation">]</span> <span class="token operator">=</span> find_key_feature<span class="token punctuation">(</span>train<span class="token punctuation">,</span> selected<span class="token punctuation">)</span>key_feature<span class="token keyword">def</span> <span class="token function">f</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> selected<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> x <span class="token keyword">in</span> key_feature<span class="token punctuation">[</span>selected<span class="token punctuation">]</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token number">1</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token number">0</span><span class="token keyword">for</span> selected <span class="token keyword">in</span> selected_cols<span class="token punctuation">:</span>    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>key_feature<span class="token punctuation">[</span>selected<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">:</span>        features<span class="token punctuation">[</span>selected<span class="token operator">+</span><span class="token string">'1'</span><span class="token punctuation">]</span> <span class="token operator">=</span> features<span class="token punctuation">[</span>selected<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span>f<span class="token punctuation">,</span> args <span class="token operator">=</span> <span class="token punctuation">(</span>selected<span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        test_features<span class="token punctuation">[</span>selected<span class="token operator">+</span><span class="token string">'1'</span><span class="token punctuation">]</span> <span class="token operator">=</span> test_features<span class="token punctuation">[</span>selected<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span>f<span class="token punctuation">,</span> args <span class="token operator">=</span> <span class="token punctuation">(</span>selected<span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>selected<span class="token operator">+</span><span class="token string">'1 created'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>全部代码已放代码仓库：</strong><a href="https://github.com/wxydaydayup/Baidu_MarTechChallenge">百度飞桨: 点击反欺诈预测–代码仓库</a></p>]]></content>
      
      
      <categories>
          
          <category> 机器学习 </category>
          
          <category> 数据分析 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 机器学习 </tag>
            
            <tag> 数据分析 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>数据分析实战45讲</title>
      <link href="/2022/10/24/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%AE%9E%E6%88%9845%E8%AE%B2/"/>
      <url>/2022/10/24/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%AE%9E%E6%88%9845%E8%AE%B2/</url>
      
        <content type="html"><![CDATA[<h1 id="数据分析前言"><a href="#数据分析前言" class="headerlink" title="数据分析前言"></a>数据分析前言</h1><h2 id="白话数据概念"><a href="#白话数据概念" class="headerlink" title="白话数据概念"></a>白话数据概念</h2><h3 id="一、商业智能、数据仓库、数据挖掘"><a href="#一、商业智能、数据仓库、数据挖掘" class="headerlink" title="一、商业智能、数据仓库、数据挖掘"></a>一、商业智能、数据仓库、数据挖掘</h3><p>比如你认识了两个漂亮的女孩。</p><p><strong>商业智能</strong>会告诉你要追哪个？成功概率有多大？</p><p><strong>数据仓库</strong>会说，我这里存储了这两个女孩的相关信息，你要吗？</p><p>其中每个女孩的数据都有单独的文件夹，里面有她们各自的姓名、生日、喜好和联系方式等，这些具体的信息就是<strong>数据元</strong>，加起来叫作<strong>元数据</strong>。</p><p><strong>数据挖掘</strong>会帮助你确定追哪个女孩，并且整理好数据仓库，这里就可以使用到各种算法，帮你做决策了。</p><h3 id="二、数据挖掘中的类型"><a href="#二、数据挖掘中的类型" class="headerlink" title="二、数据挖掘中的类型"></a>二、数据挖掘中的类型</h3><p>你可能会用到<strong>分类算法</strong>。御姐、萝莉、女王，她到底属于哪个分类？</p><p>如果认识的女孩太多了，多到你已经数不过来了，比如说5万人！你就可以使用<strong>聚类算法</strong>了，它帮你把这些女孩分成多个群组，比如5个组。然后再对每个群组的特性进行了解，进行决策。这样就把5万人的决策，转化成了5个组的决策。成功实现降维，大大提升了效率。</p><p>如果你想知道这个女孩的闺蜜是谁，那么<strong>关联分析算法</strong>可以告诉你。</p><h3 id="三、数据预处理中的术语"><a href="#三、数据预处理中的术语" class="headerlink" title="三、数据预处理中的术语"></a>三、数据预处理中的术语</h3><p>如果你的数据来源比较多，比如有很多朋友给你介绍女朋友，很多人都推荐了同一个，你就需要去重，这叫<strong>数据清洗</strong>；</p><p>为了方便记忆，你把不同朋友推荐的同一个女孩信息在数据库中合成一个，这叫<strong>数据集成</strong>；</p><p>有些数据渠道统计的体重的单位是公斤，有些是斤，你就需要将它们转换成同一个单位，这叫<strong>数据变换。</strong></p><p>最后你可以进行<strong>数据可视化</strong>了，它会直观地把你想要的结果呈现出来。</p><h3 id="四、数据处理中的流程"><a href="#四、数据处理中的流程" class="headerlink" title="四、数据处理中的流程"></a>四、数据处理中的流程</h3><h4 id="1、数据采集"><a href="#1、数据采集" class="headerlink" title="1、数据采集"></a>1、数据采集</h4><p>​数据源 ：开源数据源、爬虫抓取、日志采集、传感器</p><p>​工具使用：火车采集器、八爪鱼、搜集客</p><ul><li><p><a href="http://www.locoy.com/">火车采集器 </a>不仅可以做抓取工具，也可以做数据清洗、数据分析、数据挖掘和可视化等工作。数据源适用于绝大部分的网页，网页中能看到的内容都可以通过采集规则进行抓取。</p></li><li><p><a href="http://www.bazhuayu.com/">八爪鱼</a>    是知名的采集工具，它有两个版本，一个就是免费的采集模板，还有一个就是云采集（付费）。</p><p>免费的采集模板实际上就是内容采集规则，包括了电商类、生活服务类、社交媒体类和论坛类的网站都可以采集，用起来非常方便。</p><p>云采集就是当你配置好采集任务，就可以交给八爪鱼的云端进行采集。八爪鱼一共有5000台服务器，通过云端多节点并发采集，采集速度远远超过本地采集。此外还可以自动切换多个 IP，避免IP被封，影响采集。做过工程项目的同学应该能体会到，云采集这个功能太方便了，很多时候自动切换IP以及云采集才是自动化采集的关键。</p></li><li><p><a href="http://www.gooseeker.com/">集搜客</a>   这个工具的特点是完全可视化操作，无需编程。整个采集过程也是所见即所得，抓取结果信息、错误信息等都反应在软件中。相比于八爪鱼来说，集搜客没有流程的概念，用户只需要关注抓取什么数据，而流程细节完全交给集搜客来处理。但是集搜客的缺点是没有云采集功能，所有爬虫都是在用户自己电脑上跑的。</p></li></ul><h4 id="2、数据挖掘"><a href="#2、数据挖掘" class="headerlink" title="2、数据挖掘"></a>2、数据挖掘</h4><p>​找到其中的规律，来指导公司业务，数据挖掘的核心是挖掘数据的商业价值</p><ul><li>商业理解：数据挖掘不是我们的目的，我们的目的是更好地帮助业务，所以首先要从商业的角度理解项目需求，在这个基础上，再对数据挖掘的目标进行定义。 </li><li>数据理解：尝试收集部分数据，然后对数据进行探索，包括数据描述、数据质量验证等，这有助于你对收集的数据有个初步的认知。 </li><li>数据准备：开始收集数据，并对数据进行清洗、数据集成等操作，完成数据挖掘前的准备工作。 </li><li>模型建立：选择和应用各种数据挖掘模型，并进行优化，以便得到更好的分类结果。 </li><li>模型评估：对模型进行评价，并检查构建模型的每个步骤，确认模型是否实现了预定的 商业目标。 </li><li>上线发布：模型的作用是从数据中找到金矿，也就是我们所说的“知识”，获得的知识需要转化成用户可以使用的方式，数据挖掘结果如果是日常运营的一部分，那么后续的监控和维护就会变得重要。</li></ul><h4 id="3、数据可视化"><a href="#3、数据可视化" class="headerlink" title="3、数据可视化"></a>3、数据可视化</h4><p>第一种：使用 Python，在 Python 对数据进行清洗、挖掘的过程中，我们可以使用 Matplotlib、Seaborn 等第三方库进行呈现。 </p><p>第二种：直接使用第三方工具。如果你已经生成了 csv 格式文件，可以采用微图、DataV、Data GIF Maker 等第三方工具。</p><h2 id="NumPy"><a href="#NumPy" class="headerlink" title="NumPy"></a>NumPy</h2><p>​标准的 Python 中，用列表list 保存数组的数值。由于列表中的元素可以是任意 的对象，所以列表中 list 保存的是对象的指针。虽然在 Python 编程中隐去了指针的概 念，但是数组有指针，Python 的列表 list 其实就是数组。这样如果我要保存一个简单的数组 [0,1,2]，就需要有 3 个指针和 3 个整数的对象，这样对于 Python 来说是非常不经济的，浪费了内存和计算时间。</p><p>​为什么使用 NumPy 让你的 Python 科学计算更高效</p><ol><li>列表 list 的元素 在系统内存中是分散存储的，而 NumPy 数组存储在一个均匀连续的内存块中。这样数组计算遍历所有的元素，不像列表 list 还需要对内存地址进行查找，从而节省了计算资源。</li><li>在内存访问模式中，缓存会直接把字节块从 RAM 加载到 CPU 寄存器中。因为数据连续的存储在内存中，NumPy 直接利用现代 CPU 的矢量化指令计算，加载寄存器中的多个连续浮点数。</li><li>另外 NumPy 中的矩阵计算可以采用多线程的方式，充分利用多核 CPU 计算资源，大大提升了计算效率</li></ol><p>在 NumPy 里有两个重要的对象： ndarray解决了多维数组问题，而 ufunc则是解决对数组进行处理的函数。</p><h3 id="一、Ndarray"><a href="#一、Ndarray" class="headerlink" title="一、Ndarray"></a>一、Ndarray</h3><p>​Ndarray全称为N-dimensional array object, 实际上是多维数组的含义。在 NumPy 数组中，维数称为秩（rank），一维数组 的秩为 1，二维数组的秩为 2，以此类推。在 NumPy 中，每一个线性的数组称为一个轴 （axes），其实秩就是描述轴的数量。</p><p>​可以通过函数 shape 属性获得数组的大小，通过 dtype 获得元素的属性，</p><h4 id="1、Shape-amp-dtype"><a href="#1、Shape-amp-dtype" class="headerlink" title="1、Shape&amp;dtype"></a>1、Shape&amp;dtype</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> npa <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>b <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>b<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">10</span><span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>shape<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span>shape<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>dtype<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>运行结果：</p><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">(3,)(3, 3)int32[[ 1  2  3] [ 4 10  6] [ 7  8  9]]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="2、结构数组"><a href="#2、结构数组" class="headerlink" title="2、结构数组"></a>2、结构数组</h4><p>​如果你想统计一个班级里面学生的姓名、年龄，以及语文、英语、数学成绩该怎么办？当然你可以用数组的下标来代表不同的字段，比如下标为 0 是姓名、下标为1是年龄等，但是这样不显性，此时便可以使用Numpy中的结构数组。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">persontype <span class="token operator">=</span> np<span class="token punctuation">.</span>dtype<span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token string">'names'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">,</span> <span class="token string">'age'</span><span class="token punctuation">,</span> <span class="token string">'chinese'</span><span class="token punctuation">,</span> <span class="token string">'math'</span><span class="token punctuation">,</span> <span class="token string">'english'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'formats'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'S32'</span><span class="token punctuation">,</span><span class="token string">'i'</span><span class="token punctuation">,</span> <span class="token string">'i'</span><span class="token punctuation">,</span> <span class="token string">'i'</span><span class="token punctuation">,</span> <span class="token string">'f'</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>peoples <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token string">"ZhangFei"</span><span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">,</span><span class="token number">75</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token string">"GuanYu"</span><span class="token punctuation">,</span><span class="token number">24</span><span class="token punctuation">,</span><span class="token number">85</span><span class="token punctuation">,</span><span class="token number">96</span><span class="token punctuation">,</span><span class="token number">88.5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>          <span class="token punctuation">(</span><span class="token string">"ZhaoYun"</span><span class="token punctuation">,</span><span class="token number">28</span><span class="token punctuation">,</span><span class="token number">85</span><span class="token punctuation">,</span><span class="token number">92</span><span class="token punctuation">,</span><span class="token number">96.5</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token string">"HuangZhong"</span><span class="token punctuation">,</span><span class="token number">29</span><span class="token punctuation">,</span><span class="token number">65</span><span class="token punctuation">,</span><span class="token number">85</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>dtype<span class="token operator">=</span>persontype<span class="token punctuation">)</span>ages <span class="token operator">=</span> peoples<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'age'</span><span class="token punctuation">]</span><span class="token keyword">print</span><span class="token punctuation">(</span>ages<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>ages<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>运行结果：</p><pre class="line-numbers language-none"><code class="language-none">[32 24 28 29]28.25<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="二、Ufunc"><a href="#二、Ufunc" class="headerlink" title="二、Ufunc"></a>二、Ufunc</h3><h4 id="1、加、减、乘、除、指数、取余"><a href="#1、加、减、乘、除、指数、取余" class="headerlink" title="1、加、减、乘、除、指数、取余"></a>1、加、减、乘、除、指数、取余</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#arange 通过指定初始值、终值、步长来创建等差数列的一维数组，默认不包括终值</span>x1 <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token comment">#linspace 通过指定初始值、终值、元素个数来创建等差数列的一维数组，默认是包括终值的</span>x2 <span class="token operator">=</span> np<span class="token punctuation">.</span>linspace<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>x1<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>x2<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>add<span class="token punctuation">(</span>x1<span class="token punctuation">,</span> x2<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">#加</span><span class="token keyword">print</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>subtract<span class="token punctuation">(</span>x1<span class="token punctuation">,</span> x2<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">#减</span><span class="token keyword">print</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>multiply<span class="token punctuation">(</span>x1<span class="token punctuation">,</span> x2<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment">#乘</span><span class="token keyword">print</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>divide<span class="token punctuation">(</span>x1<span class="token punctuation">,</span> x2<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">#除</span><span class="token keyword">print</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>power<span class="token punctuation">(</span>x1<span class="token punctuation">,</span> x2<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">#指数</span><span class="token keyword">print</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>mod<span class="token punctuation">(</span>x1<span class="token punctuation">,</span> x2<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">#取余</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>运行结果：</p><pre class="line-numbers language-none"><code class="language-none">[1 3 5 7 9][1. 3. 5. 7. 9.][ 2.  6. 10. 14. 18.][0. 0. 0. 0. 0.][ 1.  9. 25. 49. 81.][1. 1. 1. 1. 1.][1.00000000e+00 2.70000000e+01 3.12500000e+03 8.23543000e+05 3.87420489e+08][0. 0. 0. 0. 0.]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="2、最大值、最小值"><a href="#2、最大值、最小值" class="headerlink" title="2、最大值、最小值"></a>2、最大值、最小值</h4><p>amin() 用于计算数组中的元素沿指定轴的最小值, amax()同理。</p><p>amin(a,0) 是延着 axis&#x3D;0 轴的最小值，axis&#x3D;0 轴是把元素看成了 [1,4,7], [2,5,8], [3,6,9] 三个元素。</p><p>amin(a,1) 是延着 axis&#x3D;1 轴的最小值，axis&#x3D;1 轴是把元素看成了 [1,2,3], [4,5,6], [7,8,9] 三个元素。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">a <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>amin<span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>amin<span class="token punctuation">(</span>a<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>amin<span class="token punctuation">(</span>a<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>运行结果：</p><pre class="line-numbers language-none"><code class="language-none">1[1 2 3][1 4 7]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h4 id="3、最大值与最小值之差"><a href="#3、最大值与最小值之差" class="headerlink" title="3、最大值与最小值之差"></a>3、最大值与最小值之差</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python">a <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>ptp<span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>ptp<span class="token punctuation">(</span>a<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>ptp<span class="token punctuation">(</span>a<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>运行结果：</p><pre class="line-numbers language-none"><code class="language-none">a &#x3D; np.array([[1,2,3], [4,5,6], [7,8,9]])print(np.ptp(a))print(np.ptp(a,0))print(np.ptp(a,1))<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h4 id="4、统计数组的百分位数-amp-中位数"><a href="#4、统计数组的百分位数-amp-中位数" class="headerlink" title="4、统计数组的百分位数&amp;中位数"></a>4、统计数组的百分位数&amp;中位数</h4><p>percentile() 代表着第 p 个百分位数，这里 p 的取值范围是 0-100，如果 p&#x3D;0， 那么就是求最小值，如果 p&#x3D;50 就是求平均值，如果 p&#x3D;100 就是求最大值。同样你也可 以求得在 axis&#x3D;0 和 axis&#x3D;1 两个轴上的 p% 的百分位数。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">a <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>percentile<span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>percentile<span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>percentile<span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># 求中位数</span><span class="token keyword">print</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>median<span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>median<span class="token punctuation">(</span>a<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>median<span class="token punctuation">(</span>a<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>运行结果：</p><pre class="line-numbers language-none"><code class="language-none">5.0[4. 5. 6.][2. 5. 8.]# 求中位数5.0[4. 5. 6.][2. 5. 8.]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="5、统计数组中的加权平均值"><a href="#5、统计数组中的加权平均值" class="headerlink" title="5、统计数组中的加权平均值"></a>5、统计数组中的加权平均值</h4><p>average() 函数可以求加权平均，加权平均的意思就是每个元素可以设置个权重，默认情况下每个元素的权重是相同的，所以 np.average(a)&#x3D;(1+2+3+4)&#x2F;4&#x3D;2.5，你也可以指定 权重数组 wts&#x3D;[1,2,3,4]，这样加权平均 np.average(a,weights&#x3D;wts)&#x3D; (1<em>1+2</em>2+3<em>3+4</em>4)&#x2F;(1+2+3+4)&#x3D;3.0。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">a <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span>wts <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>average<span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>average<span class="token punctuation">(</span>a<span class="token punctuation">,</span>weights<span class="token operator">=</span>wts<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>运行结果：</p><pre class="line-numbers language-none"><code class="language-none">2.53.0<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h4 id="6、统计数组中的标准差、方差"><a href="#6、统计数组中的标准差、方差" class="headerlink" title="6、统计数组中的标准差、方差"></a>6、统计数组中的标准差、方差</h4><p>方差的计算是指每个数值与平均值之差的平方求和的平均值，即 mean((x - x.mean())** 2)。标准差是方差的算术平方根。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">a <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>std<span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">#标准差</span><span class="token keyword">print</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>var<span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">#方差</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>运行结果：</p><pre class="line-numbers language-none"><code class="language-none">1.1180339887498951.25<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h4 id="7、排序"><a href="#7、排序" class="headerlink" title="7、排序"></a>7、排序</h4><p>sort(a, axis&#x3D;-1, kind&#x3D;‘quicksort’, order&#x3D;None)；</p><ul><li><p>kind 字段：默认情况下使 用的是快速排序，可以指定 quicksort、mergesort、heapsort 分别表示快速排序、合并排序、堆排序。</p></li><li><p>axis 字段：默认是 -1，即沿着数组的最后一个轴进行排序， 也可以取不同的 axis 轴，或者 axis&#x3D;None 代表采用扁平化的方式作为一个向量进行排序。</p></li><li><p>order 字段：对于结构化的数组可以指定按照某个字段进行排序。</p></li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python">a <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>sort<span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>sort<span class="token punctuation">(</span>a<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>sort<span class="token punctuation">(</span>a<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>sort<span class="token punctuation">(</span>a<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>运行结果：</p><pre class="line-numbers language-none"><code class="language-none">[[2 3 4][1 2 4]][1 2 2 3 4 4][[2 3 1][4 4 2]][[2 3 4][1 2 4]]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h2 id="Pandas"><a href="#Pandas" class="headerlink" title="Pandas"></a>Pandas</h2><p>在数据分析工作中，Pandas 的使用频率是很高的，一方面是因为 Pandas 提供的基础数据结构DataFrame 与 json 的契合度很高，转换起来就很方便。另一方面，如果我们数据清理工作不是很复杂的话，通常用几句 Pandas 代码就可以对数据进行规整。</p><p>Series 和 DataFrame 这两个核心数据结构，他们分别代表着一维的序列和二维的表结构。基于这两种数据结构，Pandas 可以对数据进行导入、清洗、处理、 统计和输出。</p><h3 id="一、Series"><a href="#一、Series" class="headerlink" title="一、Series"></a>一、Series</h3><p>Series 是个定长的字典序列。说是定长是因为在存储的时候，相当于两个 ndarray，这也是和字典结构最大的不同。因为在字典的结构里，元素的个数是不固定的。 </p><p>Series有两个基本属性：index 和 values。在 Series 结构中，index 默认是 0,1,2,……递增的整数序列，当然我们也可以自己来指定索引，比如 index&#x3D;[‘a’, ‘b’, ‘c’, ‘d’]。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd<span class="token keyword">from</span> pandas <span class="token keyword">import</span> Series<span class="token punctuation">,</span> DataFramex1 <span class="token operator">=</span> Series<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span>x2 <span class="token operator">=</span> Series<span class="token punctuation">(</span>data<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">,</span> <span class="token string">'d'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>x1<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>x2<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>运行结果：</p><pre class="line-numbers language-none"><code class="language-none">0    11    22    33    4dtype: int64a    1b    2c    3d    4dtype: int64<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>我们也可以采用字典的方式来创建 Series</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">d <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">'a'</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">'d'</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">&#125;</span>x3 <span class="token operator">=</span> Series<span class="token punctuation">(</span>d<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>x3<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>运行结果：</p><pre class="line-numbers language-none"><code class="language-none">a    1b    2c    3d    4dtype: int64<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="二、DataFrame"><a href="#二、DataFrame" class="headerlink" title="二、DataFrame"></a>二、DataFrame</h3><p><strong>DataFrame 类型数据结构类似数据库表。</strong> </p><p>它包括了行索引和列索引，我们可以将 DataFrame 看成是由相同索引的 Series 组成的字 典类型。</p><p>一般会用 df, df1, df2 这些作为 DataFrame 数据类型的变量名，以例子中的 df2 为例，列索引是 [‘English’, ‘Math’, ‘Chinese’]，行索引是 [‘ZhangFei’, ‘GuanYu’, ‘ZhaoYun’, ‘HuangZhong’, ‘DianWei’]。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">data <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">'Chinese'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">66</span><span class="token punctuation">,</span> <span class="token number">95</span><span class="token punctuation">,</span> <span class="token number">93</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">,</span><span class="token number">80</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">'English'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">65</span><span class="token punctuation">,</span> <span class="token number">85</span><span class="token punctuation">,</span> <span class="token number">92</span><span class="token punctuation">,</span> <span class="token number">88</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">'Math'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">98</span><span class="token punctuation">,</span> <span class="token number">96</span><span class="token punctuation">,</span> <span class="token number">77</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span>df1<span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>data<span class="token punctuation">)</span>df2 <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>data<span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'ZhangFei'</span><span class="token punctuation">,</span> <span class="token string">'GuanYu'</span><span class="token punctuation">,</span> <span class="token string">'ZhaoYun'</span><span class="token punctuation">,</span> <span class="token string">'HuangZhong'</span><span class="token punctuation">,</span> <span class="token string">'DianWei'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'English'</span><span class="token punctuation">,</span> <span class="token string">'Math'</span><span class="token punctuation">,</span> <span class="token string">'Chinese'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>df1<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>df2<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>运行结果：</p><pre class="line-numbers language-none"><code class="language-none"> Chinese  English  Math0       66       65    301       95       85    982       93       92    963       90       88    774       80       90    90            English  Math  ChineseZhangFei         65    30       66GuanYu           85    98       95ZhaoYun          92    96       93HuangZhong       88    77       90DianWei          90    90       80<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="三、用DataFranme进行数据处理"><a href="#三、用DataFranme进行数据处理" class="headerlink" title="三、用DataFranme进行数据处理"></a>三、用DataFranme进行数据处理</h3><h4 id="1、数据导入和输出"><a href="#1、数据导入和输出" class="headerlink" title="1、数据导入和输出"></a>1、数据导入和输出</h4><p>需要先下载依赖</p><pre class="line-numbers language-none"><code class="language-none">pip installxlrdpip installopenpyxl<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>将data.xlsx放在Jupyter目录下,默认为 C:\Users\${用户名}</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">score <span class="token operator">=</span> DataFrame<span class="token punctuation">(</span>pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span><span class="token string">'data.xlsx'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>score<span class="token punctuation">.</span>to_excel<span class="token punctuation">(</span><span class="token string">'data1.xlsx'</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h4 id="2、数据清洗"><a href="#2、数据清洗" class="headerlink" title="2、数据清洗"></a>2、数据清洗</h4><p>以上文df2为例</p><p><strong>删除 DataFrame 中的不必要的列或行</strong></p><pre class="line-numbers language-python" data-language="python"><code class="language-python">df2 <span class="token operator">=</span> df2<span class="token punctuation">.</span>drop<span class="token punctuation">(</span>columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Chinese'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>df2 <span class="token operator">=</span> df2<span class="token punctuation">.</span>drop<span class="token punctuation">(</span>index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'ZhangFei'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><strong>重命名列名 columns，让列表名更容易识别</strong></p><pre class="line-numbers language-python" data-language="python"><code class="language-python">df2<span class="token punctuation">.</span>rename<span class="token punctuation">(</span>columns<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">'Chinese'</span><span class="token punctuation">:</span> <span class="token string">'YuWen'</span><span class="token punctuation">,</span> <span class="token string">'English'</span><span class="token punctuation">:</span> <span class="token string">'Yingyu'</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> inplace <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>去除重复的值</strong></p><p>不是字段名相同就去除，而是这个字段里面的数组一样才去除</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">df <span class="token operator">=</span> df2<span class="token punctuation">.</span>drop_duplicates<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#去除重复行</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>更改数据格式</strong></p><p>把 Chinese 字段的值改成 str 类型，或者 int64 可以这么写</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">df2<span class="token punctuation">[</span><span class="token string">'Chinese'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token string">'str'</span><span class="token punctuation">)</span>df2<span class="token punctuation">[</span><span class="token string">'Chinese'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span>np<span class="token punctuation">.</span>int64<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><strong>数据间的空格</strong></p><p>有时候我们先把格式转成了 str 类型，是为了方便对数据进行操作，这时想要删除数据间的空格或字符，我们就可以使用 strip 函数</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 删除左右两边空格</span>df2<span class="token punctuation">[</span><span class="token string">'Chinese'</span><span class="token punctuation">]</span><span class="token operator">=</span>df2<span class="token punctuation">[</span><span class="token string">'Chinese'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">.</span>strip<span class="token punctuation">)</span><span class="token comment"># 删除左边空格</span>df2<span class="token punctuation">[</span><span class="token string">'Chinese'</span><span class="token punctuation">]</span><span class="token operator">=</span>df2<span class="token punctuation">[</span><span class="token string">'Chinese'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">.</span>lstrip<span class="token punctuation">)</span><span class="token comment"># 删除右边空格</span>df2<span class="token punctuation">[</span><span class="token string">'Chinese'</span><span class="token punctuation">]</span><span class="token operator">=</span>df2<span class="token punctuation">[</span><span class="token string">'Chinese'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">.</span>rstrip<span class="token punctuation">)</span><span class="token comment"># 删除其中的$符号</span>df2<span class="token punctuation">[</span><span class="token string">'Chinese'</span><span class="token punctuation">]</span><span class="token operator">=</span>df2<span class="token punctuation">[</span><span class="token string">'Chinese'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">str</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token string">'$'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>大小写转换</strong></p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#全部大写</span>df2<span class="token punctuation">.</span>columns <span class="token operator">=</span> df2<span class="token punctuation">.</span>columns<span class="token punctuation">.</span><span class="token builtin">str</span><span class="token punctuation">.</span>upper<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#全部小写</span>df2<span class="token punctuation">.</span>columns <span class="token operator">=</span> df2<span class="token punctuation">.</span>columns<span class="token punctuation">.</span><span class="token builtin">str</span><span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#首字母大写</span>df2<span class="token punctuation">.</span>columns <span class="token operator">=</span> df2<span class="token punctuation">.</span>columns<span class="token punctuation">.</span><span class="token builtin">str</span><span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>查找空值</strong></p><img src="/images/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%AE%9E%E6%88%9845%E8%AE%B2/image-20221025092409470.png" alt="表结构" style="zoom:50%;" /><p>针对数据表df使用df.isnull()</p><img src="/images/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%AE%9E%E6%88%9845%E8%AE%B2/image-20221025092428614.png"  style="zoom:50%;" /><p>针对某列使用df.isnull().any()</p><img src="/images/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%AE%9E%E6%88%9845%E8%AE%B2/image-20221025092518068.png"  style="zoom:67%;" /><p><strong>使用 apply 函数对数据进行清洗</strong></p><p>​apply 函数是 Pandas 中自由度非常高的函数，使用频率也非常高。</p><p>​我们也可以定义个函数，在 apply中进行使用。比如定义 double_df 函数是将原来的数值 *2 进行返回。然后对 df1 中的“语文”列的数值进行 *2 处理，可以写成：</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">double_df</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token keyword">return</span> <span class="token number">2</span><span class="token operator">*</span>xdf1<span class="token punctuation">[</span><span class="token string">u'语文'</span><span class="token punctuation">]</span> <span class="token operator">=</span> df1<span class="token punctuation">[</span><span class="token string">u'语文'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span>double_df<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h4 id="3、数据统计"><a href="#3、数据统计" class="headerlink" title="3、数据统计"></a>3、数据统计</h4><p><strong>统计函数</strong></p><p>​describe() 函数最简便。它是个统计大礼包，可以快速让我们对数据有个全面的了解。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">df1 <span class="token operator">=</span> DataFrame<span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token string">'name'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'ZhangFei'</span><span class="token punctuation">,</span> <span class="token string">'GuanYu'</span><span class="token punctuation">,</span> <span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'data1'</span><span class="token punctuation">:</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>df1<span class="token punctuation">.</span>describe<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>运行结果：</p><pre class="line-numbers language-none"><code class="language-none">          data1count  5.000000mean   2.000000std    1.581139min    0.00000025%    1.00000050%    2.00000075%    3.000000max    4.000000<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>数据表合并</strong></p><p>​基于指定列进行连接</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">df3 <span class="token operator">=</span> pd<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>df1<span class="token punctuation">,</span> df2<span class="token punctuation">,</span> on<span class="token operator">=</span><span class="token string">'name'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/images/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%AE%9E%E6%88%9845%E8%AE%B2/image-20221025093942797.png" alt="指定字段连接"  style="zoom: 50%;" /><p>​inner 内连接</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">df3 <span class="token operator">=</span> pd<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>df1<span class="token punctuation">,</span> df2<span class="token punctuation">,</span> how<span class="token operator">=</span><span class="token string">'inner'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>​<img src="/images/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%AE%9E%E6%88%9845%E8%AE%B2/image-20221025094218284.png" alt="两表的交集" style="zoom:50%;" /></p><p>left 左连接</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">df3 <span class="token operator">=</span> pd<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>df1<span class="token punctuation">,</span> df2<span class="token punctuation">,</span> how<span class="token operator">=</span><span class="token string">'left'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/images/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%AE%9E%E6%88%9845%E8%AE%B2/image-20221025094330227.png" alt="左表为主,右表补充" style="zoom:50%;" /><p>right 右连接</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">df3 <span class="token operator">=</span> pd<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>df1<span class="token punctuation">,</span> df2<span class="token punctuation">,</span> how<span class="token operator">=</span><span class="token string">'right'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/images/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%AE%9E%E6%88%9845%E8%AE%B2/image-20221025094517630.png" alt="右表为主,左表补充" style="zoom:50%;" /><p>outer 外连接</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">df3 <span class="token operator">=</span> pd<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>df1<span class="token punctuation">,</span> df2<span class="token punctuation">,</span> how<span class="token operator">=</span><span class="token string">'outer'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/images/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%AE%9E%E6%88%9845%E8%AE%B2/image-20221025094558773.png" alt="两表的并集" style="zoom:50%;" /><p><strong>用 SQL 方式打开 Pandas</strong></p><p>pandasql 中的主要函数是 sqldf，它接收两个参数：一个 SQL 查询语句，还有一组环境 变量 globals() 或 locals()。这样我们就可以在 Python 里，直接用 SQL 语句中对 DataFrame 进行操作</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd<span class="token keyword">from</span> pandas <span class="token keyword">import</span> DataFrame<span class="token keyword">from</span> pandasql <span class="token keyword">import</span> sqldf<span class="token punctuation">,</span> load_meat<span class="token punctuation">,</span> load_birthsdf1 <span class="token operator">=</span> DataFrame<span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token string">'name'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'ZhangFei'</span><span class="token punctuation">,</span> <span class="token string">'GuanYu'</span><span class="token punctuation">,</span> <span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'data1'</span><span class="token punctuation">:</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>pysqldf <span class="token operator">=</span> <span class="token keyword">lambda</span> sql<span class="token punctuation">:</span> sqldf<span class="token punctuation">(</span>sql<span class="token punctuation">,</span> <span class="token builtin">globals</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>sql <span class="token operator">=</span> <span class="token string">"select * from df1 where name ='ZhangFei'"</span><span class="token keyword">print</span> pysqldf<span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p> lambda函数是用来定义一个匿名函数的，具体的使用形式为：</p><pre class="line-numbers language-none"><code class="language-none">lambda argument_list: expression<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>这里 argument_list 是参数列表，expression 是关于参数的表达式，会根据 expression 表达式计算结果进行输出返回。 在上面的代码中，我们定义了：</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">pysqldf <span class="token operator">=</span> <span class="token keyword">lambda</span> sql<span class="token punctuation">:</span> sqldf<span class="token punctuation">(</span>sql<span class="token punctuation">,</span> <span class="token builtin">globals</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>在这个例子里，输入的参数是 sql，返回的结果是 sqldf 对 sql 的运行结果，当然 sqldf 中也输入了 globals 全局参数，因为在 sql 中有对全局参数 df1 的使用。</p><h1 id="数据预处理与算法"><a href="#数据预处理与算法" class="headerlink" title="数据预处理与算法"></a>数据预处理与算法</h1><h2 id="用户画像建模"><a href="#用户画像建模" class="headerlink" title="用户画像建模"></a>用户画像建模</h2><h3 id="一、设计唯一标识"><a href="#一、设计唯一标识" class="headerlink" title="一、设计唯一标识"></a>一、设计唯一标识</h3><p>​<strong>用户唯一标识是整个用户画像的核心</strong>。我们以一个App为例，它把“从用户开始使用APP到下单到售后整个所有的用户行为”进行串联，这样就可以更好地去跟踪和分析一个用户的特征。设计唯一标识可以从这些项中选择：用户名、注册手机号、联系人手机号、邮箱、设备号、CookieID等。</p><h3 id="二、用户标签化"><a href="#二、用户标签化" class="headerlink" title="二、用户标签化"></a>二、用户标签化</h3><ul><li>用户标签：它包括了性别、年龄、地域、收入、学历、职业等。这些包括了用户的基础属性。</li><li>消费标签：消费习惯、购买意向、是否对促销敏感。这些统计分析用户的消费习惯。</li><li>行为标签：时间段、频次、时长、访问路径。这些是通过分析用户行为，来得到他们使用App的习惯。</li><li>内容分析：对用户平时浏览的内容，尤其是停留时间长、浏览次数多的内容进行分析，分析出用户对哪些内容感兴趣，比如，金融、娱乐、教育、体育、时尚、科技等。</li></ul><h3 id="三、赋能业务价值"><a href="#三、赋能业务价值" class="headerlink" title="三、赋能业务价值"></a>三、赋能业务价值</h3><ul><li>获客：如何进行拉新，通过更精准的营销获取客户。</li><li>粘客：个性化推荐，搜索排序，场景运营等。</li><li>留客：流失率预测，分析关键节点降低流失率。</li></ul><h3 id="四、以美团为例"><a href="#四、以美团为例" class="headerlink" title="四、以美团为例"></a>四、以美团为例</h3><h4 id="1、以美团为例设计唯一标识"><a href="#1、以美团为例设计唯一标识" class="headerlink" title="1、以美团为例设计唯一标识"></a>1、以美团为例设计唯一标识</h4><ul><li>手机号是唯一标识</li></ul><h4 id="2、以美团为例用户标签化"><a href="#2、以美团为例用户标签化" class="headerlink" title="2、以美团为例用户标签化"></a>2、以美团为例用户标签化</h4><ul><li>用户标签：性别、年龄、家乡、居住地、收货地址、婚姻、宝宝信息、通过何种渠道进行的注册。</li><li>消费标签：餐饮口味、消费均价、团购等级、预定使用等级、排队使用等级、外卖等级。</li><li>行为标签：点外卖时间段、使用频次、平均点餐用时、访问路径。</li><li>内容分析：基于用户平时浏览的内容进行统计，包括餐饮口味、优惠敏感度等。</li></ul><h4 id="3、以美团为例赋能业务价值"><a href="#3、以美团为例赋能业务价值" class="headerlink" title="3、以美团为例赋能业务价值"></a>3、以美团为例赋能业务价值</h4><ul><li>在获客上，我们可以找到优势的宣传渠道，如何通过个性化的宣传手段，吸引有潜在需求的用户，并刺激其转化。</li><li>在粘客上，如何提升用户的单价和消费频次，方法可以包括购买后的个性化推荐、针对优质用户进行优质高价商品的推荐、以及重复购买，比如通过红包、优惠等方式激励对优惠敏感的人群，提升购买频次。</li><li>留客上，预测用户是否可能会从平台上流失。在营销领域，关于用户留存有一个观点——如果将顾客流失率降低5%，公司利润将提升25%~85%。可以看出留存率是多么的重要。用户流失可能会包括多种情况，比如用户体验、竞争对手、需求变化等，通过预测用户的流失率可以大幅降低用户留存的运营成本。</li></ul><h2 id="数据预处理"><a href="#数据预处理" class="headerlink" title="数据预处理"></a>数据预处理</h2><h3 id="一、数据清洗"><a href="#一、数据清洗" class="headerlink" title="一、数据清洗"></a>一、数据清洗</h3><p>我将数据清洗规则总结为以下4个关键点，统一起来叫“<strong>完全合一</strong>”。</p><ol><li><strong>完</strong>整性：单条数据是否存在空值，统计的字段是否完善。</li><li><strong>全</strong>面性：观察某一列的全部数值，比如在Excel表中，我们选中一列，可以看到该列的平均值、最大值、最小值。我们可以通过常识来判断该列是否有问题，比如：数据定义、单位标识、数值本身。</li><li><strong>合</strong>法性：数据的类型、内容、大小的合法性。比如数据中存在非ASCII字符，性别存在了未知，年龄超过了150岁等。</li><li>唯<strong>一</strong>性：数据是否存在重复记录，因为数据通常来自不同渠道的汇总，重复的情况是常见的。行数据、列数据都需要是唯一的，比如一个人不能重复记录多次，且一个人的体重也不能在列指标中重复记录多次。</li></ol><p>按照以上的原则，我们对以下图片进行数据清洗</p><p>​这是一家服装店统计的会员数据。最上面的一行是列坐标，最左侧一列是行坐标。</p><p>​列坐标中，第0列代表的是序号，第1列代表的会员的姓名，第2列代表年龄，第3列代表体重，第4-6列代表男性会员的三围尺寸，第7-9列代表女性会员的三围尺寸。</p><img src="/images/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%AE%9E%E6%88%9845%E8%AE%B2/image-20221028195420586.png" alt="需要数据清洗" style="zoom:80%;" /><p>下面，我们就依照“完全合一”的准则，使用Pandas来进行清洗。</p><h4 id="1、完整性"><a href="#1、完整性" class="headerlink" title="1、完整性"></a>1、完整性</h4><p><strong>问题1：缺失值</strong></p><p>在数据中有些年龄、体重数值是缺失的，这往往是因为数据量较大，在过程中，有些数值没有采集到。通常我们可以采用以下三种方法：</p><ul><li>删除：删除数据缺失的记录；</li><li>均值：使用当前列的均值；</li><li>高频：使用当前列出现频率最高的数据。</li></ul><p>比如我们想对df[‘Age’]中缺失的数值用平均年龄进行填充，可以这样写：</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">df<span class="token punctuation">[</span><span class="token string">'Age'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>fillna<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">'Age'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>如果我们用最高频的数据进行填充，可以先通过value_counts获取Age字段最高频次age_maxf，然后再对Age字段中缺失的数据用age_maxf进行填充：</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">age_maxf <span class="token operator">=</span> train_features<span class="token punctuation">[</span><span class="token string">'Age'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value_counts<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>index<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> train_features<span class="token punctuation">[</span><span class="token string">'Age'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>fillna<span class="token punctuation">(</span>age_maxf<span class="token punctuation">,</span> inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>问题2：空行</strong></p><p>我们发现数据中有一个空行，除了 index 之外，全部的值都是 NaN。Pandas 的 read_csv() 并没有可选参数来忽略空行，这样，我们就需要在数据被读入之后再使用 dropna() 进行处理，删除空行。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">df<span class="token punctuation">.</span>dropna<span class="token punctuation">(</span>how<span class="token operator">=</span><span class="token string">'all'</span><span class="token punctuation">,</span>inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span> <span class="token comment"># 删除全空的行</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="2、全面性"><a href="#2、全面性" class="headerlink" title="2、全面性"></a>2、全面性</h4><p><strong>问题：列数据的单位不统一</strong></p><p>观察weight列的数值，我们能发现weight 列的单位不统一。有的单位是千克（kgs），有的单位是磅（lbs）。</p><p>这里我使用千克作为统一的度量单位，将磅（lbs）转化为千克（kgs）：</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 获取 weight 数据列中单位为 lbs 的数据</span>rows_with_lbs <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">'weight'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">str</span><span class="token punctuation">.</span>contains<span class="token punctuation">(</span><span class="token string">'lbs'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>fillna<span class="token punctuation">(</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token keyword">print</span> df<span class="token punctuation">[</span>rows_with_lbs<span class="token punctuation">]</span><span class="token comment"># 将 lbs转换为 kgs, 2.2lbs=1kgs</span><span class="token keyword">for</span> i<span class="token punctuation">,</span>lbs_row <span class="token keyword">in</span> df<span class="token punctuation">[</span>rows_with_lbs<span class="token punctuation">]</span><span class="token punctuation">.</span>iterrows<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment"># 截取从头开始到倒数第三个字符之前，即去掉lbs。</span>weight <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">float</span><span class="token punctuation">(</span>lbs_row<span class="token punctuation">[</span><span class="token string">'weight'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2.2</span><span class="token punctuation">)</span>df<span class="token punctuation">.</span>at<span class="token punctuation">[</span>i<span class="token punctuation">,</span><span class="token string">'weight'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'&#123;&#125;kgs'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>weight<span class="token punctuation">)</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="3、合理性"><a href="#3、合理性" class="headerlink" title="3、合理性"></a>3、合理性</h4><p><strong>问题：非ASCII字符</strong></p><p>我们可以看到在数据集中 Fristname 和 Lastname （在唯一性中将名字拆分为包含了两个字段Firtname 和 Lastname）有一些非 ASCII 的字符。我们可以采用删除或者替换的方式来解决非ASCII问题，这里我们使用删除方法：</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">df<span class="token punctuation">[</span><span class="token string">'first_name'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token string">r'[^\x00-\x7F]+'</span><span class="token punctuation">:</span><span class="token string">''</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> regex<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span> <span class="token comment"># 删除非 ASCII 字符</span>df<span class="token punctuation">[</span><span class="token string">'last_name'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token string">r'[^\x00-\x7F]+'</span><span class="token punctuation">:</span><span class="token string">''</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> regex<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h4 id="4、唯一性"><a href="#4、唯一性" class="headerlink" title="4、唯一性"></a>4、唯一性</h4><p><strong>问题1：一列有多个参数</strong></p><p>在数据中不难发现，姓名列（Name）包含了两个参数 Firtname 和 Lastname。为了达到数据整洁目的，我们将 Name 列拆分成 Firstname 和 Lastname两个字段。我们使用Python的split方法，str.split(expand&#x3D;True)，将列表拆成新的列，再将原来的 Name 列删除。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">df<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'first_name'</span><span class="token punctuation">,</span><span class="token string">'last_name'</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">str</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span>expand<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span> <span class="token comment"># 切分名字，删除源数据列</span>df<span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><strong>问题2：重复数据</strong></p><p>我们校验一下数据中是否存在重复记录。如果存在重复记录，就使用 Pandas 提供的 drop_duplicates() 来删除重复数据。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">df<span class="token punctuation">.</span>drop_duplicates<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'first_name'</span><span class="token punctuation">,</span><span class="token string">'last_name'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span> <span class="token comment"># 删除重复数据行</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>最终效果图：</p><img src="/images/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%AE%9E%E6%88%9845%E8%AE%B2/image-20221028200303888.png" alt="数据清洗效果图" style="zoom: 50%;" /><h3 id="二、数据集成"><a href="#二、数据集成" class="headerlink" title="二、数据集成"></a>二、数据集成</h3><h4 id="1、数据集成的两种架构：ELT和ETL"><a href="#1、数据集成的两种架构：ELT和ETL" class="headerlink" title="1、数据集成的两种架构：ELT和ETL"></a>1、数据集成的两种架构：ELT和ETL</h4><p>ETL 的过程为提取(Extract)——转换(Transform)——加载(Load)，在数据源抽取后首先进行转换，然后将转换的结果写入目的地。</p><p>ELT 的过程则是提取(Extract)——加载(Load)——变换(Transform)，在抽取后将结果先写入目的地，然后利用数据库的聚合分析能力或者外部计算框架，如Spark来完成转换的步骤。</p><p>目前数据集成的主流架构是ETL，但未来使用ELT作为数据集成架构的将越来越多。这样做会带来多种好处：</p><ul><li>ELT 和 ETL 相比，最大的区别是“重抽取和加载，轻转换”，从而可以用更轻量的方案搭建起一个数据集成平台。使用 ELT 方法，在提取完成之后，数据加载会立即开始。一方面更省时，另一方面ELT允许 BI 分析人员无限制地访问整个原始数据，为分析师提供了更大的灵活性，使之能更好地支持业务。</li><li>在ELT架构中，数据变换这个过程根据后续使用的情况，需要在 SQL 中进行，而不是在加载阶段进行。这样做的好处是你可以从数据源中提取数据，经过少量预处理后进行加载。这样的架构更简单，使分析人员更好地了解原始数据的变换过程。</li></ul><h3 id="三、数据变换"><a href="#三、数据变换" class="headerlink" title="三、数据变换"></a>三、数据变换</h3><p>举个例子，假设A考了80分，B也考了80分，但前者是百分制，后者500分是满分，如果我们把从这两个渠道收集上来的数据进行集成、挖掘，就算使用效率再高的算法，结果也不是正确的。因为这两个渠道的分数代表的含义完全不同。</p><p>所以说，有时候数据变换比算法选择更重要，数据错了，算法再正确也是错的。那么如何让不同渠道的数据统一到一个目标数据库里呢？这样就用到了数据变换。</p><p>数据变换是数据准备的重要环节，它<strong>通过数据平滑、数据聚集、数据概化和规范化等方式</strong>将数据转换成适用于数据挖掘的形式。</p><h4 id="1、常见的数据变换方法"><a href="#1、常见的数据变换方法" class="headerlink" title="1、常见的数据变换方法"></a>1、常见的数据变换方法</h4><ul><li><strong>数据平滑</strong>：去除数据中的噪声，将连续数据离散化。这里可以采用分箱、聚类和回归的方式进行数据平滑；</li><li><strong>数据聚集</strong>：对数据进行汇总，在SQL中有一些聚集函数可以供我们操作，比如Max()反馈某个字段的数值最大值，Sum()返回某个字段的数值总和；</li><li><strong>数据概化</strong>：将数据由较低的概念抽象成为较高的概念，减少数据复杂度，即用更高的概念替代更低的概念。比如说上海、杭州、深圳、北京可以概化为中国。</li><li><strong>数据规范化</strong>：使属性数据按比例缩放，这样就将原来的数值映射到一个新的特定区域中。常用的方法有最小—最大规范化、Z—score 规范化、按小数定标规范化等；</li><li><strong>属性构造</strong>：构造出新的属性并添加到属性集中。这里会用到特征工程的知识，因为通过属性与属性的连接构造新的属性，其实就是特征工程。比如说，数据表中统计每个人的英语、语文和数学成绩，可以构造一个“总和”这个属性，来作为新属性。这样“总和”这个属性就可以用到后续的数据挖掘计算中。</li></ul><p>在这些变换方法中，最简单易用的就是对数据进行规范化处理，下面介绍数据进行规范化处理的几种方法，并使用Python中的SciKit-Learn进行数据规范化。</p><h4 id="2、Min-max-规范化"><a href="#2、Min-max-规范化" class="headerlink" title="2、Min-max 规范化"></a>2、Min-max 规范化</h4><p>Min-max标准化方法是将原始数据变换到[0,1]的空间中。用公式表示就是：新数值&#x3D;（原数值-极小值）&#x2F;（极大值-极小值）。</p><p>我们可以让原始数据投射到指定的空间[min, max]，在SciKit-Learn里有个函数MinMaxScaler是专门做这个的，它允许我们给定一个最大值与最小值，然后将原数据投射到[min, max]中。默认情况下[min,max]是[0,1]，也就是把原始数据投放到[0,1]范围内。</p><p>我们来看下下面这个例子：</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># coding:utf-8</span><span class="token keyword">from</span> sklearn <span class="token keyword">import</span> preprocessing<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np<span class="token comment"># 初始化数据，每一行表示一个样本，每一列表示一个特征</span>x <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">0.</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">3.</span><span class="token punctuation">,</span>  <span class="token number">1.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>              <span class="token punctuation">[</span> <span class="token number">3.</span><span class="token punctuation">,</span>  <span class="token number">1.</span><span class="token punctuation">,</span>  <span class="token number">2.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>              <span class="token punctuation">[</span> <span class="token number">0.</span><span class="token punctuation">,</span>  <span class="token number">1.</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token comment"># 将数据进行[0,1]规范化</span>min_max_scaler <span class="token operator">=</span> preprocessing<span class="token punctuation">.</span>MinMaxScaler<span class="token punctuation">(</span><span class="token punctuation">)</span>minmax_x <span class="token operator">=</span> min_max_scaler<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token keyword">print</span> minmax_x<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>运行结果：</p><pre class="line-numbers language-none"><code class="language-none">[[0.         0.         0.66666667] [1.         1.         1.        ] [0.         1.         0.        ]]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h4 id="3、Z-Score-规范化"><a href="#3、Z-Score-规范化" class="headerlink" title="3、Z-Score 规范化"></a>3、Z-Score 规范化</h4><p>我们定义：新数值&#x3D;（原数值-均值）&#x2F; 标准差。</p><p>Z-Score的优点是算法简单，不受数据量级影响，结果易于比较。不足在于，它需要数据整体的平均值和方差，而且结果没有实际意义，只是用于比较。在SciKit-Learn库中使用preprocessing.scale()函数，可以直接将给定数据进行Z-Score规范化。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> sklearn <span class="token keyword">import</span> preprocessing<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np<span class="token comment"># 初始化数据</span>x <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">0.</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">3.</span><span class="token punctuation">,</span>  <span class="token number">1.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>              <span class="token punctuation">[</span> <span class="token number">3.</span><span class="token punctuation">,</span>  <span class="token number">1.</span><span class="token punctuation">,</span>  <span class="token number">2.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>              <span class="token punctuation">[</span> <span class="token number">0.</span><span class="token punctuation">,</span>  <span class="token number">1.</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token comment"># 将数据进行Z-Score规范化</span>scaled_x <span class="token operator">=</span> preprocessing<span class="token punctuation">.</span>scale<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token keyword">print</span> scaled_x<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>运行结果：</p><pre class="line-numbers language-none"><code class="language-none">[[-0.70710678 -1.41421356  0.26726124] [ 1.41421356  0.70710678  1.06904497] [-0.70710678  0.70710678 -1.33630621]]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>这个结果实际上就是将每行每列的值减去了平均值，再除以方差的结果。</p><p>我们看到Z-Score规范化将数据集进行了规范化，数值都符合均值为0，方差为1的正态分布。</p><h4 id="4、小数定标规范化"><a href="#4、小数定标规范化" class="headerlink" title="4、小数定标规范化"></a>4、小数定标规范化</h4><p>小数定标规范化就是通过移动小数点的位置来进行规范化。小数点移动多少位取决于属性A的取值中的最大绝对值。</p><p>举个例子，比如属性A的取值范围是-999到88，那么最大绝对值为999，小数点就会移动3位，即新数值&#x3D;原数值&#x2F;1000。那么A的取值范围就被规范化为-0.999到0.088。我们需要用NumPy库来计算小数点的位数。</p><p>这里我们看下运行代码：</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># coding:utf-8</span><span class="token keyword">from</span> sklearn <span class="token keyword">import</span> preprocessing<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np<span class="token comment"># 初始化数据</span>x <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">0.</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">3.</span><span class="token punctuation">,</span>  <span class="token number">1.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>              <span class="token punctuation">[</span> <span class="token number">3.</span><span class="token punctuation">,</span>  <span class="token number">1.</span><span class="token punctuation">,</span>  <span class="token number">2.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>              <span class="token punctuation">[</span> <span class="token number">0.</span><span class="token punctuation">,</span>  <span class="token number">1.</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token comment"># 标准差标准化</span>j <span class="token operator">=</span> np<span class="token punctuation">.</span>ceil<span class="token punctuation">(</span>np<span class="token punctuation">.</span>log10<span class="token punctuation">(</span>np<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token builtin">abs</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>scaled_x <span class="token operator">=</span> x<span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token operator">**</span>j<span class="token punctuation">)</span><span class="token keyword">print</span> scaled_x<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>运行结果：</p><pre class="line-numbers language-none"><code class="language-none">[[ 0.  -0.3  0.1] [ 0.3  0.1  0.2] [ 0.   0.1 -0.1]]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>另外的专题</p><p>python爬虫</p><p>python可视化</p><p>通过决策树来进行泰坦尼克乘客生存预测</p><h2 id="算法四大分类"><a href="#算法四大分类" class="headerlink" title="算法四大分类"></a>算法四大分类</h2><h3 id="一、分类算法"><a href="#一、分类算法" class="headerlink" title="一、分类算法"></a>一、分类算法</h3><p>就是通过训练集得到一个分类模型，然后用这个模型可以对其他数据进行分类，分类需要知道事先的定义，常见分类算法：C4.5、CART、朴素贝叶斯、SVM、KNN、AdaBoost</p><h3 id="二、聚类算法"><a href="#二、聚类算法" class="headerlink" title="二、聚类算法"></a>二、聚类算法</h3><p>聚类就是将数据自动聚类成几个类别，聚到一起的相似度大，不在一起的差异性大。我们往往利用聚类来做数据划分，往往聚类不知道事先的定义，常见聚类算法：K-Means、EM</p><h3 id="三、关联分析"><a href="#三、关联分析" class="headerlink" title="三、关联分析"></a>三、关联分析</h3><p>通过当前和历史数据来预测未来趋势，它可以更好地帮助我们识别机遇和风险，比如在A出现10次同时， B出现8次，常见关联分析算法：Apriori</p><h3 id="四、连接分析"><a href="#四、连接分析" class="headerlink" title="四、连接分析"></a>四、连接分析</h3><p>就是发现数据中的关联规则，它被广泛应用在购物篮分析，或事务数据分析中，比如通过邮件来连接，常见连接分析算法：PageRank</p><h2 id="算法十大模型"><a href="#算法十大模型" class="headerlink" title="算法十大模型"></a>算法十大模型</h2><h3 id="一、决策树"><a href="#一、决策树" class="headerlink" title="一、决策树"></a>一、决策树</h3><p>总结：决策树的原理就是找到<strong>纯度最高的点作为根结点</strong>，并继续通过<strong>信息增益</strong>或<strong>基尼系数</strong>判断剩下结点那个纯度最高，继续选择根节点。直到递归终止到分到某个类时，目标属性全是一个值或者某个值的比例达到给定的阈值</p><p>讲的很好的相关视频：<a href="https://www.bilibili.com/video/BV1T7411b7DG/?spm_id_from=333.337.search-card.all.click&vd_source=178669e0797f36fb015c5fc3cb9c7a4f">【数据挖掘】决策树零基础入门教程，手把手教你学决策树！_哔哩哔哩_bilibili</a></p><h4 id="1、纯度、信息熵"><a href="#1、纯度、信息熵" class="headerlink" title="1、纯度、信息熵"></a>1、纯度、信息熵</h4><p>​决策树的在决策过程中有三个重要的问题：</p><ul><li>将哪个属性作为根节点？</li><li>选择哪些属性作为后继节点？</li><li>什么时候停止并得到目标值？</li></ul><p>在这里我们先介绍两个指标：<strong>纯度</strong>和<strong>信息熵</strong>。</p><p>先来说一下纯度，你可以把决策树的构造过程理解成为寻找纯净划分的过程。</p><p>数学上，我们可以用纯度来表示，纯度换一种方式来解释就是让目标变量的分歧最小。我在这里举个例子，假设有3个集合：</p><ul><li>集合1：6次都去打篮球；</li><li>集合2：4次去打篮球，2次不去打篮球；</li><li>集合3：3次去打篮球，3次不去打篮球。</li></ul><p>按照纯度指标来说，集合1&gt;集合2&gt;集合3。因为集合1的分歧最小，集合3的分歧最大。</p><p>然后我们再来介绍信息熵（entropy）的概念，它表示了信息的不确定度。</p><p>在信息论中，随机离散事件出现的概率存在着不确定性。为了衡量这种信息的不确定性，信息学之父香农引入了信息熵的概念，并给出了计算信息熵的数学公式：</p><img src="/images/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%AE%9E%E6%88%9845%E8%AE%B2/image-20221029102814947.png" alt="信息熵的计算" style="zoom:50%;box-shadow:rgba(0,0,0,0) 0 1px 5px 0px;"/><p>p(i|t)代表了节点t为分类i的概率，其中log2为取以2为底的对数。它能帮我们反映出来这个信息的不确定度。当不确定性越大时，它所包含的信息量也就越大，信息熵也就越高。<strong>信息熵越大，纯度越低。当集合中的所有样本均匀混合时，信息熵最大，纯度最低。</strong></p><p>在构造决策树的时候，会基于纯度来构建。而经典的 “不纯度”的指标有三种，分别是信息增益（ID3算法）、信息增益率（C4.5算法）以及基尼指数（Cart算法）。</p><ul><li>首先ID3算法的优点是方法简单，缺点是对噪声敏感。训练数据如果有少量错误，可能会产生决策树分类错误。</li><li>C4.5在ID3的基础上，用信息增益率代替了信息增益，解决了噪声敏感的问题，并且可以对构造树进行剪枝、处理连续数值以及数值缺失等情况，但是由于C4.5需要对数据集进行多次扫描，算法效率相对较低。</li><li>CART只支持二叉树，CART分类树是基于基尼系数做判断，CART回归树是基于偏差做判断。</li></ul><p>决策有关的计算视频：<a href="https://www.bilibili.com/video/BV1Cq4y1S7k1/?spm_id_from=333.788.recommend_more_video.-1&vd_source=178669e0797f36fb015c5fc3cb9c7a4f">【决策树算法计算】ID3算法 C4.5算法 Cart算法 相关计算 _哔哩哔哩_bilibili</a></p><h4 id="2、ID3算法"><a href="#2、ID3算法" class="headerlink" title="2、ID3算法"></a>2、ID3算法</h4><p><strong>总结：使用信息增益最大的作为根节点</strong></p><p>ID3算法计算的是<strong>信息增益</strong>，信息增益指的就是划分可以带来纯度的提高，信息熵的下降。它的计算公式，是父亲节点的信息熵减去所有子节点的信息熵。在计算的过程中，我们会计算每个子节点的归一化信息熵，即按照每个子节点在父节点中出现的概率，来计算这些子节点的信息熵。所以信息增益的公式可以表示为：</p><img src="/images/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%AE%9E%E6%88%9845%E8%AE%B2/image-20221029102517289.png" alt="信息增益的计算" style="zoom: 50%;box-shadow:rgba(0,0,0,0) 0 1px 5px 0px;" /><h4 id="3、C4-5算法"><a href="#3、C4-5算法" class="headerlink" title="3、C4.5算法"></a>3、C4.5算法</h4><p><strong>总结：使用信息增益率最大的作为根节点</strong> </p><p>在ID3算法上进行改进的C4.5算法，那么C4.5都在哪些方面改进了ID3呢？</p><ul><li><strong>采用信息增益率</strong></li></ul><p>因为ID3在计算的时候，倾向于选择取值多的属性。为了避免这个问题，C4.5采用信息增益率的方式来选择属性。信息增益率&#x3D;信息增益&#x2F;属性熵，具体的计算公式这里省略。当属性有很多值的时候，相当于被划分成了许多份，虽然信息增益变大了，但是对于C4.5来说，属性熵也会变大，所以整体的信息增益率并不大。</p><ul><li><strong>采用悲观剪枝</strong></li></ul><p>ID3构造决策树的时候，容易产生过拟合的情况。在C4.5中，会在决策树构造之后采用悲观剪枝（PEP），这样可以提升决策树的泛化能力。悲观剪枝是后剪枝技术中的一种，通过递归估算每个内部节点的分类错误率，比较剪枝前后这个节点的分类错误率来决定是否对其进行剪枝。这种剪枝方法不再需要一个单独的测试数据集。</p><ul><li><strong>离散化处理连续属性</strong></li></ul><p>C4.5可以处理连续属性的情况，对连续的属性进行离散化的处理。比如打篮球存在的“湿度”属性，不按照“高、中”划分，而是按照湿度值进行计算，那么湿度取什么值都有可能。该怎么选择这个阈值呢，<strong>C4.5选择具有最高信息增益的划分所对应的阈值</strong>。</p><ul><li><strong>处理缺失值</strong></li></ul><p>针对数据集不完整的情况，C4.5也可以进行处理。</p><h4 id="4、Cart算法"><a href="#4、Cart算法" class="headerlink" title="4、Cart算法"></a>4、Cart算法</h4><p><strong>总结：CART分类树是基尼系数最小的作为根节点，CART回归树是基于偏差做判断。</strong></p><p>CART算法，英文全称叫做Classification And Regression Tree，中文叫做分类回归树。ID3和C4.5算法可以生成二叉树或多叉树，而CART只支持二叉树。同时CART决策树比较特殊，既可以作分类树，又可以作回归树。<strong>在工具使用上，我们可以使用sklearn中的DecisionTreeClassifier创建CART分类树，通过DecisionTreeRegressor创建CART回归树。</strong></p><ul><li>CART分类二叉树</li></ul><p>分类树可以处理离散数据，也就是数据种类有限的数据，它输出的是样本的类别。作为分类树，CART采用基尼系数作为节点划分的依据，得到的是离散的结果，也就是分类结果；假设t为节点，那么该节点的GINI系数的计算公式为：</p><img src="/images/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%AE%9E%E6%88%9845%E8%AE%B2/image-20221029130731142.png" alt="基尼系数的计算" style="zoom: 33%;box-shadow:rgba(0,0,0,0) 0 1px 5px 0px;" /><p>这里p(C<SUB>k</SUB>|t)表示节点t属于类别C<SUB>k</SUB>的概率，节点t的基尼系数为1减去各类别C<SUB>k</SUB>概率平方和。</p><p>下面，我们来用CART分类树，给sklearn中自带的iris数据集构造一棵分类决策树。</p><ul><li>首先train_test_split可以帮助我们把数据集抽取一部分作为测试集，这样我们就可以得到训练集和测试集。</li><li>使用clf &#x3D; DecisionTreeClassifier(criterion&#x3D;‘gini’)初始化一棵CART分类树。这样你就可以对CART分类树进行训练。</li><li>使用clf.fit(train_features, train_labels)函数，将训练集的特征值和分类标识作为参数进行拟合，得到CART分类树。</li><li>使用clf.predict(test_features)函数进行预测，传入测试集的特征值，可以得到测试结果test_predict。</li><li>最后使用accuracy_score(test_labels, test_predict)函数，传入测试集的预测结果与实际的结果作为参数，得到准确率score。</li><li>我们能看到sklearn帮我们做了CART分类树的使用封装，使用起来还是很方便的。</li></ul><p>基于iris数据集，构造CART分类树的代码如下：</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># encoding=utf-8</span><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> train_test_split<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> accuracy_score<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>tree <span class="token keyword">import</span> DecisionTreeClassifier<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>datasets <span class="token keyword">import</span> load_iris<span class="token comment"># 准备数据集</span>iris<span class="token operator">=</span>load_iris<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment"># 获取特征集和分类标识</span>features <span class="token operator">=</span> iris<span class="token punctuation">.</span>datalabels <span class="token operator">=</span> iris<span class="token punctuation">.</span>target<span class="token comment"># 随机抽取33%的数据作为测试集，其余为训练集</span>train_features<span class="token punctuation">,</span> test_features<span class="token punctuation">,</span> train_labels<span class="token punctuation">,</span> test_labels <span class="token operator">=</span> train_test_split<span class="token punctuation">(</span>features<span class="token punctuation">,</span> labels<span class="token punctuation">,</span> test_size<span class="token operator">=</span><span class="token number">0.33</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token comment"># 创建CART分类树</span>clf <span class="token operator">=</span> DecisionTreeClassifier<span class="token punctuation">(</span>criterion<span class="token operator">=</span><span class="token string">'gini'</span><span class="token punctuation">)</span><span class="token comment"># 拟合构造CART分类树</span>clf <span class="token operator">=</span> clf<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>train_features<span class="token punctuation">,</span> train_labels<span class="token punctuation">)</span><span class="token comment"># 用CART分类树做预测</span>test_predict <span class="token operator">=</span> clf<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>test_features<span class="token punctuation">)</span><span class="token comment"># 预测结果与测试集结果作比对</span>score <span class="token operator">=</span> accuracy_score<span class="token punctuation">(</span>test_labels<span class="token punctuation">,</span> test_predict<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"CART分类树准确率 %.4lf"</span> <span class="token operator">%</span> score<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>运行结果：</p><pre class="line-numbers language-none"><code class="language-none">CART分类树准确率 0.9600<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li>CART回归树二叉树</li></ul><p>​     回归树可以对连续型的数值进行预测，也就是数据在某个区间内都有取值的可能，它输出的是一个数值。CART可以采用最小绝对偏差（LAD），或者最小二乘偏差（LSD）作为节点划分的依据，得到的是连续值，即回归预测结果。样本的离散程度具体的计算方式是，先计算所有样本的均值，然后计算每个样本值到均值的差值。我们假设x为样本的个体，均值为u。为了统计样本的离散程度，我们可以取差值的绝对值，或者方差。</p><p>其中差值的绝对值为样本值减去样本均值的绝对值：</p><img src="https://static001.geekbang.org/resource/image/6f/97/6f9677a70b1edff85e9e467f3e52bd97.png" alt="最小绝对偏差（LAD）" style="zoom:33%;box-shadow:rgba(0,0,0,0) 0 1px 5px 0px;" /><p>方差为每个样本值减去样本均值的平方和除以样本个数：</p><img src="https://static001.geekbang.org/resource/image/04/c1/045fd5afb7b53f17a8accd6f337f63c1.png" alt="最小二乘偏差（LSD）" style="zoom: 67%;box-shadow:rgba(0,0,0,0) 0 1px 5px 0px;" /><p>所以这两种节点划分的标准，分别对应着两种目标函数最优化的标准，即用最小绝对偏差（LAD），或者使用最小二乘偏差（LSD）。这两种方式都可以让我们找到节点划分的方法，通常使用最小二乘偏差的情况更常见一些。</p><p>这里我们使用到sklearn自带的波士顿房价数据集，该数据集给出了影响房价的一些指标，比如犯罪率，房产税等，最后给出了房价。根据这些指标，我们使用CART回归树对波士顿房价进行预测，</p><ul><li>首先加载了波士顿房价数据集，得到特征集和房价。然后通过train_test_split帮助我们把数据集抽取一部分作为测试集，其余作为训练集。</li><li>使用dtr&#x3D;DecisionTreeRegressor()初始化一棵CART回归树。</li><li>使用dtr.fit(train_features, train_price)函数，将训练集的特征值和结果作为参数进行拟合，得到CART回归树。</li><li>使用dtr.predict(test_features)函数进行预测，传入测试集的特征值，可以得到预测结果predict_price。</li><li>最后我们可以求得这棵回归树的二乘偏差均值，以及绝对值偏差均值。</li><li>我们能看到CART回归树的使用和分类树类似，只是最后求得的预测值是个连续值。</li></ul><p>代码如下：</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># encoding=utf-8</span><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> mean_squared_error<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> train_test_split<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>datasets <span class="token keyword">import</span> load_boston<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> r2_score<span class="token punctuation">,</span>mean_absolute_error<span class="token punctuation">,</span>mean_squared_error<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>tree <span class="token keyword">import</span> DecisionTreeRegressor<span class="token comment"># 准备数据集</span>boston<span class="token operator">=</span>load_boston<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment"># 探索数据</span><span class="token keyword">print</span><span class="token punctuation">(</span>boston<span class="token punctuation">.</span>feature_names<span class="token punctuation">)</span><span class="token comment"># 获取特征集和房价</span>features <span class="token operator">=</span> boston<span class="token punctuation">.</span>dataprices <span class="token operator">=</span> boston<span class="token punctuation">.</span>target<span class="token comment"># 随机抽取33%的数据作为测试集，其余为训练集</span>train_features<span class="token punctuation">,</span> test_features<span class="token punctuation">,</span> train_price<span class="token punctuation">,</span> test_price <span class="token operator">=</span> train_test_split<span class="token punctuation">(</span>features<span class="token punctuation">,</span> prices<span class="token punctuation">,</span> test_size<span class="token operator">=</span><span class="token number">0.33</span><span class="token punctuation">)</span><span class="token comment"># 创建CART回归树</span>dtr<span class="token operator">=</span>DecisionTreeRegressor<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment"># 拟合构造CART回归树</span>dtr<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>train_features<span class="token punctuation">,</span> train_price<span class="token punctuation">)</span><span class="token comment"># 预测测试集中的房价</span>predict_price <span class="token operator">=</span> dtr<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>test_features<span class="token punctuation">)</span><span class="token comment"># 测试集的结果评价</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'回归树二乘偏差均值:'</span><span class="token punctuation">,</span> mean_squared_error<span class="token punctuation">(</span>test_price<span class="token punctuation">,</span> predict_price<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'回归树绝对值偏差均值:'</span><span class="token punctuation">,</span> mean_absolute_error<span class="token punctuation">(</span>test_price<span class="token punctuation">,</span> predict_price<span class="token punctuation">)</span><span class="token punctuation">)</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>运行结果（每次运行结果可能会有不同）：</p><pre class="line-numbers language-none"><code class="language-none">[&#39;CRIM&#39; &#39;ZN&#39; &#39;INDUS&#39; &#39;CHAS&#39; &#39;NOX&#39; &#39;RM&#39; &#39;AGE&#39; &#39;DIS&#39; &#39;RAD&#39; &#39;TAX&#39; &#39;PTRATIO&#39; &#39;B&#39; &#39;LSTAT&#39;]回归树二乘偏差均值: 23.80784431137724回归树绝对值偏差均值: 3.040119760479042<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>5、决策树实战</p><p>​通过决策树来进行泰坦尼克乘客生存预测</p><h3 id="二、朴素贝叶斯"><a href="#二、朴素贝叶斯" class="headerlink" title="二、朴素贝叶斯"></a>二、朴素贝叶斯</h3><p>​对于给出的未知物体想要进行分类，就需要求解在这个未知物体出现的条件下各个类别出现的概率，哪个最大，就认为 这个未知物体属于哪个分类。</p><p><strong>先验概率</strong>：通过经验来判断事情发生的概率</p><p><strong>后验概率</strong>：后验概率就是发生结果之后，推测原因的概率。</p><p><strong>条件概率</strong>：事件A 在另外一个事件B已经发生条件下的发生概率，表示为P(A|B)，读作“在B 发生的条件下A 发生的概率”。</p><img src="/images/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%AE%9E%E6%88%9845%E8%AE%B2/image-20221029170040406.png" alt="贝叶斯公式" style="zoom:50%;box-shadow:rgba(0,0,0,0) 0 1px 5px 0px;" /><p>由此，我们可以得出通用的贝叶斯公式：</p><img src="/images/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%AE%9E%E6%88%9845%E8%AE%B2/image-20221029170146364.png" alt="通用贝叶斯公式" style="zoom: 50%;box-shadow:rgba(0,0,0,0) 0 1px 5px 0px;" /><h4 id="1、朴素贝叶斯"><a href="#1、朴素贝叶斯" class="headerlink" title="1、朴素贝叶斯"></a>1、朴素贝叶斯</h4><p>讲完贝叶斯原理之后，我们再来看下朴素贝叶斯。</p><p><strong>它是一种简单但极为强大的预测建模算法</strong>。之所以称为朴素贝叶斯，是因为它假设每个输入变量是独立的。这是一个强硬的假设，实际情况并不一定，但是这项技术对于绝大部分的复杂问题仍然非常有效。朴素贝叶斯模型由两种类型的概率组成：</p><ol><li>每个类别的概率P(C<SUB>j</SUB>)；</li><li>每个属性的条件概率P(A<SUB>i</SUB>|C<SUB>j</SUB>)。</li></ol><h4 id="2、贝叶斯原理、贝叶斯分类和朴素贝叶斯的区别"><a href="#2、贝叶斯原理、贝叶斯分类和朴素贝叶斯的区别" class="headerlink" title="2、贝叶斯原理、贝叶斯分类和朴素贝叶斯的区别"></a>2、贝叶斯原理、贝叶斯分类和朴素贝叶斯的区别</h4><p>贝叶斯原理是最大的概念，它解决了概率论中“逆向概率”的问题，在这个理论基础上，人们设计出了贝叶斯分类器，朴素贝叶斯分类是贝叶斯分类器中的一种，也是最简单，最常用的分类器。</p><p>朴素贝叶斯之所以朴素是因为它假设属性是相互独立的，因此对实际情况有所约束，如果属性之间存在关联，分类准确率会降低。不过好在对于大部分情况下，朴素贝叶斯的分类效果都不错。</p><h4 id="3、Sklearn机器学习包中的朴素贝叶斯"><a href="#3、Sklearn机器学习包中的朴素贝叶斯" class="headerlink" title="3、Sklearn机器学习包中的朴素贝叶斯"></a>3、Sklearn机器学习包中的朴素贝叶斯</h4><p>sklearn机器学习包给我们提供了3个朴素贝叶斯分类算法，分别是</p><ul><li><strong>高斯朴素贝叶斯</strong>（GaussianNB）：特征变量是连续变量，符合高斯分布，比如说人的身高，物体的长度。</li><li><strong>多项式朴素贝叶斯</strong>（MultinomialNB）：特征变量是离散变量，符合多项分布，在文档分类中特征变量体现在一个单词出现的次数，或者是单词的TF-IDF值等。</li><li><strong>伯努利朴素贝叶斯</strong>（BernoulliNB）：特征变量是布尔变量，符合0&#x2F;1分布，在文档分类中特征是单词是否出现。</li></ul><h4 id="4、TF-IDF（补充-）"><a href="#4、TF-IDF（补充-）" class="headerlink" title="4、TF-IDF（补充 ）"></a>4、TF-IDF（补充 ）</h4><ul><li><strong>词频TF</strong>计算了一个单词在文档中出现的次数，它认为一个单词的重要性和它在文档中出现的次数呈正比。</li></ul><img src="/images/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%AE%9E%E6%88%9845%E8%AE%B2/image-20221029172135853.png" alt="词频TF" style="zoom:50%;box-shadow:rgba(0,0,0,0) 0 1px 5px 0px;" /><ul><li><strong>逆向文档频率IDF</strong>，是指一个单词在文档中的区分度。它认为一个单词出现在的文档数越少，就越能通过这个单词把该文档和其他文档区分开。IDF越大就代表该单词的区分度越大。有些单词可能不会存在文档中，为了避免分母为0，统一给单词出现的文档数都加1。</li></ul><img src="/images/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%AE%9E%E6%88%9845%E8%AE%B2/image-20221029172151209.png" alt="逆向文档频率IDF" style="zoom:50%;box-shadow:rgba(0,0,0,0) 0 1px 5px 0px;" /><ul><li><p><strong>所以TF-IDF实际上是词频TF和逆向文档频率IDF的乘积</strong>。这样我们倾向于找到TF和IDF取值都高的单词作为区分，即这个单词在一个文档中出现的次数多，同时又很少出现在其他文档中。这样的单词适合用于分类。</p></li><li><p><strong>如何求TF-IDF</strong>，在sklearn中我们直接使用TfidfVectorizer类，它可以帮我们计算单词TF-IDF向量的值。在这个类中，取sklearn计算的对数log时，底数是e，不是10。</p></li></ul><h3 id="三、SVM"><a href="#三、SVM" class="headerlink" title="三、SVM"></a>三、SVM</h3><h4 id="1、SVM的原理"><a href="#1、SVM的原理" class="headerlink" title="1、SVM的原理"></a>1、SVM的原理</h4><p><strong>SVM就是帮我们找到一个超平面</strong>，这个超平面能将不同的样本划分开，同时使得样本集中的点到这个分类超平面的最小距离（即分类间隔）最大化。</p><p>在这个过程中，<strong>支持向量</strong>就是离超平面最近的样本点，实际上如果确定了支持向量也就确定了这个超平面。所以支持向量决定了分类间隔到底是多少，而在最大间隔以外的样本点，其实对分类都没有意义。</p><p><strong>对分类间隔的大小进行定义</strong>，首先，我们定义某类样本集到超平面的距离是这个样本集合内的样本到超平面的最短距离。我们用d<SUB>i</SUB>代表点x<SUB>i</SUB>到超平面wx<SUB>i</SUB>+b&#x3D;0的欧氏距离。因此我们要求d<SUB>i</SUB>的最小值，用它来代表这个样本到超平面的最短距离。d<SUB>i</SUB>可以用公式计算得出：</p><img src="/images/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%AE%9E%E6%88%9845%E8%AE%B2/image-20221029193733145.png" alt="分类间隔的大小" style="zoom: 30%;box-shadow:rgba(0,0,0,0) 0 1px 5px 0px;" /><p>我们的目标就是找出所有分类间隔中最大的那个值对应的超平面。在数学上，这是一个凸优化问题（凸优化就是关于求凸集中的凸函数最小化的问题，这里不具体展开），通过凸优化问题，最后可以求出最优的w和b，也就是我们想要找的最优超平面。</p><h4 id="2、核函数（相当于激活函数）"><a href="#2、核函数（相当于激活函数）" class="headerlink" title="2、核函数（相当于激活函数）"></a>2、核函数（相当于激活函数）</h4><p><strong>核函数:它可以将样本从原始空间映射到一个更高维的特质空间中，使得样本在新的空间中线性可分</strong>。</p><p>所以在非线性SVM中，核函数的选择就是影响SVM最大的变量。最常用的核函数有线性核、多项式核、高斯核、拉普拉斯核、sigmoid核，或者是这些核函数的组合。这些函数的区别在于映射方式的不同。通过这些核函数，我们就可以把样本空间投射到新的高维空间中。</p><h4 id="3、硬间隔、软间隔和非线性SVM"><a href="#3、硬间隔、软间隔和非线性SVM" class="headerlink" title="3、硬间隔、软间隔和非线性SVM"></a>3、硬间隔、软间隔和非线性SVM</h4><p><strong>硬间隔</strong>，假如数据是完全的线性可分的，那么学习到的模型可以称为硬间隔支持向量机。换个说法，硬间隔指的就是完全分类准确，不能存在分类错误的情况。</p><p><strong>软间隔</strong>，就是允许一定量的样本分类错误，我们知道，实际工作中的数据没有那么“干净”，或多或少都会存在一些噪点，所以线性可分是个理想情况。这时，我们需要使用到软间隔SVM（近似线性可分）</p><p>当然软间隔和核函数的提出，都是为了方便我们对上面超平面公式中的w和b进行求解，从而得到最大分类间隔的超平面。</p><h3 id="四、KNN"><a href="#四、KNN" class="headerlink" title="四、KNN"></a>四、KNN</h3><h4 id="1、KNN算法的定义"><a href="#1、KNN算法的定义" class="headerlink" title="1、KNN算法的定义"></a>1、KNN算法的定义</h4><p>​KNN 也叫 K 最近邻算法，就是每个样本都可以用它最接近的 K 个邻居来代表。如果一个样本，它的 K 个最接近的邻居都属于分类 A，那么这个样本也属于分类 A。原理如下：</p><ol><li>计算待分类物体与其他物体之间的距离；</li><li>统计距离最近的K个邻居；</li><li>对于K个最近的邻居，它们属于哪个分类最多，待分类物体就属于哪一类。</li></ol><h4 id="2、KNN算法中K值的选择"><a href="#2、KNN算法中K值的选择" class="headerlink" title="2、KNN算法中K值的选择"></a>2、KNN算法中K值的选择</h4><p>你能看出整个KNN的分类过程，K值的选择还是很重要的。</p><ul><li><p>如果 K 值比较小，就相当于未分类物体与它的邻居非常接近才行。这样产生的一个问题就是，如果邻居点是个噪声点，那么未分类物体的分类也会产生误差，这样KNN分类就会产生过拟合。</p></li><li><p>如果K值比较大，相当于距离过远的点也会对未知物体的分类产生影响，虽然这种情况的好处是鲁棒性强，但是不足也很明显，会产生欠拟合情况，也就是没有把未分类物体真正分类出来。</p></li></ul><p>所以K值应该是个实践出来的结果，并不是我们事先而定的。在工程上，我们一般采用交叉验证的方式选取 K 值。</p><p>交叉验证的思路就是，把样本集中的大部分样本作为训练集，剩余的小部分样本用于预测，来验证分类模型的准确性。所以在KNN算法中，我们一般会把K值选取在较小的范围内，同时在验证集上准确率最高的那一个最终确定作为K值。</p><h4 id="3、距离的计算"><a href="#3、距离的计算" class="headerlink" title="3、距离的计算"></a>3、距离的计算</h4><p>在KNN算法中，还有一个重要的计算就是关于距离的度量。两个样本点之间的距离代表了这两个样本之间的相似度。距离越大，差异性越大；距离越小，相似度越大。</p><p>关于距离的计算方式有下面五种方式：</p><ol><li><p>欧氏距离</p><p><strong>欧氏距离</strong>是我们最常用的距离公式，也叫做欧几里得距离。在二维空间中，两点的欧式距离就是：</p><img src="https://static001.geekbang.org/resource/image/f8/80/f8d4fe58ec9580a4ffad5cee263b1b80.png" alt="欧氏距离" style="zoom:33%;box-shadow:rgba(0,0,0,0) 0 1px 5px 0px;" /><p>同理，我们也可以求得两点在n维空间中的距离：</p><img src="https://static001.geekbang.org/resource/image/40/6a/40efe7cb4a2571e55438b55f8d37366a.png" alt="多维欧氏距离" style="zoom:33%;box-shadow:rgba(0,0,0,0) 0 1px 5px 0px;" /></li><li><p>曼哈顿距离</p><p><strong>曼哈顿距离</strong>在几何空间中用的比较多。以下图为例，绿色的直线代表两点之间的欧式距离，而红色和黄色的线为两点的曼哈顿距离。所以曼哈顿距离等于两个点在坐标系上绝对轴距总和。用公式表示就是：</p><img src="https://static001.geekbang.org/resource/image/bd/aa/bda520e8ee34ea19df8dbad3da85faaa.png" alt="曼哈顿距离" style="zoom:33%;box-shadow:rgba(0,0,0,0) 0 1px 5px 0px;" /></li><li><p>闵可夫斯基距离；</p></li><li><p>切比雪夫距离；</p></li><li><p>余弦距离；</p></li></ol><h4 id="4、KD树"><a href="#4、KD树" class="headerlink" title="4、KD树"></a>4、KD树</h4><p>其实从上文你也能看出来，KNN的计算过程是大量计算样本点之间的距离。为了减少计算距离次数，提升KNN的搜索效率，人们提出了KD树（K-Dimensional的缩写）。KD树是对数据点在K维空间中划分的一种数据结构。在KD树的构造中，每个节点都是k维数值点的二叉树。既然是二叉树，就可以采用二叉树的增删改查操作，这样就大大提升了搜索效率。</p><h4 id="5、如何在sklearn中使用KNN"><a href="#5、如何在sklearn中使用KNN" class="headerlink" title="5、如何在sklearn中使用KNN"></a>5、如何在sklearn中使用KNN</h4><p>在Python的sklearn工具包中有KNN算法。KNN既可以做分类器，也可以做回归。如果是做分类，你需要引用：</p><pre class="line-numbers language-none"><code class="language-none">from sklearn.neighbors import KNeighborsClassifier<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>如果是做回归，你需要引用：</p><pre class="line-numbers language-none"><code class="language-none">from sklearn.neighbors import KNeighborsRegressor<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>从名字上你也能看出来Classifier对应的是分类，Regressor对应的是回归。一般来说如果一个算法有Classifier类，都能找到相应的Regressor类。比如在决策树分类中，你可以使用DecisionTreeClassifier，也可以使用决策树来做回归DecisionTreeRegressor。</p><h3 id="五、AdaBoost"><a href="#五、AdaBoost" class="headerlink" title="五、AdaBoost"></a>五、AdaBoost</h3><h4 id="1、AdaBoost定义"><a href="#1、AdaBoost定义" class="headerlink" title="1、AdaBoost定义"></a>1、AdaBoost定义</h4><p>​Adaboost 在训练中建立了一个联合的分类模型。boost 在英文中代表提升的意思，所以 Adaboost 是个构建分类器的提升算法。它可以让我们多个弱的分类器组成一个强的分类器。AdaBoost 算法与随机森林算法一样都属于分类算法中的集成算法。集成算法通常有两种方式，分别是投票选举（bagging）和再学习 （boosting）。</p><ul><li>​投票选举：类似把专家召集到一个会议桌前，当做一个决定的时候， 让 K 个专家（K 个模型）分别进行分类，然后选择出现次数最多的那个类作为最终的分类结果。</li><li>​再学习：相当于把 K 个专家（K 个分类器）进行加权融合，形成一个新的超级专家 （强分类器），让这个超级专家做判断。</li></ul><p>Adaboost是通过一系列的弱分类器根据不同的权重组合而成的。 假设弱分类器为 G<SUB>i</SUB>(x)，它在强分类器中的权重 ，那么就可以得出强分类器 f(x)：</p><img src="/images/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%AE%9E%E6%88%9845%E8%AE%B2/image-20221031195751399.png" alt="强分类器" style="zoom: 50%; box-shadow: rgba(0, 0, 0, 0) 0px 1px 5px 0px;" /><ol><li>每个弱分类器在强分类器中的权重是如何计算的？</li><li>如何得到弱分类器，也就是在每次迭代训练的过程中，如何得到最优弱分类器？</li></ol><h4 id="2、弱分类器权重的计算"><a href="#2、弱分类器权重的计算" class="headerlink" title="2、弱分类器权重的计算"></a>2、弱分类器权重的计算</h4><p>实际上在一个由 K 个弱分类器中组成的强分类器中，如果弱分类器的分类效果好，那么权重应该比较大，如果弱分类器的分类效果一般，权重应该降低。所以我们需要基于这个弱分类器对样本的分类错误率来决定它的权重，其中e<SUB>i</SUB> 代表第 i 个分类器的分类错误率。用公式表示就是：</p><img src="/images/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%AE%9E%E6%88%9845%E8%AE%B2/image-20221031200339325.png" alt="弱分类器权重" style="zoom: 50%;box-shadow: rgba(0, 0, 0, 0) 0px 1px 5px 0px;" /><h4 id="3、在训练迭代中选择最优弱分类器"><a href="#3、在训练迭代中选择最优弱分类器" class="headerlink" title="3、在训练迭代中选择最优弱分类器"></a>3、在训练迭代中选择最优弱分类器</h4><p>​实际上，AdaBoost 算法是通过改变样本的数据分布来实现选择最优弱分类器的。AdaBoost 会判断每次训练的样本是否正确分类，对于正确分类的样本，降低它的权重，对于被错误分类的样本， 增加它的权重。再基于上一次得到的分类准确率，来确定这次训练样本中每个样本的权 重。然后将修改过权重的新数据集传递给下一层的分类器进行训练。这样做的好处就是， 通过每一轮训练样本的动态权重，可以让训练的焦点集中到难分类的样本上，最终得到的弱分类器的组合更容易得到更高的分类准确率。</p><p>我们可以用D<SUB>k+1</SUB>代表第 k+1 轮训练中，样本的权重集合，其中W<SUB>k+1,k</SUB>代表第 k+1 轮 中第一个样本的权重，以此类推W<SUB>k+1,N</SUB>代表第 k+1 轮中第 N 个样本的权重，因此用公式表示为：</p><img src="/images/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%AE%9E%E6%88%9845%E8%AE%B2/image-20221031201305653.png"  style="zoom:50%;box-shadow: rgba(0, 0, 0, 0) 0px 1px 5px 0px;" /><p>第 k+1 轮中的样本权重，是根据该样本在第 k 轮的权重以及第 k 个分类器的准确率而 定，具体的公式为：</p><img src="/images/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%AE%9E%E6%88%9845%E8%AE%B2/image-20221031201330118.png"  style="zoom:50%;box-shadow: rgba(0, 0, 0, 0) 0px 1px 5px 0px;" /><h3 id="六、K-Means"><a href="#六、K-Means" class="headerlink" title="六、K-Means"></a>六、K-Means</h3><h4 id="1、K-Means原理"><a href="#1、K-Means原理" class="headerlink" title="1、K-Means原理"></a>1、K-Means原理</h4><p>​K-Means 算法是一个聚类算法。你可以这么理解，最终我想把物体划分成 K 类。假设每 个类别里面，都有个“中心点”，即意见领袖，它是这个类别的核心。现在我有一个新点 要归类，这时候就只要计算这个新点与 K 个中心点的距离，距离哪个中心点近，就变成了 哪个类别。</p><ol><li>选取K个点作为初始的类中心点，这些点一般都是从数据集中随机抽取的；</li><li>将每个点分配到最近的类中心点，这样就形成了K个类，然后重新计算每个类的中心点；</li><li>重复第二步，直到类不发生变化，或者你也可以设置最大迭代次数，这样即使类中心点发生变化，但是只要达到最大迭代次数就会结束。</li></ol><h4 id="2、K-Means和KNN的区别"><a href="#2、K-Means和KNN的区别" class="headerlink" title="2、K-Means和KNN的区别"></a>2、K-Means和KNN的区别</h4><p>我们可以从三个维度来区分K-Means和KNN这两个算法：</p><ul><li>首先，这两个算法解决数据挖掘的两类问题。K-Means是聚类算法，KNN是分类算法。</li><li>这两个算法分别是两种不同的学习方式。K-Means是非监督学习，也就是不需要事先给出分类标签，而KNN是有监督学习，需要我们给出训练数据的分类标识。</li><li>最后，K值的含义不同。K-Means中的K值代表K类。KNN中的K值代表K个最接近的邻居。</li></ul><h4 id="3、K-Means的缺陷"><a href="#3、K-Means的缺陷" class="headerlink" title="3、K-Means的缺陷"></a>3、K-Means的缺陷</h4><p>K-Means聚类有个缺陷：聚类个数K值需要事先指定。如果你不知道该聚成几类，那么最好会给K值多设置几个，然后选择聚类结果最好的那个值。</p><h3 id="七、EM"><a href="#七、EM" class="headerlink" title="七、EM"></a>七、EM</h3><h4 id="1、EM-算法"><a href="#1、EM-算法" class="headerlink" title="1、EM 算法"></a>1、EM 算法</h4><p>EM 算法也叫最大期望算法，是求参数的最大似然估计的一种方法,最大似然也就是求大可能性。</p><p>原理是这样的：假设 我们想要评估参数 A 和参数 B，在开始状态下二者都是未知的，并且知道了 A 的信息就可 以得到 B 的信息，反过来知道了 B 也就得到了 A。可以考虑首先赋予 A 某个初值，以此 得到 B 的估值，然后从 B 的估值出发，重新估计 A 的取值，这个过程一直持续到收敛为止,EM 算法经常用于聚类和机器学习领域中。</p><p>K-Means是通过距离来区分样本之间的差别的，且每个样本在计算的时候只能属于一个分类，称之为是硬聚类算法。而EM聚类在求解的过程中，实际上每个样本都有一定的概率和每个聚类相关，叫做软聚类算法。</p><img src="/images/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%AE%9E%E6%88%9845%E8%AE%B2/image-20221101094338194.png" alt="K-Means聚类效果" style="zoom:33%;" /><img src="/images/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%AE%9E%E6%88%9845%E8%AE%B2/image-20221101094518381.png" alt="EM算法聚类效果" style="zoom: 33%;" /><p>​EM算法相当于一个聚类框架，里面有不同的聚类模型，比如GMM高斯混合模型，或者HMM隐马尔科夫模型。</p><h4 id="2、GMM高斯混合模型"><a href="#2、GMM高斯混合模型" class="headerlink" title="2、GMM高斯混合模型"></a>2、GMM高斯混合模型</h4><p>GMM是通过概率密度来进行聚类，聚成的类符合高斯分布（正态分布）</p><h4 id="3、HMM隐马尔科夫模型"><a href="#3、HMM隐马尔科夫模型" class="headerlink" title="3、HMM隐马尔科夫模型"></a>3、HMM隐马尔科夫模型</h4><p>HMM用到了马尔可夫过程，在这个过程中，我们通过状态转移矩阵来计算状态转移的概率。HMM在自然语言处理和语音识别领域中有广泛的应用。</p><h3 id="八、Apriori"><a href="#八、Apriori" class="headerlink" title="八、Apriori"></a>八、Apriori</h3><h4 id="1、Apriori"><a href="#1、Apriori" class="headerlink" title="1、Apriori"></a>1、Apriori</h4><p>Apriori 是一种挖掘关联规则（association rules）的算法，它通过挖掘频繁项集 （frequent item sets）来揭示物品之间的关联关系，被广泛应用到商业挖掘和网络安全 等领域中。频繁项集是指经常出现在一起的物品的集合，关联规则暗示着两种物品之间可能存在很强的关系。</p><ul><li><p>支持度：是个百分比，它指的是某个商品组合出现的次数与总次数之间的比例。支持度越高，代表这个组合出现的频率越大</p></li><li><p>置信度：是个条件概念，就是说在A发生的情况下，B发生的概率是多少</p></li><li><p>提升度：代表的是“商品A的出现，对商品B的出现概率提升的程度。</p></li><li><p>频繁项集：小于最小值支持度的项目就是非频繁项集，而大于等于最小支持度的项集就是频繁项集。</p></li></ul><p>我们刚完成了Apriori算法的模拟，你能看到Apriori在计算的过程中有以下几个缺点：</p><ol><li>可能产生大量的候选集。因为采用排列组合的方式，把可能的项集都组合出来了；</li><li>每次计算都需要重新扫描数据集，来计算每个项集的支持度。</li></ol><p>所以Apriori算法会浪费很多计算空间和计算时间，为此人们提出了FP-Growth算法</p><h4 id="2、FP-Growth"><a href="#2、FP-Growth" class="headerlink" title="2、FP-Growth"></a>2、FP-Growth</h4><p>FP-Growth的特点是：</p><ol><li>创建了一棵FP树来存储频繁项集。在创建前对不满足最小支持度的项进行删除，减少了存储空间。我稍后会讲解如何构造一棵FP树；</li><li>整个生成过程只遍历数据集2次，大大减少了计算量。</li></ol><p>所以在实际工作中，我们常用FP-Growth来做频繁项集的挖掘，</p><p><strong>1.创建项头表（item header table）</strong></p><p>创建项头表的作用是为FP构建及频繁项集挖掘提供索引。</p><p>这一步的流程是先扫描一遍数据集，对于满足最小支持度的单个项（K&#x3D;1项集）按照支持度从高到低进行排序，这个过程中删除了不满足最小支持度的项。</p><p>项头表包括了项目、支持度，以及该项在FP树中的链表。初始的时候链表为空。</p><p><strong>2.构造FP树</strong></p><p>FP树的根节点记为NULL节点。</p><p>整个流程是需要再次扫描数据集，对于每一条数据，按照支持度从高到低的顺序进行创建节点（也就是第一步中项头表中的排序结果），节点如果存在就将计数count+1，如果不存在就进行创建。同时在创建的过程中，需要更新项头表的链表。</p><p><strong>3.通过FP树挖掘频繁项集</strong></p><p>到这里，我们就得到了一个存储频繁项集的FP树，以及一个项头表。我们可以通过项头表来挖掘出每个频繁项集。</p><p>具体的操作会用到一个概念，叫“条件模式基”，它指的是以要挖掘的节点为叶子节点，自底向上求出FP子树，然后将FP子树的祖先节点设置为叶子节点之和。</p><h3 id="九、PageRank"><a href="#九、PageRank" class="headerlink" title="九、PageRank"></a>九、PageRank</h3><p>​PageRank 起源于论文影响力的计算方式，如果一篇文论被引入的次数越多，就代表这篇论文的影响力越强。同样 PageRank 被 Google 创造性地应用到了网页权重的计算中：当 一个页面链出的页面越多，说明这个页面的“参考文献越多，当这个页面被链入的频率 越高，说明这个页面被引用的次数越高。基于这个原理，我们可以得到网站的权重划分。</p><h4 id="1、PageRank-的原理"><a href="#1、PageRank-的原理" class="headerlink" title="1、PageRank 的原理"></a>1、PageRank 的原理</h4><p>简单来说，一个网页的影响力 &#x3D; 所有入链集合的页面的加权影响力之和，出链指的是链接出去的链接，入链指的是链接进来的链接。u 为待评估的页面， B<SUB>u</SUB>为页面 u 的入链集合，用公式表示为：</p><img src="/images/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%AE%9E%E6%88%9845%E8%AE%B2/image-20221101121252832.png" alt="网页的影响力" style="zoom: 30%;box-shadow: rgba(0, 0, 0, 0) 0px 1px 5px 0px;" /><p>针对入链集合中的任意页面 v，它能给 u 带来的影响力是其自身的影响力 PR(v) 除以 v 页面的出链数量，即页面 v 把影响力 PR(v) 平均分配给了它的出链，这样统计所有能给 u 带来链接的页面 v，得到的总和就是网页 u 的影响力，即为 PR(u)。</p><p>举个例子，假设一共有 4 个网页 A、B、C、D。它们之间的链接信息如图所示：</p><img src="/images/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%AE%9E%E6%88%9845%E8%AE%B2/image-20221101122034940.png" alt="网页链接关系" style="zoom:33%;" /><p> A 有三个出链分别链接到了 B、C、D 上。那么当用户访问 A 的 时候，就有跳转到 B、C 或者 D 的可能性，跳转概率均为 1&#x2F;3。 B 有两个出链，链接到了 A 和 D 上，跳转概率为 1&#x2F;2。 这样，我们可以得到 A、B、C、D 这四个网页的转移矩阵 M：</p><img src="/images/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%AE%9E%E6%88%9845%E8%AE%B2/image-20221101122140825.png"  style="zoom: 50%; box-shadow: rgba(0, 0, 0, 0) 0px 1px 5px 0px;" /><p>我们假设 A、B、C、D 四个页面的初始影响力都是相同的，即：</p><img src="/images/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%AE%9E%E6%88%9845%E8%AE%B2/image-20221101122354942.png"  style="zoom:45%;box-shadow: rgba(0, 0, 0, 0) 0px 1px 5px 0px;" /><p>当进行第一次转移之后，各页面的影响力</p><img src="/images/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%AE%9E%E6%88%9845%E8%AE%B2/image-20221101122439293.png"  style="zoom:50%;box-shadow: rgba(0, 0, 0, 0) 0px 1px 5px 0px;" /><p>然后我们再用转移矩阵乘以得到结果，直到第 n 次迭代后 影响力不再发生变化，可以收敛到 (0.3333，0.2222，0.2222，0.2222，也就是对应着 A、B、C、D 四 个页面最终平衡状态下的影响力。 你能看出 A 页面相比于其他页面来说权重更大，也就是PR值更高。而 B、C、D 页面的 PR 值相等。</p><h4 id="2、PageRank-的随机浏览模型"><a href="#2、PageRank-的随机浏览模型" class="headerlink" title="2、PageRank 的随机浏览模型"></a>2、PageRank 的随机浏览模型</h4><p>PageRank 可能出现的问题</p><ol><li>等级泄露（Rank Leak）：如果一个网页没有出链，就像是一个黑洞一样，吸收了其他 网页的影响力而不释放，最终会导致其他网页的 PR 值为 0。</li><li>等级沉没（Rank Sink）：如果一个网页只有出链，没有入链（如下图所示），计算的 过程迭代下来，会导致这个网页的 PR 值为 0（也就是不存在公式中的 V）。</li></ol><p>为了解决简化模型中存在的等级泄露和等级沉没的问题，拉里·佩奇提出了 PageRank 的随机浏览模型，他假设了这样一个场景：用户并不都是按照跳转链接的方式来上网，还有一 种可能是不论当前处于哪个页面，都有概率访问到其他任意的页面，比如说用户就是要直 接输入网址访问其他页面，虽然这个概率比较小。 所以他定义了阻尼因子 d，这个因子代表了用户按照跳转链接来上网的概率，通常可以取 一个固定值 0.85，而 1-d&#x3D;0.15 则代表了用户不是通过跳转链接的方式来访问网页的，比 如直接输入网址。</p><img src="/images/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%AE%9E%E6%88%9845%E8%AE%B2/image-20221101123221224.png" alt="随机浏览模型" style="zoom: 33%;box-shadow: rgba(0, 0, 0, 0) 0px 1px 5px 0px;" /><p>其中 N 为网页总数，这样我们又可以重新迭代网页的权重计算了，因为加入了阻尼因子 d，一定程度上解决了等级泄露和等级沉没的问题。 通过数学定理也可以证明，最终 PageRank 随机浏览模型是可以收敛 的，也就是可以得到一个稳定正常的 PR 值。</p><h3 id="十、随机森林（补充）"><a href="#十、随机森林（补充）" class="headerlink" title="十、随机森林（补充）"></a>十、随机森林（补充）</h3><p>随机森林的英文是 Random Forest，英文简写是 RF。它实际上是一个包含多个决策树的分类 器，每一个子分类器都是一棵 CART 分类回归树。所以随机森林既可以做分类，又可以做回归。</p><ul><li>当它做分类的时候，输出结果是每个子分类器的分类结果中最多的那个。你可以理解是每个分类器都做投票，取投票最多的那个结果。</li><li>当它做回归的时候，输出结果是每棵 CART 树的回归结果 的平均值。</li></ul>]]></content>
      
      
      <categories>
          
          <category> 数据分析 </category>
          
          <category> NumPy </category>
          
          <category> Pandas </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数据分析 </tag>
            
            <tag> NumPy </tag>
            
            <tag> Pandas </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Git笔记</title>
      <link href="/2022/10/22/Git%E7%AC%94%E8%AE%B0/"/>
      <url>/2022/10/22/Git%E7%AC%94%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<h1 id="Git"><a href="#Git" class="headerlink" title="Git"></a>Git</h1><h2 id="GitHub加速"><a href="#GitHub加速" class="headerlink" title="GitHub加速"></a>GitHub加速</h2><p>方法一：修改hosts文件，hosts文件地址  <code>C:\Windows\System32\drivers\etc</code></p><p>方法二：使用FastGithub加速器  <a href="https://github.com/wxydaydayup/goodSoftware">FastGithub加速器</a></p><h2 id="Git操作"><a href="#Git操作" class="headerlink" title="Git操作"></a>Git操作</h2><h3 id="Git上传到GitHub"><a href="#Git上传到GitHub" class="headerlink" title="Git上传到GitHub"></a>Git上传到GitHub</h3><h4 id="第一种方法"><a href="#第一种方法" class="headerlink" title="第一种方法"></a>第一种方法</h4><p>第一步：</p><p>​查看SSH key 秘钥位置  <code>C:/Users/LENOVO/.ssh/id_rsa </code>  并且在Github中创建SSH key</p><p>第二步：</p><p>​在要上传的文件夹里右键打开<code>Git Bash Here</code></p><p>第三步：</p><p>​把Github上面的仓库克隆到本地</p><p>​<code>git clone https://github.com/wxydaydayup/Study_Notes.git</code></p><p>​这个步骤以后本地项目文件夹下面就会多出个文件夹，该文件夹名即为Github上面的项目名，多出了个Study_Notes文件夹，把本地项目文件夹下的所有文件（除了新多出的那个文件夹不用），其余都复制到那个新多出的文件夹下</p><p>​继续输入命令 <code>cd Study_Notes</code>，进入Study_Notes文件夹接下来依次执行 </p><ol><li><code>git add *</code>    （注：别忘记后面的.，此操作是把Test文件夹下面的文件都添加进来）</li><li><code>git commit  -m  &quot;提交信息&quot;</code>  （注：“提交信息”里面换成你需要，如“first commit”）</li><li><code>git push -u origin main</code>   （注：此操作目的是把本地仓库push到Github上，此步骤需要你输入帐号和密码）</li></ol><h4 id="第二种方法"><a href="#第二种方法" class="headerlink" title="第二种方法"></a>第二种方法</h4><p>从第一种方法 的第三步开始输入</p><ol><li><p><code>git init</code></p></li><li><p><code>git add *</code></p></li><li><p><code>git commit -m 1.zip</code></p><p>不加 -m 退出 ESC :wq </p></li><li><p><code>git remote add origin github.com/wxydaydayup/Study_Notes.git</code>（此时记得在github上创建一个仓库，并把仓库的ssh地址赋值下来，关联远程仓库）</p></li><li><p><code>git push -u origin master</code>  (这时github上就会多出文件，空加-u，不空不用,<code>git push -f origin master</code> 在这里，如果报错，就强制性上传代码)</p></li></ol><h3 id="Git大文件上传"><a href="#Git大文件上传" class="headerlink" title="Git大文件上传"></a>Git大文件上传</h3><h4 id="Git-lfs"><a href="#Git-lfs" class="headerlink" title="Git lfs"></a>Git lfs</h4><h4 id="彻底删除lfs"><a href="#彻底删除lfs" class="headerlink" title="彻底删除lfs"></a>彻底删除lfs</h4><p><code>git lfs uninstall</code></p><p><code>git filter-branch --force --index-filter</code></p><h3 id="Git-分支"><a href="#Git-分支" class="headerlink" title="Git 分支"></a>Git 分支</h3><ol><li>切换分支 <code>git checkout 分支名</code></li><li>创建并切换 <code>git checkout -b 分支名</code></li><li>合并分支  <code>git merge 分支名</code></li><li>删除分支时，需要做各种检查  <code>git branch -d 分支名</code></li><li>不做任何检查，强制删除分支 <code>git branch -D 分支名</code>（适用于dev分支没merge到主分支上）</li></ol><h3 id="Git常用命令"><a href="#Git常用命令" class="headerlink" title="Git常用命令"></a>Git常用命令</h3><ol><li>查看仓库状态 :  <code>git status</code></li><li>仓库初始化：<code>git init</code></li><li>添加文件到Git仓库：<code>git add demo.txt</code></li><li>提交文件到Git仓库：<code>git commit -m &quot;1&quot;</code></li><li>版本回退 <code>git reset --hard XXXX</code></li><li>查看版本信息 <code>git reflog</code></li><li>以精简的方式显示提交记录 <code>git-log</code></li></ol><h3 id="Git错误"><a href="#Git错误" class="headerlink" title="Git错误"></a>Git错误</h3><h4 id="错误1："><a href="#错误1：" class="headerlink" title="错误1："></a>错误1：</h4><p>​<code>error: git SSl certificate problem: unable to get local issuer certificate</code></p><p>​这个问题是由于没有配置信任的服务器HTTPS验证。默认，CURL被设为不信任任何CAS，就是说，它不信任任何服务器验证。只需要执行下面命令就可以解决：</p><p>​<code>git config --global http.sslVerify false</code></p><h4 id="错误2："><a href="#错误2：" class="headerlink" title="错误2："></a>错误2：</h4><p>​<code>error: RPC failed; curl 18 transfer closed with outstanding read data remaining</code></p><p>​<code>send-pack: unexpected disconnect while reading sideband packet</code></p><p>​<code>fatal: the remote end hung up unexpectedly</code></p><p>解决方法：</p><ol><li><p>缓存过小导致，可以尝试增大缓存 单位为byte, 524288000就是500M</p><p>​<code>git config --global http.postBuffer 524288000</code>  </p><p>百度查到说是的postBuffer默认值太小的原因，我看有人说调整到500M就行，但我试了不可以，所以就调整到了2G，有人成功了，是根据以下命令调整的</p><p>​<code>git config --global http.postBuffer 2024288000</code></p></li><li><p>网络波动导致，可以尝试取消相关的网络限制</p><p>​<code>git config --global http.lowSpeedLimit 0</code></p><p>​<code>git config --global http.lowSpeedTime 999999</code></p></li><li><p>若传输文件实在太大，可以尝试增大压缩率(压缩率大小根据实际情况设置),compression 是压缩的意思，从 clone 的终端输出就知道，服务器会压缩目标文件，然后传输到客户端，客户端再解压。取值为 [-1, 9]，-1 以 zlib 为默认压缩库，0 表示不进行压缩，1…9 是压缩速度与最终获得文件大小的不同程度的权衡，数字越大，压缩越慢，当然得到的文件会越小</p><p>​<code>git config --global core.compression 3</code></p></li><li><p>推送的文件大小太大了，超过了HTTP的限制，更换远程地址，改用git 协议来推送代码，这个最终成功了</p><p>​<code>git remote set-url origin git@github.com:wxydaydayup/BookPdf.git</code></p><p>​<code>git push -u origin master</code></p></li></ol><h2 id="Idea连接Github-x2F-Gitee"><a href="#Idea连接Github-x2F-Gitee" class="headerlink" title="Idea连接Github&#x2F;Gitee"></a>Idea连接Github&#x2F;Gitee</h2><ol><li><p>创建Tooken  <a href="https://github.com/settings/tokens/new">https://github.com/settings/tokens/new</a> 权限全部点上</p></li><li><p>VCS –&gt; Import into version Control –&gt; Create Git Repository </p></li><li><p>VCS –&gt; clone</p></li><li><p>设置SDK 与 配置maven</p><img src="/images/Git%E7%AC%94%E8%AE%B0/image-20221013151533015.png" alt="image-20221013151533015" style="zoom: 67%;" /><p>pom.xml 点击右键 -》Add as Maven Project</p></li><li><p>连接数据库</p><p>若出现错误：</p><p>​<code>Server returns invalid timezone. Go to &#39;Advanced&#39; tab and set &#39;serverTimezone&#39; property manually.</code></p><p>在Advanced设置一下时区即可</p><img src="/images/Git%E7%AC%94%E8%AE%B0/image-20221013154539389.png" alt="image-20221013154539389" style="zoom:67%;" /></li><li><p>IDEA集成GitBash作为Terminal（建议）</p><img src="/images/Git%E7%AC%94%E8%AE%B0/image-20221014095006382.png" alt="image-20221014095006382" style="zoom: 67%;" /><p>7、看看效果</p><img src="/images/Git%E7%AC%94%E8%AE%B0/image-20221014095334858.png" alt="image-20221014095334858" style="zoom: 50%;" /></li></ol><h2 id="Git合并拉取代码规范"><a href="#Git合并拉取代码规范" class="headerlink" title="Git合并拉取代码规范"></a>Git合并拉取代码规范</h2><ol><li>先拉取自己开发分支远端代码（适用多人共用一个开发分支）</li><li>测试完成后将自己开发代码提交到本地仓库，上传到自己的远端开发分支</li><li>换到master分支，拉取master远端的最新代码</li><li>确保本地master分支的代码为远端最新代码后，把开发分支合并到master分支</li><li>本地master分支代码上传到远端master</li></ol><h2 id="Github搜索技巧"><a href="#Github搜索技巧" class="headerlink" title="Github搜索技巧"></a>Github搜索技巧</h2><p>计算机图形学 in:name stars:&gt;100 language:java</p><p>计算机图形学 in:readme</p><p><a href="https://blog.csdn.net/zzzzlei123123123/article/details/105174595">Github删除自己的仓库</a></p>]]></content>
      
      
      <categories>
          
          <category> Git </category>
          
          <category> Github </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Git </tag>
            
            <tag> Github </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>pumpkin</title>
      <link href="/2022/10/21/pumpkin/"/>
      <url>/2022/10/21/pumpkin/</url>
      
        <content type="html"><![CDATA[<h2 id="数据结构"><a href="#数据结构" class="headerlink" title="数据结构"></a>数据结构</h2><h3 id="一、哈希表"><a href="#一、哈希表" class="headerlink" title="一、哈希表"></a>一、哈希表</h3><h4 id="1、哈希表构造散列表并求平均查找长度"><a href="#1、哈希表构造散列表并求平均查找长度" class="headerlink" title="1、哈希表构造散列表并求平均查找长度"></a>1、哈希表构造散列表并求平均查找长度</h4><p><strong>问题</strong></p><p>将关键字序列（7、8、30、11、18、9、14）散列存储到散列表中。散列表的存储空间是一个下标从0开始的一维数组，散列函数为： H(key) &#x3D; (key * 3) MOD 7，处理冲突采用线性探测再散列法，要求装填（载）因子为0.7。</p><p>（1）请画出所构造的散列表。</p><p>（2）分别计算等概率情况下查找成功和查找不成功的平均查找长度。</p><p><strong>解答</strong></p><p><strong>装载因子</strong>是指所有关键子填充哈希表后饱和的程度，它等于 <strong>填入表中的关键字总数&#x2F;哈希表的长度</strong>。根据题意，我们可以确定哈希表的长度为 L &#x3D; 7&#x2F;0.7 &#x3D; 10；因此此题需要构建的哈希表是<strong>下标为0~9</strong>的一维数组。查找不成功的次数就直接找关键字到下一个地址关键字为空的距离，但根据散列函数地址为<strong>MOD7</strong>，因此初始只可能在0~6的位置，</p><p>参考链接： <a href="https://blog.csdn.net/dyw_666666/article/details/110291968">哈希表查找</a></p><h2 id="操作系统"><a href="#操作系统" class="headerlink" title="操作系统"></a>操作系统</h2><h3 id="一、硬链接和软链接"><a href="#一、硬链接和软链接" class="headerlink" title="一、硬链接和软链接"></a>一、硬链接和软链接</h3><h4 id="1、硬链接和软链接引用区别"><a href="#1、硬链接和软链接引用区别" class="headerlink" title="1、硬链接和软链接引用区别"></a>1、硬链接和软链接引用区别</h4><p><strong>问题</strong></p><p>​设文件F1当前引用计数值为1，先建立F1的符号链接文件F2，再建立F1的硬链接文件F3，然后删除F1。此时，F2和F3的引用计数值分别是() 。</p><p>​当建立F2时，F1和F2的引用计数值都为1。当再建立F3时，F1和F3的引用计数值就都变成了2。当后来删除F1时，F3的引用计数值为2-1&#x3D;1。F2的引用计数值仍然保持不变。综上：F2的引用值为1，F3的引用值也为1。</p><p><strong>解答</strong></p><p>​记住结论就行，硬链接删除原文件减一，软链接删除原文件不变</p><p>​记住结论就行，硬链接删除原文件引用数减1，软链接删除原文件引用数不变</p><p>参考链接： <a href="https://blog.csdn.net/weixin_46264660/article/details/124763635">文件链接</a></p><h3 id="二、Raid"><a href="#二、Raid" class="headerlink" title="二、Raid"></a>二、Raid</h3><h4 id="1、Raid的实现方式"><a href="#1、Raid的实现方式" class="headerlink" title="1、Raid的实现方式"></a>1、Raid的实现方式</h4><p>有两种方法可以实现RAID</p><ul><li>一种是使用RAID控制器组建RAID，称为硬RAID</li><li>一种是直接用程序创建RAID，称为软RAID</li></ul><h3 id="三、缓冲技术"><a href="#三、缓冲技术" class="headerlink" title="三、缓冲技术"></a>三、缓冲技术</h3><h4 id="1、操作系统如何实现缓冲技术"><a href="#1、操作系统如何实现缓冲技术" class="headerlink" title="1、操作系统如何实现缓冲技术"></a>1、操作系统如何实现缓冲技术</h4><p>参考链接：<a href="https://blog.csdn.net/qq_44096670/article/details/121632471">操作系统如何实现缓冲技术</a></p><h2 id="计算机网络"><a href="#计算机网络" class="headerlink" title="计算机网络"></a>计算机网络</h2><h3 id="一、数据传输率"><a href="#一、数据传输率" class="headerlink" title="一、数据传输率"></a>一、数据传输率</h3><h4 id="1、给定带宽求数据传输率"><a href="#1、给定带宽求数据传输率" class="headerlink" title="1、给定带宽求数据传输率"></a>1、给定带宽求数据传输率</h4><p><strong>问题</strong></p><p>​一个带宽为4 KHz 的理想低通通道，其允许的最高码元传输速率为多少？</p><p>​采用8个相位，每相位取2种幅度值的调制技术，可以获得的数据传输率是多少？</p><p><strong>解答</strong></p><ul><li><p>数据传输速率：在数值上等于<strong>每秒传输构成数据代码的二进制比特数</strong>,单位为比特&#x2F;秒(bit&#x2F;second),记作bps.</p></li><li><p>信号传输速率：也称码元率、调制速率或波特率,表示<strong>单位时间内通过信道传输的码元个数</strong>,单位记做Baud.</p></li><li><p>信道容量：信道在单位时间内可以传输的最大信号量,表示信道的传输能力.信道容量有时也表示为<strong>单位时间内可传输的二进制位的位数（称信道的数据传输速率,位速率）</strong>,单位为位&#x2F;秒（b&#x2F;s）,简记为bps。</p></li></ul><p>因为公式 若信道带宽为W,则奈氏定理的最大码元速率为： B &#x3D; 2W （Baud）</p><p>所以带宽为4K的理想低通信道最大码元速率为：2 × 4000 &#x3D; 8000 （Baud）</p><p>因为采用8个相位，每相位取2种幅度值的调制技术</p><p>说明每个信号有2×8 &#x3D;16种变化，每个码元携带log(2, 16) &#x3D; 4比特的信息</p><p>所以最高数据传送速率  Rmax &#x3D; Bmax × n &#x3D; 8000 × 4 &#x3D; 32000(b&#x2F;s)</p><p>参考链接：</p><ul><li>​<a href="https://blog.csdn.net/yang_gang2017/article/details/78226155">求数据传输率</a></li><li>​<a href="https://blog.csdn.net/weixin_43336281/article/details/121486370">相位调制求码元携带信息</a></li></ul><h3 id="二、DNS工作原理"><a href="#二、DNS工作原理" class="headerlink" title="二、DNS工作原理"></a>二、DNS工作原理</h3><h4 id="1、DNS工作原理和递归迭代查询的过程"><a href="#1、DNS工作原理和递归迭代查询的过程" class="headerlink" title="1、DNS工作原理和递归迭代查询的过程"></a>1、DNS工作原理和递归迭代查询的过程</h4><ul><li>A1.A.com是主机</li><li>DNS.A.com是本地域名服务器</li><li>DNS.com是顶级域名服务器</li></ul><p>参考链接：</p><ul><li><a href="https://www.bilibili.com/video/BV1JZ4y1f7tU/?spm_id_from=333.337.search-card.all.click&vd_source=178669e0797f36fb015c5fc3cb9c7a4f">DNS的工作原理和递归迭代查询的过程</a></li></ul><h3 id="三、IP地址分类的意义"><a href="#三、IP地址分类的意义" class="headerlink" title="三、IP地址分类的意义"></a>三、IP地址分类的意义</h3><h4 id="1、IP地址分类的意义"><a href="#1、IP地址分类的意义" class="headerlink" title="1、IP地址分类的意义"></a>1、IP地址分类的意义</h4><p>为了方便对 IP 地址的管理，将 IP 地址基本分为三大类，每类地址的分类与含义如下：</p><ul><li>A 类：前 8 位表示网络 ID，后 24 位表示主机 ID；该地址分配给政府机关单位使用。</li><li>B 类：前 16 位表示网络 ID，后 16 位表示主机 ID；该地址分配给中等规模的企业使用。</li><li>C 类：前 24 位表示网络 ID，后 8 位表示主机 ID；该地址分配给任何需要的人使用。</li></ul><p>除了上述的 A、B、C 三类地址以外，还有两类隐藏地址，即 D 类地址和E类地址：</p><ul><li>D 类：不分网络 ID 和主机 ID；该地址用于多播。</li><li>E 类：不分网络 ID 和主机 ID；该地址用于实验。</li></ul><p>但现在来说IP地址分类已经没有什么意义：</p><img src="/images/pumpkin/image-20221110161732053.png"  style="zoom:50%;" /><p>这里原文也写出了当年划分ABCDE类的初衷: 使得路由表能够做的非常小, 路由器能够快速地处理网络转发，而现在CIDR消除了传统的A类、B类、C类地址、以及划分子网的概念。</p><p>参考链接：</p><ul><li><a href="http://c.biancheng.net/view/6407.html">IP地址的格式和分类 </a></li></ul><h2 id="C语言基础"><a href="#C语言基础" class="headerlink" title="C语言基础"></a>C语言基础</h2><h3 id="一、指针"><a href="#一、指针" class="headerlink" title="一、指针"></a>一、指针</h3><p>先说一个特殊的场景，就是在声明一个指针时候，是要加上星号的，比如：</p><pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">int *a &#x3D; NULL;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>这里的星号没别的意思，就是告诉编译器，a是个指针。而“&amp;”是一个取地址的运算符</p><pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">int a &#x3D; 1;printf(&quot;变量a自己的地址是:  %x\n&quot;, &amp;a);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>输出的结果是   22feb4  表示变量a存放的地址</p><p>用这个五个方面来说明指针：<strong>己址、己值、他值、他址、他型</strong></p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;bits/stdc++.h></span></span>using namespace std<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">int</span> <span class="token operator">*</span>a <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"指针变量a的地址是:  %x\n"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">int</span> b <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"指针变量b的地址是:  %x\n"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"---------------------------------\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>a <span class="token operator">=</span> <span class="token operator">&amp;</span>b<span class="token punctuation">;</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"指针变量a自己的地址是:  %x\n"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"指针变量a自己的值是:  %x\n"</span><span class="token punctuation">,</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"指针变量*a的值是:  %x\n"</span><span class="token punctuation">,</span><span class="token operator">*</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>运行结果</p><img src="/images/pumpkin/image-20221017094755194-1667797230202.png" style="zoom:80%;" /><ul><li><p>己址：表示自己真实的内存地址</p></li><li><p>己值：表示自己真实内存地址存放的值</p></li><li><p>他值：表示自己加*后可以取到自己真实内存地址存放的值</p></li><li><p>他址：表示自己真实内存地址存放的值就是他址</p></li><li><p>他型：表示声明指针时 int *a &#x3D; NULL; int是指针加星后要取的类型</p></li></ul><p>*和-&gt;的作用一样 都是用来获取他值</p><p>符号<code>.和-&gt;</code>的作用和区别</p><ol><li>A.B则A为对象或者结构体； 点号（.）：左边必须为实体。</li><li>A-&gt;B则A为指针，-&gt;是成员提取，A-&gt;B是提取A中的成员B， <strong>箭头（-&gt;）：左边必须为指针；</strong></li></ol><h3 id="二、循环链表模拟队列"><a href="#二、循环链表模拟队列" class="headerlink" title="二、循环链表模拟队列"></a>二、循环链表模拟队列</h3><h4 id="1、循环链表模拟队列"><a href="#1、循环链表模拟队列" class="headerlink" title="1、循环链表模拟队列"></a>1、循环链表模拟队列</h4><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;bits/stdc++.h></span></span>using namespace std<span class="token punctuation">;</span><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">Node</span><span class="token punctuation">&#123;</span><span class="token keyword">int</span> data<span class="token punctuation">;</span><span class="token keyword">struct</span> <span class="token class-name">Node</span> <span class="token operator">*</span>next<span class="token punctuation">;</span><span class="token punctuation">&#125;</span>LinkQueueNode<span class="token punctuation">,</span><span class="token operator">*</span>LinkQueue<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">InitLinkQueue</span><span class="token punctuation">(</span>LinkQueue <span class="token operator">&amp;</span>LQ<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>LQ <span class="token operator">=</span> <span class="token punctuation">(</span>LinkQueue<span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>LinkQueueNode<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span>LQ <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>LQ<span class="token operator">-></span>next <span class="token operator">=</span> LQ<span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">int</span> <span class="token function">EnterQueue</span><span class="token punctuation">(</span>LinkQueue <span class="token operator">&amp;</span>LQ<span class="token punctuation">,</span><span class="token keyword">int</span> x<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>LinkQueue temp <span class="token operator">=</span> <span class="token punctuation">(</span>LinkQueueNode<span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>LinkQueueNode<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>temp<span class="token operator">-></span>data <span class="token operator">=</span> x<span class="token punctuation">;</span>temp<span class="token operator">-></span>next <span class="token operator">=</span> LQ<span class="token operator">-></span>next<span class="token punctuation">;</span>LQ<span class="token operator">-></span>next <span class="token operator">=</span> temp<span class="token punctuation">;</span>LQ <span class="token operator">=</span> temp<span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">DeleteQueue</span><span class="token punctuation">(</span>LinkQueue <span class="token operator">&amp;</span>LQ<span class="token punctuation">,</span><span class="token keyword">int</span> <span class="token operator">&amp;</span>x<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">if</span><span class="token punctuation">(</span>LQ<span class="token operator">-></span>next <span class="token operator">==</span> LQ<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>LinkQueue temp <span class="token operator">=</span> LQ<span class="token operator">-></span>next<span class="token operator">-></span>next<span class="token punctuation">;</span><span class="token comment">//if(LQ == temp) LQ = temp->next;</span>LQ<span class="token operator">-></span>next<span class="token operator">-></span>next <span class="token operator">=</span> temp<span class="token operator">-></span>next<span class="token punctuation">;</span>x <span class="token operator">=</span> temp<span class="token operator">-></span>data<span class="token punctuation">;</span><span class="token function">free</span><span class="token punctuation">(</span>temp<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">forQueue</span><span class="token punctuation">(</span>LinkQueue LQ<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>LinkQueue head <span class="token operator">=</span> LQ<span class="token punctuation">;</span>LinkQueue q <span class="token operator">=</span> head<span class="token operator">-></span>next<span class="token punctuation">;</span> <span class="token keyword">while</span><span class="token punctuation">(</span>head <span class="token operator">!=</span> q<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>cout<span class="token operator">&lt;&lt;</span> q<span class="token operator">-></span>data <span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>q <span class="token operator">=</span> q<span class="token operator">-></span>next<span class="token punctuation">;</span><span class="token punctuation">&#125;</span> cout<span class="token operator">&lt;&lt;</span>head<span class="token operator">-></span>data<span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>LinkQueue LQ<span class="token punctuation">;</span><span class="token function">InitLinkQueue</span><span class="token punctuation">(</span>LQ<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">EnterQueue</span><span class="token punctuation">(</span>LQ<span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">EnterQueue</span><span class="token punctuation">(</span>LQ<span class="token punctuation">,</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">EnterQueue</span><span class="token punctuation">(</span>LQ<span class="token punctuation">,</span><span class="token number">300</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">forQueue</span><span class="token punctuation">(</span>LQ<span class="token punctuation">)</span><span class="token punctuation">;</span>cout<span class="token operator">&lt;&lt;</span><span class="token string">"-----------------"</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span> <span class="token keyword">int</span> x<span class="token punctuation">;</span> <span class="token function">DeleteQueue</span><span class="token punctuation">(</span>LQ<span class="token punctuation">,</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">DeleteQueue</span><span class="token punctuation">(</span>LQ<span class="token punctuation">,</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">DeleteQueue</span><span class="token punctuation">(</span>LQ<span class="token punctuation">,</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">forQueue</span><span class="token punctuation">(</span>LQ<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>运行结果：</p><img src="/images/pumpkin/image-20221109162320579.png" alt="循环链表模拟队列删除结果" style="zoom: 50%;" /><h3 id="三、判断数字序列的出栈顺序是否合法"><a href="#三、判断数字序列的出栈顺序是否合法" class="headerlink" title="三、判断数字序列的出栈顺序是否合法"></a>三、判断数字序列的出栈顺序是否合法</h3><h4 id="1、思路如下"><a href="#1、思路如下" class="headerlink" title="1、思路如下"></a>1、思路如下</h4><p>左边为模拟栈,  右边为题目给定数字序列</p><p>(1) 模拟栈给定序列的栈顶数字<strong>不等于</strong>题目所给的数字序列的开头时，数字进入。</p><p>(2) 模拟栈中的栈顶数字<strong>等于</strong>题目所给的数字序列的开头时，模拟栈和数字序列的首数字同时出栈;</p><p>之后，再进行下一个数字的比较，反复1、2过程。</p><p>(3) 当题目所给的数字序列全部入栈后，判断模拟栈中的元素是否为空</p><ul><li>若为空，说明数字序列合法</li><li>若不为空，说明数字序列不合法</li></ul><h4 id="2、模拟过程如下"><a href="#2、模拟过程如下" class="headerlink" title="2、模拟过程如下"></a>2、模拟过程如下</h4><img src="/images/pumpkin/image-20221110210029217.png" alt="步骤一" style="zoom:40%;box-shadow:rgba(0,0,0,0) 0 1px 5px 0px;" /><img src="/images/pumpkin/image-20221110210311559.png" alt="步骤二" style="zoom:40%;box-shadow:rgba(0,0,0,0) 0 1px 5px 0px;"/><img src="/images/pumpkin/image-20221110210427565.png" alt="步骤三" style="zoom:40%;box-shadow:rgba(0,0,0,0) 0 1px 5px 0px;" /><img src="/images/pumpkin/image-20221110210503465.png" alt="步骤四" style="zoom:40%;box-shadow:rgba(0,0,0,0) 0 1px 5px 0px;" /><img src="/images/pumpkin/image-20221110210527942.png" alt="步骤五" style="zoom:40%;box-shadow:rgba(0,0,0,0) 0 1px 5px 0px;" /><h4 id="3、代码如下"><a href="#3、代码如下" class="headerlink" title="3、代码如下"></a>3、代码如下</h4><p>给定输出顺序用栈存可以,用队列存储也可以，下列代码是用栈存储，C++实现。</p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;bits/stdc++.h></span></span>using namespace std<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>stack<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> inputStack<span class="token punctuation">,</span>s<span class="token punctuation">;</span><span class="token keyword">int</span> a<span class="token punctuation">;</span><span class="token keyword">while</span><span class="token punctuation">(</span>cin<span class="token operator">>></span>a<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">if</span><span class="token punctuation">(</span>a <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">break</span><span class="token punctuation">;</span>inputStack<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">int</span> n <span class="token operator">=</span> inputStack<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>s<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">while</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span><span class="token number">0</span> <span class="token operator">&amp;&amp;</span> inputStack<span class="token punctuation">.</span><span class="token function">top</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> s<span class="token punctuation">.</span><span class="token function">top</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>s<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>inputStack<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span> <span class="token punctuation">)</span> cout<span class="token operator">&lt;&lt;</span><span class="token string">"不合法"</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span> <span class="token keyword">else</span> cout<span class="token operator">&lt;&lt;</span><span class="token string">"合法"</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>C语言实现，用数组模拟栈，相关题目  <a href="https://pintia.cn/problem-sets/988034414048743424/exam/problems/988038770777137152"> 出栈序列的合法性</a></p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;stdio.h></span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">int</span> m<span class="token punctuation">,</span>n<span class="token punctuation">,</span>k<span class="token punctuation">;</span>    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d %d %d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>m<span class="token punctuation">,</span> <span class="token operator">&amp;</span>n<span class="token punctuation">,</span> <span class="token operator">&amp;</span>k<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> stack<span class="token punctuation">[</span><span class="token number">1010</span><span class="token punctuation">]</span><span class="token punctuation">;</span>       <span class="token comment">//栈 </span><span class="token keyword">int</span> b<span class="token punctuation">[</span><span class="token number">1010</span><span class="token punctuation">]</span><span class="token punctuation">;</span>           <span class="token comment">//存放出栈序列 </span>    <span class="token keyword">while</span><span class="token punctuation">(</span>k<span class="token operator">--</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> flag <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> index1 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> index2 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> top <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>     <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>b<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">while</span><span class="token punctuation">(</span>true<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token comment">//判断给出的出栈序列如果和1到n增长顺序相同，则出栈</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>index1 <span class="token operator">==</span> b<span class="token punctuation">[</span>index2<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    index1<span class="token operator">++</span><span class="token punctuation">;</span>    index2<span class="token operator">++</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>            <span class="token comment">//判断如果栈中有元素，然后栈顶元素也与此时的出栈序列元素相同，则出栈</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>top <span class="token operator">!=</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> stack<span class="token punctuation">[</span>top <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> b<span class="token punctuation">[</span>index2<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>top<span class="token operator">--</span><span class="token punctuation">;</span>index2<span class="token operator">++</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span><span class="token keyword">if</span><span class="token punctuation">(</span>index1 <span class="token operator">></span> n<span class="token punctuation">)</span> <span class="token keyword">break</span><span class="token punctuation">;</span>  <span class="token comment">//已经判断结束，就跳出循环 </span>stack<span class="token punctuation">[</span>top<span class="token punctuation">]</span> <span class="token operator">=</span> index1<span class="token punctuation">;</span>  <span class="token comment">//元素入栈 </span>top<span class="token operator">++</span><span class="token punctuation">;</span>index1<span class="token operator">++</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span>top <span class="token operator">>=</span> m<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>flag <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">break</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span>flag <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">||</span> top <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"NO\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">else</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"YES\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>107.0.1418.35</p>]]></content>
      
      
      <categories>
          
          <category> 生活 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 生活 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>剑指offer</title>
      <link href="/2022/01/08/%E5%89%91%E6%8C%87offer/"/>
      <url>/2022/01/08/%E5%89%91%E6%8C%87offer/</url>
      
        <content type="html"><![CDATA[<h2 id="剑指Offer-链表中环的入口节点"><a href="#剑指Offer-链表中环的入口节点" class="headerlink" title="剑指Offer_链表中环的入口节点"></a>剑指Offer_链表中环的入口节点</h2><h3 id="相关链接"><a href="#相关链接" class="headerlink" title="相关链接"></a>相关链接</h3><p><a href="https://leetcode.cn/problems/c32eOV/description/">剑指 Offer II 022. 链表中环的入口节点</a></p><h3 id="相关题目"><a href="#相关题目" class="headerlink" title="相关题目"></a>相关题目</h3><p>给定一个链表，返回链表开始入环的第一个节点。 从链表的头节点开始沿着 next 指针进入环的第一个节点为环的入口节点。如果链表无环，则返回 null。为了表示给定链表中的环，我们使用整数 pos 来表示链表尾连接到链表中的位置（索引从 0 开始）。 如果 pos 是 -1，则在该链表中没有环。注意，pos 仅仅是用于标识环的情况，并不会作为参数传递到函数中。</p><p>说明：不允许修改给定的链表。</p><p><strong>示例 1：</strong></p><img src="https://assets.leetcode-cn.com/aliyun-lc-upload/uploads/2018/12/07/circularlinkedlist.png" style="zoom: 45%; box-shadow: rgba(0, 0, 0, 0) 0px 1px 5px 0px;" /><pre class="line-numbers language-none"><code class="language-none">输入：head &#x3D; [3,2,0,-4], pos &#x3D; 1输出：返回索引为 1 的链表节点解释：链表中有一个环，其尾部连接到第二个节点。<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><strong>示例 2：</strong></p><img src="https://assets.leetcode-cn.com/aliyun-lc-upload/uploads/2018/12/07/circularlinkedlist_test2.png" style="zoom: 67%; box-shadow: rgba(0, 0, 0, 0) 0px 1px 5px 0px;"/><pre class="line-numbers language-none"><code class="language-none">输入：head &#x3D; [1,2], pos &#x3D; 0输出：返回索引为 0 的链表节点解释：链表中有一个环，其尾部连接到第一个节点。<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h3 id="解题思路"><a href="#解题思路" class="headerlink" title="解题思路"></a>解题思路</h3><p>此题使用快慢指针，如果存在环，快慢指针一定会相遇，而此时<code>快慢指针相遇的位置</code> &#x3D; <code>从相遇点到入环点的距离加上 n-1 圈的环长</code>。之后可以使慢指针与表头同时出发，相遇的位置就是环的入口。</p><pre class="line-numbers language-c" data-language="c"><code class="language-c">class Solution <span class="token punctuation">&#123;</span>public<span class="token operator">:</span>    ListNode <span class="token operator">*</span><span class="token function">detectCycle</span><span class="token punctuation">(</span>ListNode <span class="token operator">*</span>head<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">auto</span> fast <span class="token operator">=</span> head<span class="token punctuation">,</span> slow <span class="token operator">=</span> head<span class="token punctuation">;</span>        <span class="token keyword">while</span><span class="token punctuation">(</span>fast<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>fast<span class="token operator">-></span>next <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>            fast <span class="token operator">=</span> fast<span class="token operator">-></span>next<span class="token operator">-></span>next<span class="token punctuation">;</span>            slow <span class="token operator">=</span> slow<span class="token operator">-></span>next<span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>fast <span class="token operator">==</span> slow<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">auto</span> p <span class="token operator">=</span> head<span class="token punctuation">;</span>                <span class="token keyword">while</span><span class="token punctuation">(</span>p <span class="token operator">!=</span> slow<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                    p <span class="token operator">=</span> p<span class="token operator">-></span>next<span class="token punctuation">;</span>                    slow <span class="token operator">=</span> slow<span class="token operator">-></span>next<span class="token punctuation">;</span>                     <span class="token punctuation">&#125;</span>                <span class="token keyword">return</span> slow<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>证明如下：</strong></p><img src="https://assets.leetcode-cn.com/solution-static/jianzhi_II_022/jianzhi_II_022_fig1.png" alt="证明图" style="zoom: 23%;box-shadow:rgba(0,0,0,0) 0 1px 5px 0px;"  /><blockquote><p>设链表中 <strong>环外</strong> 部分的长度为 a。slow 指针进入环后，又走了 b 的距离与fast 相遇。</p><p>所以慢指针走过的距离为<code>a + b</code></p><p>此时，fast 指针已经走完了环的 n 圈，因此它走过的总距离为 <code>a + n(b+c) + b </code></p><p>fast 指针走过的路程又等于慢指针的2倍，所以  <code>a + n(b+c) + b  </code>&#x3D;<code>2 * (a + b)</code></p><p>可化简为 <code> a = c + (n−1)(b+c)</code>,根据公式结合图像可以看出 <code>快慢指针相遇的位置</code> &#x3D; <code>从相遇点到入环点的距离加上 n-1 圈的环长</code></p></blockquote><h2 id="剑指Offer-两个链表的第一个重合节点"><a href="#剑指Offer-两个链表的第一个重合节点" class="headerlink" title="剑指Offer_两个链表的第一个重合节点"></a>剑指Offer_两个链表的第一个重合节点</h2><h3 id="相关链接-1"><a href="#相关链接-1" class="headerlink" title="相关链接"></a>相关链接</h3><ul><li><a href="https://leetcode.cn/problems/3u1WK4/description/">剑指 Offer II 023. 两个链表的第一个重合节点 </a></li></ul><h3 id="相关题目-1"><a href="#相关题目-1" class="headerlink" title="相关题目"></a>相关题目</h3><p>给定两个单链表的头节点 <code>headA</code> 和 <code>headB</code> ，请找出并返回两个单链表相交的起始节点。如果两个链表没有交点，返回 <code>null</code> 。图示两个链表在节点 <code>c1</code> 开始相交<strong>：</strong></p><p><a href="https://assets.leetcode-cn.com/aliyun-lc-upload/uploads/2018/12/14/160_statement.png"><img src="https://assets.leetcode-cn.com/aliyun-lc-upload/uploads/2018/12/14/160_statement.png"  style="zoom: 45%; box-shadow: rgba(0, 0, 0, 0) 0px 1px 5px 0px;" /></a></p><p>题目数据保证整个链式结构中不存在环。注意，函数返回结果后，链表必须保持其原始结构 。 </p><p><strong>示例 1：</strong></p><p><a href="https://assets.leetcode.com/uploads/2018/12/13/160_example_1.png"><img src="https://assets.leetcode-cn.com/aliyun-lc-upload/uploads/2018/12/14/160_example_1.png"  style="zoom:40%;box-shadow:rgba(0,0,0,0) 0 1px 5px 0px;" /></a></p><pre class="line-numbers language-C" data-language="C"><code class="language-C">输入：listA &#x3D; [4,1,8,4,5], listB &#x3D; [5,0,1,8,4,5]输出：Intersected at &#39;8&#39;解释：相交节点的值为 8 （注意，如果两个链表相交则不能为 0）。从各自的表头开始算起，链表 A 为 [4,1,8,4,5]，链表 B 为 [5,0,1,8,4,5]。在 A 中，相交节点前有 2 个节点；在 B 中，相交节点前有 3 个节点。<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>示例 3：</strong></p><p><a href="https://assets.leetcode.com/uploads/2018/12/13/160_example_3.png"><img src="https://assets.leetcode-cn.com/aliyun-lc-upload/uploads/2018/12/14/160_example_3.png" style="zoom:45%;box-shadow:rgba(0,0,0,0) 0 1px 5px 0px;" /></a></p><pre class="line-numbers language-c" data-language="c"><code class="language-c">输入：listA <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> listB <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span>输出：null解释：从各自的表头开始算起，链表 A 为 <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">]</span>，链表 B 为 <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span>。由于这两个链表不相交，所以 intersectVal 必须为 <span class="token number">0</span>这两个链表不相交，因此返回 null 。<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="解题思路-1"><a href="#解题思路-1" class="headerlink" title="解题思路"></a>解题思路</h3><p>经典环的入口类问题，从A出发再走B的路程，和从B出发再走A的路程是距离是一样。可以根据这个特性求出链表重合的节点。</p><pre class="line-numbers language-c" data-language="c"><code class="language-c">class Solution <span class="token punctuation">&#123;</span>public<span class="token operator">:</span>    ListNode <span class="token operator">*</span><span class="token function">getIntersectionNode</span><span class="token punctuation">(</span>ListNode <span class="token operator">*</span>headA<span class="token punctuation">,</span> ListNode <span class="token operator">*</span>headB<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>headA <span class="token operator">==</span> nullptr <span class="token operator">||</span> headB <span class="token operator">==</span> nullptr<span class="token punctuation">)</span> <span class="token keyword">return</span> nullptr<span class="token punctuation">;</span>        <span class="token keyword">auto</span> p1 <span class="token operator">=</span> headA<span class="token punctuation">,</span> p2 <span class="token operator">=</span> headB<span class="token punctuation">;</span>        <span class="token keyword">while</span><span class="token punctuation">(</span>p1 <span class="token operator">!=</span> p2<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            p1 <span class="token operator">=</span> p1 <span class="token operator">==</span> nullptr <span class="token operator">?</span> headB <span class="token operator">:</span> p1<span class="token operator">-></span>next<span class="token punctuation">;</span>             p2 <span class="token operator">=</span> p2 <span class="token operator">==</span> nullptr <span class="token operator">?</span> headA <span class="token operator">:</span> p2<span class="token operator">-></span>next<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> p1<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> 算法 </category>
          
          <category> C++ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 算法 </tag>
            
            <tag> C++ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Java基础</title>
      <link href="/2021/12/08/Java%E5%9F%BA%E7%A1%80/"/>
      <url>/2021/12/08/Java%E5%9F%BA%E7%A1%80/</url>
      
        <content type="html"><![CDATA[<h1 id="Java基础"><a href="#Java基础" class="headerlink" title="Java基础"></a>Java基础</h1><h2 id="语言基础"><a href="#语言基础" class="headerlink" title="语言基础"></a>语言基础</h2><h3 id="一、跨平台原理"><a href="#一、跨平台原理" class="headerlink" title="一、跨平台原理"></a>一、跨平台原理</h3><p>Java要在不同的操作系统上运行，需要在操作系统上安装对应的Java虚拟机</p><h4 id="1、JRE（Java-Runtime-Environment）"><a href="#1、JRE（Java-Runtime-Environment）" class="headerlink" title="1、JRE（Java Runtime Environment）:"></a>1、JRE（Java Runtime Environment）:</h4><p>Java<strong>程序运行时的环境</strong>，包含jvm和需要的核心类库，要运行一个<strong>已有</strong>的java程序，只需安装JRE即可</p><h4 id="2、JDK（Java-Development-Kit"><a href="#2、JDK（Java-Development-Kit" class="headerlink" title="2、JDK（Java Development Kit)"></a>2、JDK（Java Development Kit)</h4><p>Java程序开发工具包，<strong>包含JRE和开发人员使用的工具</strong></p><p>开发工具：编译工具javac.exe和运行工具java.exe</p><p>想要开发一个java程序，必须安装jdk</p><h4 id="3、包含关系"><a href="#3、包含关系" class="headerlink" title="3、包含关系"></a>3、包含关系</h4><img src="/images/Java%E5%9F%BA%E7%A1%80/image-20221117193413007.png" alt="包含关系" style="zoom:20%;box-shadow:rgba(0,0,0,0) 0 1px 5px 0px;" /><h3 id="一、基础语法"><a href="#一、基础语法" class="headerlink" title="一、基础语法"></a>一、基础语法</h3><h4 id="1、标识符"><a href="#1、标识符" class="headerlink" title="1、标识符"></a>1、标识符</h4><p>Java中 的标识符由字母（包括汉字在内的各个国家的文字），下划线，数字，美元符号（$）组成<br>规则：</p><ol><li>标识符首字母不能是数字</li><li>关键字不能作为标识符</li><li>布尔常量true和false不能作为标识符</li><li>null不能作为标识符</li></ol><p>规范：<br>类名和接口名：首字母大写，后面每个单词的首字母大写<br>变量名和方法名：首字母小写，后面每个单词的首字母大写<br>常量名：全部大写，并且单词和单词之间用下划线衔接</p><h4 id="2、关键字"><a href="#2、关键字" class="headerlink" title="2、关键字"></a>2、关键字</h4><p>在Java中被赋予特殊含义的单词符号！<br>如new，abstract，switch，if，do 等等。。这部分不用特殊记忆，以后会慢慢记住！</p><h4 id="3、注释"><a href="#3、注释" class="headerlink" title="3、注释"></a>3、注释</h4><p>（1）单行注释：写在一行的开始    格式：&#x2F;&#x2F;</p><p>（2）多行注释：多行注释可以写多行也能写一行     格式：  &#x2F;*   …* &#x2F;</p><p>（3）文档注释：Java的文档生成器可以扫描Java的语言程序，提取文档注释，生成Java的帮助文档。     格式： &#x2F;**……*&#x2F;</p><h4 id="4、常量与变量"><a href="#4、常量与变量" class="headerlink" title="4、常量与变量"></a>4、常量与变量</h4><p>Java语言的变量在编译时确定其类型，变量分为两种：一是常用数据类型变量，二是引用类型变量。引用类型变量实质上是一个对象，有其属性和方法！根据声明变量的位置不同,又可以将变量分为类属性变量和布局变量，类属性变量在类中申明，而局部变量在程序块中声明！<br><strong>各个易混变量的区分：</strong></p><ol><li>区分全局变量和局部变量<br>全局变量：描述对象有什么（在类中定义），类中所有方法都可以使用。<br>局部变量：临时保存数据（在类的方法中定义），只能在当前方法中使用。</li><li>区分成员变量和局部变量<br>成员变量：对象的属性称为成员变量，在成员方法中定义一个变量，那么这个变量就被称为局部变量。<br>局部变量仅在方法中有效，而成员变量在整个类中都有效，成员变量比局部变量的范围大，简记为成（橙）大局（橘）小！</li></ol><p>在方法中如果局部变量和成员变量名字相同，则成员方法在这个方法中暂时失效，如果需要引用成员变量，则需要引用this关键字 。</p><p>引用变量：实质就是一个对象，有其对应的属性和方法。</p><p>实例变量：不使用修饰词static的类变量。</p><p>成员变量：对象的属性称为成员变量，在成员方法中定义一个变量，那么这个变量就被称为局部变量。</p><h4 id="5、运算符"><a href="#5、运算符" class="headerlink" title="5、运算符"></a>5、运算符</h4><p>同一优先级的运算符，运算次序由结合方向所决定。<br>总的来说：！ &gt; 算术运算符 &gt; 关系运算符 &gt; &amp;&amp; &gt; || &gt; 赋值运算符</p><table><thead><tr><th>运算符</th><th>结合性</th></tr></thead><tbody><tr><td>[ ] . ( ) (方法调用)</td><td>从左向右</td></tr><tr><td>! ~ ++ – +(一元运算) -(一元运算)</td><td>从右向左</td></tr><tr><td>* &#x2F; %</td><td>从左向右</td></tr><tr><td>+ -</td><td>从左向右</td></tr><tr><td>&lt;&lt; &gt;&gt; &gt;&gt;&gt;</td><td>从左向右</td></tr><tr><td>&lt; &lt;&#x3D; &gt; &gt;&#x3D; instanceof</td><td>从左向右</td></tr><tr><td>&#x3D;&#x3D; !&#x3D;</td><td>从左向右</td></tr><tr><td>&amp;</td><td>从左向右</td></tr><tr><td>^</td><td>从左向右</td></tr><tr><td>&amp;&amp;</td><td>从左向右</td></tr><tr><td>?:</td><td>从右向左</td></tr><tr><td>&#x3D;</td><td>从右向左</td></tr></tbody></table><h4 id="6、基本的控制结构"><a href="#6、基本的控制结构" class="headerlink" title="6、基本的控制结构"></a>6、基本的控制结构</h4><p><strong>分支结构</strong></p><p>（1）if-else条件语句：</p><p>单分支</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">if<span class="token punctuation">(</span>条件<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    //条件成立要执行的代码<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p> 双分支</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">if<span class="token punctuation">(</span>条件<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  //条件成立要执行的代码<span class="token punctuation">&#125;</span>else<span class="token punctuation">&#123;</span>   //条件不成立要执行的代码<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>多重分支</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">if<span class="token punctuation">(</span>条件<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    //条件成立要执行的代码 <span class="token punctuation">&#125;</span><span class="token keyword">else</span> if<span class="token punctuation">(</span>条件2<span class="token punctuation">)</span><span class="token punctuation">&#123;</span> <span class="token punctuation">&#125;</span><span class="token keyword">else</span> if<span class="token punctuation">(</span>条件3<span class="token punctuation">)</span><span class="token punctuation">&#123;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">..</span><span class="token punctuation">..</span>else<span class="token punctuation">&#123;</span>    //条件不成立要执行的代码<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>（2）switch条件语句：</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">switch</span><span class="token punctuation">(</span>变量或表达式<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>       <span class="token keyword">case</span> 常量<span class="token number">1</span><span class="token operator">:</span>语句<span class="token number">1</span><span class="token punctuation">;</span><span class="token keyword">break</span><span class="token punctuation">;</span>       <span class="token keyword">case</span> 常量<span class="token number">2</span><span class="token operator">:</span>语句<span class="token number">2</span><span class="token punctuation">;</span><span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>      <span class="token keyword">default</span><span class="token operator">:</span>语句n<span class="token punctuation">;</span><span class="token keyword">break</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>switch语句中的注意点</strong></p><p>​在switch语句中的每个case分支的动作都是以break语句作为结束的，这里的break语句用来终止switch语句，如果没有break语句，程序就会继续下一个case分支中的动作，直到碰break语句为止！否则一直执行到switch 语句的末尾为止!<br> switch语句中的控制表达式必须是char，int，short，或byte类型的，case后面的常量表达式的类型必须与控制表达式的类型相同！</p><p><strong>循环结构</strong></p><p>（1）while循环语句</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">while<span class="token punctuation">(</span>布尔表达式<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>//如果判断为真，则重复执行循环体语句，否则退出循环 循环体　<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>（2）do-while循环语句</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">do<span class="token punctuation">&#123;</span>　　　　循环体<span class="token punctuation">&#125;</span>while<span class="token punctuation">(</span>布尔表达式<span class="token punctuation">)</span><span class="token punctuation">;</span> //如果为判断为真，则重复执行循环体语句，否则退出循环<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>（3）for循环语句</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">for<span class="token punctuation">(</span>循环变量初始化<span class="token punctuation">;</span>循环条件<span class="token punctuation">;</span>循环变量更新<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>　　//循环操作<span class="token punctuation">&#125;</span>//例如 <span class="token keyword">for</span> <span class="token punctuation">(</span>int <span class="token assign-left variable">i</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">10</span><span class="token punctuation">;</span>i++<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>跳转语句</strong></p><p><strong>需要特别注意的是java中不支持goto语句！</strong></p><p>（1）break：它可以和while循环和do-while循环或for循环一起使用，break语句可以强迫程序终止循环，当程序执行到break语句时，即终止循环，继续执行循环外的下一条语句，如果break语句出现在嵌套循环中的内层循环中，则break只会终止其所在当前层的循环，如果break语句位于一个循环内的switch语句中，那么break语句只会终止switch语句而不会终止循环。</p><p>（2）continue：可以强迫程序跳到循环的起始处，当程序运行到continue语句时，即会停止运行剩下的循环主体，而是会回到循环的开始出继续运行。</p><p>break和continue的区别在于，continue仅仅是结束本次循环，而break直接退出了这个循环体。</p><h3 id="二、异常"><a href="#二、异常" class="headerlink" title="二、异常"></a>二、异常</h3><h4 id="1、异常的架构"><a href="#1、异常的架构" class="headerlink" title="1、异常的架构"></a>1、异常的架构</h4><pre class="line-numbers language-java" data-language="java"><code class="language-java">        <span class="token class-name">Object</span>  顶级父类             <span class="token operator">|</span>       <span class="token class-name">Throwable</span> 异常父类       <span class="token operator">|</span>           <span class="token operator">|</span>  <span class="token class-name">Exception</span> 异常    <span class="token class-name">Error</span>错误<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="2、throw和throws方法"><a href="#2、throw和throws方法" class="headerlink" title="2、throw和throws方法"></a>2、throw和throws方法</h4><p><code>throw</code> 是用在某个方法的方法体内的，当我们认定某种情况不合理时，就可以创建异常对象，封装好异常信息，然后通过 <code>throw</code> 来抛出异常并终止该方法。</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>     <span class="token class-name">String</span> s <span class="token operator">=</span> <span class="token string">"abc"</span><span class="token punctuation">;</span>     <span class="token keyword">if</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">"abc"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>       <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">NumberFormatException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>       <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token punctuation">&#125;</span> <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>而 <code>throws</code> 是用在某个方法的方法声明上的，<code>throws</code>声明的异常不一定会出现，只是一种可能。当某个方法可能会抛出某种异常时用于声明可能抛出的异常，然后交给上层调用它的方法程序处理</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token function">testThrows</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">NumberFormatException</span> <span class="token punctuation">&#123;</span>         <span class="token class-name">String</span> s <span class="token operator">=</span> <span class="token string">"abc"</span><span class="token punctuation">;</span>         <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Double</span><span class="token punctuation">.</span><span class="token function">parseDouble</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token punctuation">&#125;</span>     <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>         <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>             testThrows<span class="token punctuation">.</span><span class="token function">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">NumberFormatException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>             <span class="token class-name">System</span><span class="token punctuation">.</span>err<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"非数据类型不能强制类型转换。"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token punctuation">&#125;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="面向对象"><a href="#面向对象" class="headerlink" title="面向对象"></a>面向对象</h2><h3 id="一、方法"><a href="#一、方法" class="headerlink" title="一、方法"></a>一、方法</h3><h4 id="1、参数的注意事项："><a href="#1、参数的注意事项：" class="headerlink" title="1、参数的注意事项："></a>1、参数的注意事项：</h4><ul><li><p>定义形参时，必须带上类型</p></li><li><p>调用时，实参的类型，数量必须与形参一致</p></li></ul><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">getMax</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h4 id="2、带返回值的方式定义"><a href="#2、带返回值的方式定义" class="headerlink" title="2、带返回值的方式定义"></a>2、带返回值的方式定义</h4><p>public static 后面的类型要与返回值一致</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">getMax</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">return</span> a<span class="token operator">+</span>b<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><ul><li><p>方法不能嵌套</p></li><li><p>void表示无返回值，可省略return，但是写了return不能跟数据</p></li></ul><h4 id="3、方法重载"><a href="#3、方法重载" class="headerlink" title="3、方法重载"></a>3、方法重载</h4><p>同一个类中，具有以下特征</p><ul><li>相同的方法名；</li><li>参数数量或类型不同；</li><li>与返回值无关；</li></ul><p><strong>方法参数类型问题</strong></p><p>1、给方法传入基本类型，在方法中改变基本类型值，对原值无影响</p><p>2、给方法传入引用类型，方法中修改引用类型值，原值受到影响，原因是引用类型实际上是一个地址</p><h3 id="二、类"><a href="#二、类" class="headerlink" title="二、类"></a>二、类</h3><h4 id="1、类的概念"><a href="#1、类的概念" class="headerlink" title="1、类的概念"></a>1、类的概念</h4><p>概念：类是对现实生活中一类具有共同属性和行为的抽象，用来确定对象将会有的属性和行为，类是对象的抽象，对象是类的实体</p><p>类的重要性：类是Java程序的基本组成单位</p><p>类的组成：类有属性和行为</p><ul><li><p>属性：在类中通过<strong>成员变量</strong>来体现（类中方法外的变量）</p></li><li><p>行为：在类中通过成员方法来体现（去掉static的方法）</p></li></ul><p>下面是一个手机类</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Phone</span> <span class="token punctuation">&#123;</span>        <span class="token comment">//成员变量    </span>    <span class="token class-name">String</span> <span class="token class-name">Brand</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> price<span class="token punctuation">;</span>        <span class="token comment">//成员方法    </span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"打电话"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">sendMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"发消息"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="2、成员变量和局部变量"><a href="#2、成员变量和局部变量" class="headerlink" title="2、成员变量和局部变量"></a>2、成员变量和局部变量</h4><p>成员变量是在类中方法外定义的变量，局部变量是在方法内定义的变量，区别：</p><img src="/images/Java%E5%9F%BA%E7%A1%80/image-20221116193647396.png" alt="成员变量和成员方法" style="zoom: 33%;box-shadow:rgba(0,0,0,0) 0 1px 5px 0px;" /><h3 id="三、封装"><a href="#三、封装" class="headerlink" title="三、封装"></a>三、封装</h3><h4 id="1、private关键字"><a href="#1、private关键字" class="headerlink" title="1、private关键字"></a>1、private关键字</h4><ul><li><p>是一个权限修饰符，修饰成员（成员变量和成员方法）</p></li><li><p>作用是保护成员不被别的类直接使用，被private修饰的成员只能在本类中使用</p></li></ul><pre class="line-numbers language-none"><code class="language-none">private String name;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li>如果要在其他类中使用private修饰的变量，可提供set  get方法，这些方法不用static</li></ul><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">return</span> name<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setName</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="2、构造方法"><a href="#2、构造方法" class="headerlink" title="2、构造方法"></a>2、构造方法</h4><p>概念：就是类 构造 对象时调用的方法，主要时完成对象数据的初始化</p><p>注意：</p><ul><li><p>如果没有定义构造方法，系统会定义一个默认的无参构造方法</p></li><li><p>构造方法可重载</p></li><li><p>如果给出了有参构造，就没有默认的无参构造</p></li></ul><p>下列就是一个无参构造方法和有参构造</p><pre class="line-numbers language-none"><code class="language-none">public Student()&#123;&#125;public Student(String name,int age)&#123;    this.name&#x3D;name;   &#x2F;&#x2F;在此方法中对数据进行初始化    this.age&#x3D;age;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="3、StringBuilder"><a href="#3、StringBuilder" class="headerlink" title="3、StringBuilder"></a>3、StringBuilder</h4><p>概述：普通的String对象进行拼接，每次都会创建新的String对象，浪费内存空间；StringBuilder就是解决此问题</p><p>概念：StringBuilder是一个可变的字符串类，内容是可变的</p><p>使用：</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">StringBuffer</span> sb<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">StringBuffer</span><span class="token punctuation">(</span><span class="token string">"abcd"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//用构造创建sb对象</span><span class="token class-name">StringBuffer</span> sb2<span class="token operator">=</span> sb<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"1243"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//append拼接数据，返回数据本身</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>sb2<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//abcd1243</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>sb<span class="token operator">==</span>sb2<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//true</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>reverse方法</p><pre class="line-numbers language-java" data-language="java"><code class="language-java">sb2<span class="token punctuation">.</span><span class="token function">reverse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//反转</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>sb2<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//3421dcba</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><strong>Sting和StringBuilder相互转换</strong></p><ul><li>String转StringBuilder：放入StringBuilder构造就行</li><li>StringBuilder转String：调用String的toString方法</li></ul><h3 id="四、继承"><a href="#四、继承" class="headerlink" title="四、继承"></a>四、继承</h3><h4 id="1、继承的概念"><a href="#1、继承的概念" class="headerlink" title="1、继承的概念"></a>1、继承的概念</h4><p>​子类具有父类的属性和方法</p><h4 id="2、super"><a href="#2、super" class="headerlink" title="2、super"></a>2、super</h4><p>super:代表父类储存空间的标识，（父类对象的引用）</p><p>可以通过super()调用父构造方法</p><img src="/images/Java%E5%9F%BA%E7%A1%80/image-20221116194817195.png" alt="this 和 super方法比较" style="zoom:33%;box-shadow:rgba(0,0,0,0) 0 1px 5px 0px;" /><h4 id="3、继承的特点"><a href="#3、继承的特点" class="headerlink" title="3、继承的特点"></a>3、继承的特点</h4><p><strong>构造方法的访问</strong></p><p>概述：因为子类会继承父类的数据，所以子类在初始化之前，一定要先完成父类的初始化。</p><ul><li>子类构造方法第一条默认语句都是 super()</li></ul><p><strong>成员方法的访问</strong></p><ul><li><p>子类对象访问一个方法：先在子类成员中查找，再在父类成员中查找</p></li><li><p>子类方法中也可空过super.父方法()，调用</p></li><li><p>@Override：是一个注解，检查重写方法的正确性</p></li></ul><p><strong>方法重写</strong></p><p>概念：子类出现和父类一模一样的方法（名和参数）</p><p>注意：</p><ul><li><p>私有方法不能被继承也不能重写</p></li><li><p>子类方法访问权限不能更低 （public&gt;默认&gt;私有）</p></li></ul><p><strong>继承注意事项</strong></p><p>不能同时继承多个类，但是能多层继承</p><h3 id="五、多态"><a href="#五、多态" class="headerlink" title="五、多态"></a>五、多态</h3><h4 id="1、多态的前提和体现"><a href="#1、多态的前提和体现" class="headerlink" title="1、多态的前提和体现"></a>1、多态的前提和体现</h4><ul><li><p>有继承关系</p></li><li><p>有重写方法</p></li><li><p>有父引用指向子对象</p></li></ul><h4 id="2、多态的特点"><a href="#2、多态的特点" class="headerlink" title="2、多态的特点"></a>2、多态的特点</h4><pre class="line-numbers language-none"><code class="language-none">Animal a &#x3D; new Cat();<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>二者不同是因为成员方法有方法重写，而成员变量没有</p><ul><li><p>修饰成员变量：编译看左边、执行看左边（访问的是父类中的成员变量，子类没有则报错）</p></li><li><p>修饰成员方法：编译看左边、执行看右边（访问的是父类中的成员方法，但是如果子类重写了方法，则访问子类的成员方法）</p></li></ul><h3 id="六、抽象类"><a href="#六、抽象类" class="headerlink" title="六、抽象类"></a>六、抽象类</h3><h4 id="1、抽象类的概念"><a href="#1、抽象类的概念" class="headerlink" title="1、抽象类的概念"></a>1、抽象类的概念</h4><p>Java中没有方法体的方法就是抽象方法，有抽象方法的类就是抽象类</p><p>（举例子：动物是一个抽象的概念，如果动物的子类-猫 直接多态使用父类 <code>Animal a = new Cat();</code> ，但是猫没有重写动物的方法，那将会直接使用动物的方法，这是不好的）</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">Animal</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">void</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//抽象方法</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h4 id="2、注意点"><a href="#2、注意点" class="headerlink" title="2、注意点"></a>2、注意点</h4><ul><li>抽象类抽象方法必须使用abstract关键字修饰类和方法</li><li>有抽象方法的类一定是抽象类；但抽象类里可以没有抽象方法</li><li>抽象类不能实例化，只能通过多态的方式使用</li><li>抽象的子类，要么重写抽象方法，要么也是抽象类</li><li>抽象类中成员：可以有成员变量、常量、构造方法、抽象方法、<strong>非抽象方法</strong></li></ul><h3 id="七、接口"><a href="#七、接口" class="headerlink" title="七、接口"></a>七、接口</h3><p><strong>接口的作用 ：接口是对行为的抽象 ！！！</strong></p><h4 id="1、接口的语法"><a href="#1、接口的语法" class="headerlink" title="1、接口的语法"></a>1、接口的语法</h4><p>接口用关键字 interface修饰</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">Jump</span> <span class="token punctuation">&#123;</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>类实现接口用implements （类实现接口就像类继承类）</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> cat <span class="token keyword">implements</span> <span class="token class-name">Jump</span><span class="token punctuation">&#123;</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">&#125;</span>  <span class="token comment">//JumpDemo 实现 cat</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>接口不能直接实例化</strong>，参照多态方式，接口实现类（相当于继承的子类），要么重写接口中所有方法，要么是抽象类</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"> <span class="token comment">//Jump j = new Jump(); 错误！！！</span><span class="token class-name">Jump</span> j <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">cat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>j<span class="token punctuation">.</span><span class="token function">jump</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 多态子类重写后的方法</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h4 id="2、接口的特点"><a href="#2、接口的特点" class="headerlink" title="2、接口的特点"></a>2、接口的特点</h4><p>成员变量：<strong>只能是常量</strong>，默认修饰符 <strong>public static final</strong></p><p>成员方法：<strong>只能是抽象方法</strong>，默认修饰符 <strong>public abstract</strong></p><p>构造方法：接口没有构造方法，因为接口主要对行为进行抽象，没有具体存在</p><h4 id="3、接口和类的关系"><a href="#3、接口和类的关系" class="headerlink" title="3、接口和类的关系"></a>3、接口和类的关系</h4><ul><li>接口和类：实现关系，类可以实现多个接口</li><li>接口和接口：继承关系，可单继承也可多继承</li><li>接口和抽象类的理念区别：<ul><li>抽象类对类抽象，包括属性、行为</li><li>接口对行为抽象，主要是行为</li></ul></li></ul><h3 id="八、内部类"><a href="#八、内部类" class="headerlink" title="八、内部类"></a>八、内部类</h3><p>内部类：就是在一个类中定义一个类</p><p>举例：CPU在笔记本内部，CPU类在笔记本的内部, 内部类就是模拟这层关系</p><h4 id="1、内部类的访问特点"><a href="#1、内部类的访问特点" class="headerlink" title="1、内部类的访问特点"></a>1、内部类的访问特点</h4><ul><li><p>内部类可直接访问外部类的成员</p></li><li><p>外部类访问内部类必须先创建对象</p></li></ul><h4 id="2、内部类分类"><a href="#2、内部类分类" class="headerlink" title="2、内部类分类"></a>2、内部类分类</h4><p>在类的成员位置：成员内部类</p><p>在类的局部位置：</p><ul><li>局部内部类（方法内定义的类）<ul><li>匿名内部类(特殊的局部内部类)</li></ul></li></ul><h4 id="3、匿名内部类"><a href="#3、匿名内部类" class="headerlink" title="3、匿名内部类"></a>3、匿名内部类</h4><p>匿名内部类本质是一个继承了该类或接口的匿名<strong>对象</strong></p><p>格式：</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">new</span> <span class="token class-name">Inter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@Override</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"匿名内部类"</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//直接调用该方法</span><span class="token comment">//多次调用</span><span class="token class-name">Inter</span> i <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Inter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@Override</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"匿名内部类"</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>i<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//直接调用该方法</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>匿名内部类的好处：每次多态都得新建一个类，在实例化一个对象，再传到要调用的该对象的方法中，匿名内部类可以代替新建一个类，直接传入一个对象。</p><h3 id="九、包装类"><a href="#九、包装类" class="headerlink" title="九、包装类"></a>九、包装类</h3><h4 id="1、包装类的概念"><a href="#1、包装类的概念" class="headerlink" title="1、包装类的概念"></a>1、包装类的概念</h4><p>包装类：将基本类型以及一些方法包装在一个类中</p><p><strong>装箱：自动基本类型转为包装类型</strong></p><p><strong>拆箱：自动将包装类型转基本类型</strong></p><h4 id="2、包装类的好处"><a href="#2、包装类的好处" class="headerlink" title="2、包装类的好处"></a>2、包装类的好处</h4><p>为什么使用包装类：使用包装类可以定义一些基本类型常用操作的方法，方便对进行其进行操作，包含基本类型的相关属性（包括最大值和最小值）以及相关的操作，比如toString等</p><h4 id="3、包装类和基本数据类型之间的区别"><a href="#3、包装类和基本数据类型之间的区别" class="headerlink" title="3、包装类和基本数据类型之间的区别"></a>3、包装类和基本数据类型之间的区别</h4><p>Integer和int的区别</p><ul><li>Integer是int的包装类，int则是Java的一种基本数据类型</li><li>Integer变量必须实例化后才能使用，而int变量不需要</li><li>Integer实际是对象的引用，当new一个Integer时，实际上是生成一个指针指向此对象；而int则是直接存储数据值</li><li>Integer的默认值是null，int的默认值是0</li></ul><h4 id="4、常用包装类"><a href="#4、常用包装类" class="headerlink" title="4、常用包装类"></a>4、常用包装类</h4><img src="/images/Java%E5%9F%BA%E7%A1%80/image-20221117101937710.png" alt="常用包装类" style="zoom: 50%;box-shadow:rgba(0,0,0,0) 0 1px 5px 0px;" /><h3 id="十、修饰符"><a href="#十、修饰符" class="headerlink" title="十、修饰符"></a>十、修饰符</h3><h4 id="1、权限修饰符"><a href="#1、权限修饰符" class="headerlink" title="1、权限修饰符"></a>1、权限修饰符</h4><img src="/images/Java%E5%9F%BA%E7%A1%80/image-20221116195322184.png" alt=" 权限修饰符" style="zoom:33%;box-shadow:rgba(0,0,0,0) 0 1px 5px 0px;" /><h4 id="2、状态修饰符"><a href="#2、状态修饰符" class="headerlink" title="2、状态修饰符"></a>2、状态修饰符</h4><p><strong>（1）finally</strong></p><p>可修饰<strong>成员方法、成员变量、类、局部变量</strong></p><p>finally修饰特点：</p><ul><li><p>修饰成员方法：表明该方法是最终方法，不能被子类重写<strong>（不是重载）</strong></p></li><li><p>修饰成员变量：表明该变量是常量、不能被赋值</p></li><li><p>修饰类：表明该类是最终类、不能被继承</p></li><li><p>修饰局部变量：</p><ul><li>变量是基本类型：基本类型的数据值不能发生改变</li><li>变量是引用类型：引用地址不能改变，但内容可以发生改变</li></ul></li></ul><p><strong>（2）static</strong></p><p>可修饰<strong>成员方法、成员变量</strong></p><p>static修饰特点：</p><ul><li>可以被类直接调用，被类的所有对象共享，修改变量所有的对象都受到影响</li><li>访问权限：<ul><li>静态方法  只能访问静态方法、属性</li><li>非静态方法  能访问静态 和 非静态方法、属性</li></ul></li></ul><h2 id="Java集合"><a href="#Java集合" class="headerlink" title="Java集合"></a>Java集合</h2><h3 id="一、集合概述"><a href="#一、集合概述" class="headerlink" title="一、集合概述"></a>一、集合概述</h3><img src="/images/Java%E5%9F%BA%E7%A1%80/image.png" alt="Java集合" style="zoom: 40%;box-shadow:rgba(0,0,0,0) 0 1px 5px 0px;" /><h3 id="二、Collection"><a href="#二、Collection" class="headerlink" title="二、Collection"></a>二、Collection</h3><p>概述：是单列集合的<strong>顶层接口，</strong>表示一组对象，这些对象是Collection集合的元素</p><p>Collection是一个接口，JDK不提供此接口的任何直接实现，它提供更具体的子类接口</p><p><strong>并发修改异常</strong>：迭代器遍历过程中修改了集合的内容长度，会导致next()获取元素中预期值和实际值不一致，抛出异常</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">Collection</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span> c <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>c<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">;</span>c<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">321</span><span class="token punctuation">)</span><span class="token punctuation">;</span>c<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">333</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">Iterator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span> i<span class="token operator">=</span>c<span class="token punctuation">.</span><span class="token function">iterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//调用方法得到迭代器</span><span class="token keyword">while</span> <span class="token punctuation">(</span>i<span class="token punctuation">.</span><span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>i<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="三、List"><a href="#三、List" class="headerlink" title="三、List"></a>三、List</h3><p>概述：有序集合，用户可控制和集合中每个元素的插入位置，也可通过索引访问元素，可重复</p><p>List的Iterator，List集合特有迭代器，可以任意方向遍历集合，调用List的Iterator的add不会并发修改异常</p><h3 id="四、ArrayList"><a href="#四、ArrayList" class="headerlink" title="四、ArrayList"></a>四、ArrayList</h3><p>概述：普通数组长度固定，不能适应变化要求，所以出现了集合，ArrayList 底层结构是数组，查询快，增删慢</p><p>集合有很多，ArrayList是其中一个</p><ul><li>&lt; E &gt;是一种特殊的数据类型，泛型</li><li>&lt; E &gt;是集合中储存数据的数据类型</li><li>在出现&lt; E &gt;地方用引用类型替换即可</li><li>ArrayList 是可调整数组大小的实现，底层还是数组</li></ul><p>常用方法：</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> arr<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>arr<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"a"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>arr<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"b"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>arr<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token string">"我是第一个"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//[我是第一个, a, b]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="/images/Java%E5%9F%BA%E7%A1%80/image-20221117153411035.png" alt="ArrayList 常用方法" style="zoom:50%;box-shadow:rgba(0,0,0,0) 0 1px 5px 0px;" /><h3 id="五、LinkedList"><a href="#五、LinkedList" class="headerlink" title="五、LinkedList"></a>五、LinkedList</h3><p>LinkedList:底层结构是链表，查询慢，增删快</p><h3 id="六、HashSet"><a href="#六、HashSet" class="headerlink" title="六、HashSet"></a>六、HashSet</h3><p>概述：HashSet是Set的实现类，基本方法与Set一致，底层结构是哈希表</p><p>HashSet保证唯一原理：添加元素的时候底层先比较Hash值是否相同，如果相同再调用equals比较内容是否相同，都相同则不会添加相同元素，有一个不同会直接添加该元素</p><h3 id="七、TreeSet"><a href="#七、TreeSet" class="headerlink" title="七、TreeSet"></a>七、TreeSet</h3><p>概述：TreeSet 是一个有序的集合，提供有序的Set集合</p><p>TreeSet中的元素支持两种排序方式</p><ul><li><p>无参构造创建TreeSet时会使用自然排序Comparable，该接口对实现它的每个类的对象添加一个整体排序，就是自然排序，类的compareTo是自然排序方法</p></li><li><p>创建TreeSet 时提供的 Comparator(比较器排序接口) 进行排序</p></li></ul><h3 id="八、LinkedHashSet"><a href="#八、LinkedHashSet" class="headerlink" title="八、LinkedHashSet"></a>八、LinkedHashSet</h3><p>哈希表和链表实现的Set接口，有可预测的迭代次序，链表保证了次序，Hash表保证了唯一</p><h3 id="九、HashMap"><a href="#九、HashMap" class="headerlink" title="九、HashMap"></a>九、HashMap</h3><p>键映射到值的对象，不能有重复的键，一个键映射一个值</p><p>3 种 遍历方式</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span><span class="token class-name">String</span><span class="token punctuation">></span></span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"1"</span><span class="token punctuation">,</span><span class="token string">"一"</span><span class="token punctuation">)</span><span class="token comment">//第 1 种遍历方式</span><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">String</span> key <span class="token operator">:</span> map<span class="token punctuation">.</span><span class="token function">keySet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">//第 2 种遍历方式,只能拿到 value</span><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">String</span> value <span class="token operator">:</span> map<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">//第 3 种遍历方式</span><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">Map<span class="token punctuation">.</span>Entry</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span><span class="token class-name">String</span><span class="token punctuation">></span></span> entry<span class="token operator">:</span> map<span class="token punctuation">.</span><span class="token function">entryKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>entry<span class="token punctuation">.</span><span class="token function">getKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>entry<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="十、TreeMap"><a href="#十、TreeMap" class="headerlink" title="十、TreeMap"></a>十、TreeMap</h3><h3 id="十一、泛型"><a href="#十一、泛型" class="headerlink" title="十一、泛型"></a>十一、泛型</h3><h4 id="1、泛型类"><a href="#1、泛型类" class="headerlink" title="1、泛型类"></a>1、泛型类</h4><p>泛型：提供了编译时类型安全检测机制</p><p>本质是参数化类型，操作的数据类型被指定为一个参数</p><p>参数化理解：</p><ul><li>就是将原来具体的类型参数化，在调用用的时候传入具体类型</li></ul><p>格式</p><ul><li><p>&lt;类型&gt;：指定一种类型，这个类型可以看作形参</p></li><li><p>&lt;类型，类型1..&gt;也可以多个类型</p></li><li><p>将来具体调用的时候给定的类型可以看作是实参</p></li></ul><p>格式：修饰符 class 类名&lt;类型&gt;{…}</p><pre class="line-numbers language-none"><code class="language-none">public class Generic&lt;T&gt; &#123;&#125;  &#x2F;&#x2F;这里T就是形参可以随意写，调用时候传入类型<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="2、泛型方法"><a href="#2、泛型方法" class="headerlink" title="2、泛型方法"></a>2、泛型方法</h4><p>格式：修饰符 &lt;类型&gt; 返回值 函数名(类型 形参){…}</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token generics"><span class="token punctuation">&lt;</span> <span class="token class-name">T</span> <span class="token punctuation">></span></span> <span class="token keyword">void</span> <span class="token function">show</span><span class="token punctuation">(</span><span class="token class-name">T</span> abc<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">&#125;</span> <span class="token comment">//调用这个函数时，传什么类型，T就是对应类型</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="3、泛型接口"><a href="#3、泛型接口" class="headerlink" title="3、泛型接口"></a>3、泛型接口</h4><p>接口：</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">Fx</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">></span></span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>实现类：</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Generic</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">></span></span> <span class="token keyword">implements</span> <span class="token class-name">Fx</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">></span></span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="4、类型通配符"><a href="#4、类型通配符" class="headerlink" title="4、类型通配符"></a>4、类型通配符</h4><p>为了表示各种泛型List的父类，可用通配符</p><ul><li><p>类型通配符：&lt;?&gt;</p></li><li><p>List&lt;?&gt;:表示元素类型未知的List</p></li><li><p>这种带通配符的List仅代表它是各种泛型List的父类</p></li><li><p>类型通配符上限 &lt;?extends 类型&gt;    表示的类型是该类型及其子类</p></li><li><p>类型通配符下限&lt;?super 类型&gt;  表示的类型是该类型及其父类</p></li></ul><h2 id="Java-IO流"><a href="#Java-IO流" class="headerlink" title="Java IO流"></a>Java IO流</h2><h4 id="1、数据输入-Scanner类"><a href="#1、数据输入-Scanner类" class="headerlink" title="1、数据输入 Scanner类"></a>1、数据输入 Scanner类</h4><p>Scanner类：获取用户的输入</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">Scanner</span> sc <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Scanner</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>in<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>接收数据（这一步就会让用户进行输入，输入完成后才对x赋值）</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">int</span> x <span class="token operator">=</span> sc<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="2、file常用方法"><a href="#2、file常用方法" class="headerlink" title="2、file常用方法"></a>2、file常用方法</h4><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">File</span> file <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//""放入文件地址</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>file<span class="token punctuation">.</span><span class="token function">getNmae</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//文件名</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>file<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//文件大小</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>file<span class="token punctuation">.</span><span class="token function">exists</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//文件是否存在</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>file<span class="token punctuation">.</span><span class="token function">canWrite</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//查看文件权限，是否可写</span>file<span class="token punctuation">.</span><span class="token function">createNewFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//创建文件</span>file<span class="token punctuation">.</span><span class="token function">isDirectory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//判断是否为文件夹</span>file<span class="token punctuation">.</span><span class="token function">mkdirs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//创建文件夹，多级目录</span>file<span class="token punctuation">.</span><span class="token function">mkdir</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//创建文件夹，单级目录</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="3、文件写出"><a href="#3、文件写出" class="headerlink" title="3、文件写出"></a>3、文件写出</h4><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">File</span> file <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//""写出文件地址</span><span class="token class-name">OutputStream</span> os <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span><span class="token keyword">try</span><span class="token punctuation">&#123;</span>os <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileOutputStream</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">;</span>os<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">"写出的内容"</span><span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">FileNotFoundException</span> e<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">finally</span><span class="token punctuation">&#123;</span>    os<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="4、IO流概述"><a href="#4、IO流概述" class="headerlink" title="4、IO流概述"></a>4、IO流概述</h4><p><strong>前提知识</strong></p><p>字节：计算机中一切皆字节（视频，图片和文本），本质就是二进制码。<br>字符：是指计算机中使用的文字和符号，比如1、2、A、B、~！*#￥%等等。</p><p>I 就是input的首字母：输入，把硬盘中的数据，读取到内存使用。</p><p>o就是output的首字母：输出，<br>把内存中的数据，写入到硬盘中保存。</p><p>内存的概念：临时储存数据<br>这里主要记住<strong>内存是中心，进内存就是输入，出内存就是输出。</strong></p><p><strong>字节流与字符流</strong></p><table><thead><tr><th>字节流</th><th align="center"></th><th>字符流</th></tr></thead><tbody><tr><td>字节输入流 InputStream</td><td align="center">输入流</td><td>字符输入流 Reader</td></tr><tr><td>字节输出流 OutputStream</td><td align="center">输出流</td><td>字符输出流 Writer</td></tr></tbody></table><p><strong>节点流与处理流</strong></p><table><thead><tr><th>节点流</th><th>处理流</th></tr></thead><tbody><tr><td>流的一端是程序，另一端是节点</td><td>以其他已经存在的流作为一个端点的流</td></tr><tr><td>构造方法的参数是节点</td><td>构造方法总有一个其他流对象作为参数</td></tr></tbody></table><h4 id="5、字节流"><a href="#5、字节流" class="headerlink" title="5、字节流"></a>5、字节流</h4><p> <strong>(1) 字节输入流</strong><br> 先在D盘下创建一个hello.txt,里面内容写上hello baby</p><p><strong>步骤</strong></p><ul><li>定义一个文件流</li><li>定义一个字节数组</li><li>将输入流的数据读入到字节数组中</li><li>通过UTF-8编码表将字节转换为字符</li></ul><p><strong>代码实践：</strong></p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">InputStream</span>  <span class="token punctuation">&#123;</span><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">&#123;</span><span class="token class-name">File</span> file<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">"D://hello.txt"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//显示具体路径</span><span class="token class-name">FileInputStream</span> fs <span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//定义一个文件流</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> b<span class="token operator">=</span><span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token number">1024</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//定义一个字节数组</span> fs<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//将输入流的数据读入到字节数组中</span> <span class="token class-name">String</span> str<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span><span class="token string">"UTF-8"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//通过UTF-8编码表将字节转换为字符</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//输出到控制台</span>   <span class="token punctuation">&#125;</span> <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>注意：如果在那个txt文件里，输入的是中文：我好帅。控制台显示的是？？？<br>不是它质疑你的帅气，而是不支持中文，编码问题。</strong></p><p> <strong>(2) 字节输出流</strong></p><p><strong>步骤：</strong></p><ul><li>创建一个输出流</li><li>将字符转换成字节</li><li>字节写出文件</li><li>保存文件</li></ul><p><strong>代码实践：</strong></p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">OutputStream</span> <span class="token punctuation">&#123;</span><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">&#123;</span>  <span class="token class-name">String</span> file<span class="token operator">=</span><span class="token string">"D://test.txt"</span><span class="token punctuation">;</span>  <span class="token class-name">FileOutputStream</span> out<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">FileOutputStream</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//创建输出流</span>  <span class="token class-name">String</span> str<span class="token operator">=</span><span class="token string">"hello baby"</span><span class="token punctuation">;</span>  <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> b<span class="token operator">=</span>str<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//字符转换为字节</span>  out<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//字节写出到文件</span>  out<span class="token punctuation">.</span><span class="token function">flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//保存文件</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>这段代码执行后，你会发现D盘创建一个test.txt文件，里面写着hello baby</p><h4 id="6、字符流"><a href="#6、字符流" class="headerlink" title="6、字符流"></a>6、字符流</h4><p>字符流和字节流步骤相似，不再累述！</p><p><strong>(1) 字符输入流</strong><br>  先在D盘下创建一个hello.txt<br> 里面内容写上hello baby</p><p> <strong>代码实践：</strong></p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Reader</span> <span class="token punctuation">&#123;</span><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span><span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token class-name">String</span> file<span class="token operator">=</span><span class="token string">"D://hello.txt"</span><span class="token punctuation">;</span><span class="token comment">//显示具体路径</span>  <span class="token class-name">FileReader</span> fr <span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">FileReader</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//定义一个文件流</span>   <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> b<span class="token operator">=</span><span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token number">1024</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//定义一个字节数组</span>   fr<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//将输入流中的数据读入到字节数组中</span>   <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"b"</span><span class="token punctuation">)</span><span class="token comment">//输出到控制台</span>   fr<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//关闭输入流</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>当你执行完这段代码后发现，输出hello baby的同时，还有1014个空格</p><p>为了解决打印多余空格问题，查阅API帮助文档，reader方法是将字符流中的数据读入到字符数组中，如果读取到文件末尾则返回-1，否则返回读取到的长度，所以只要遇到-1就终止好了。</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">String</span> file <span class="token operator">=</span> <span class="token string">"D://hello.txt"</span><span class="token punctuation">;</span><span class="token class-name">FileReader</span> fr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileReader</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//定义一个文件流</span><span class="token keyword">char</span><span class="token punctuation">[</span><span class="token punctuation">]</span> cbuf <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">char</span><span class="token punctuation">[</span><span class="token number">1024</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//定义一个字节数组</span><span class="token keyword">int</span> len <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">// 每次读取的长度</span><span class="token class-name">StringBuilder</span> builder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>len <span class="token operator">=</span> fr<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>cbuf<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">//将数据读入到cbuf中并返回读取到的数据长度，不等于-1就继续</span>builder<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>cbuf<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>len<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">//将cbuf 0 到len长度的数据添加到builder </span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>builder<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//输出到控制台</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p> <strong>(2) 字符输出流</strong></p><p><strong>代码实践：</strong></p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Writer</span> <span class="token punctuation">&#123;</span><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span><span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token class-name">File</span> file<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">"D://hello.txt"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">FileWriter</span> fw<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">FileWriter</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//定义一个文件流</span>fw<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">"hello baby"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//写出到文件</span>fw<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//关闭流</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>这段代码执行后，你会发现D盘创建一个test.txt文件，里面写着hello baby</p><h2 id="Java-线程"><a href="#Java-线程" class="headerlink" title="Java 线程"></a>Java 线程</h2><h3 id="线程"><a href="#线程" class="headerlink" title="线程"></a>线程</h3><h4 id="1、进程和线程"><a href="#1、进程和线程" class="headerlink" title="1、进程和线程"></a>1、进程和线程</h4><p><strong>进程</strong>：进程是程序的一次动态执行过程，它对应了从代码加载、执行到执行完毕的一个完整过程<br><strong>线程</strong>：线程是比进程更小的执行单位<br>举列子：当你打开一个App可以看成一个实现进程，当打开一个App里的一个功能，比如播放音乐，病毒扫描就是实现一个线程。<br><strong>线程调度</strong>：计算机操作系统为了提高程序的运行效率，当一个线程空闲时就会撤下这个线程，而会让其他线程执行！</p><h4 id="2、并行和并发"><a href="#2、并行和并发" class="headerlink" title="2、并行和并发"></a>2、并行和并发</h4><p>并行：针对进程的，同一个时刻发生多个事件，比如你用酷狗音乐播放音乐的同时，打开浏览器看这篇博客。<br>并发：针对线程的，在一段时间内发生多个事件</p><h4 id="3、Java多线程的实现"><a href="#3、Java多线程的实现" class="headerlink" title="3、Java多线程的实现"></a>3、Java多线程的实现</h4><p>有两类方法</p><p>（1）继承Thread方法，重写run() 方法</p><p>（2）实现Runnable接口，重写run() 方法</p><p><strong>继承Thread，重写run()方法</strong></p><p>Thread是java.lang包下的一个类，当用户操作Thread类时，Thread类创建一个线程并交付给操作系统进行调度。</p><p>步骤：</p><p>（1）创建一个类继承（extend）Thread 类，定义线程的构造函数； </p><p>（2）用需在此线程中执行的代码覆盖 Thread 类的 run()方法； </p><p>（3）用关键字 new 创建所定义的线程类的一个实例化对象； </p><p>（4）调用该对象的 start()方法启动线程。 </p><p><strong>实现Runnable接口，重写run（）方法</strong></p><p>很多情况下，一个类已经继承了其他类，由于java单继承的限制，该类无法继承Thread类，java语言便提供了Runnable接口，从而使得不继承Thread的情况下也能创建新的线程！<br><strong>这个方式常用！因为可以避免java中单继承的限制，可以将并行 运行任务和运行机制   解耦</strong><br>步骤：</p><p>（1）创建一个类实现（implements）Runnable 接口； </p><p>（2）用需在此线程中执行的代码覆盖 Thread 类的 run()方法； </p><p>（3）在类中定义一个 Thread 类对象；</p><p>（4）利用public Thread(Runnable target) 实例化定义对象</p><p>【public Thread(Runnable target)】 —–利用一个实现了 Runnable 接口参数对象 Target中所定义的 run（）方法，来初始化或覆盖新创建的线程对象的 run（）方法。</p><p>（5）调用该对象的 start()方法启动线程。</p><p><strong>敲黑板画细节：</strong><br>关于run()方法和start()的正确理解<br>run（）:仅仅是封装被线程执行的代码<br>start（）：首先启动了线程，然后再用jvm去调用该线程的run（）方法</p><h4 id="4、线程的状态和生命周期"><a href="#4、线程的状态和生命周期" class="headerlink" title="4、线程的状态和生命周期"></a>4、线程的状态和生命周期</h4><p>五种状态<br>新建状态–&gt;就绪状态–&gt;运行状态–&gt;阻塞状态–&gt;死亡状态</p><p>下面这段话来自java语言程序设计，写的非常清楚！</p><p>（1）新建状态（Newborn）<br>当一个 Thread 类或其子类对象被声明并用 new 关键字来实例化时，新生的线程对象处于新建状态。此时它已经被初始化，并拥有了相应的内存空间和其它资源，但还未开始执行。</p><p>（2）就绪状态（Runnable）<br>处于新建状态的线程被启动后（即执行了 start()方法后），进入了就绪状态。此时它已具备运行条件，被放入线程队列排队等待执行，一旦轮到它来使用处理器资源时，就可以脱离创建它的主线程独立开始自己的生命周期了。至于何时真正执行，取决于线程的优先级和在线程队列中的位置。另外，原来处于阻塞状态的线程被解除阻塞后也将进入就绪状态。</p><p>（3）运行状态（Running）<br>当就绪状态的线程被调度并获得处理器资源时，便进入运行状态。当线程对象被调度执行时，它将自动调用本对象的 run()方法，从第一句开始顺序执行。<br>（4）阻塞状态（Blocked）<br>一个正在执行的线程在某些特殊情况下（如被人为挂起或需要执行费时的输入输出操作时），将让出 CPU 并暂时中止自己的执行，进入阻塞状态。阻塞时它不能进入排队队列，只有引起阻塞的原因被消除，线程才可以转入就绪状态，重新进到线程队列中排队等待 CPU资源，以便从原来终止处开始继续执行。<br>引起阻塞的方法有 Wait()、Sleep()、Yield()等。</p><p>等待阻塞：运行的线程执行 wait()方法，JVM会把该线程放入等待池中。( wait会释放持有的锁)；</p><p>同步阻塞：运行的线程在获取对象的同步锁时，若该同步锁被别的线程占用，则JVM会把该线程放入锁池中；</p><p>其他阻塞：运行的线程执行 sleep()或 join()方法，或者发出了I&#x2F;O请求时，JVM会把该线程置为阻塞状态。当 sleep()状态超时、 join()等待线程终止或者超时、或者I&#x2F;O处理完毕时，线程重新转入就绪状态。（注意, sleep是不会释放持有的锁）；</p><p>（5）死亡状态（Dead）<br>处于死亡或终止状态的线程不具有继续运行的能力。其原因有两个：<br>一个是正常运行的线程完成了它的全部工作，即执行完了 run()方法的最后一个语句并退出；<br>另一个是线程被提前强制性的终止，如通过执行 stop()方法强行终止当前线程（该方法目前已不建议使用）。</p><h4 id="5、线程的控制"><a href="#5、线程的控制" class="headerlink" title="5、线程的控制"></a>5、线程的控制</h4><p><strong>线程调度</strong></p><p>计算机操作系统为了提高程序的运行效率，当一个线程空闲时就会撤下这个线程，而会让其他线程执行！<br>Java中提供一个线程调度管理器来监控启动后进入就绪状态的所有线程，并通过优先级来确定运行的顺序。<br>线程的优先级预定义为10，1和5，分别对应三个优先级，默认为5即NORM_PRIORITY,可以用getPriority()和返回线程的优先级，也可以用setPriority()改变线程的优先级。</p><p><strong>挂起线程</strong></p><p>（1）wait：使得线程进入等待状态，直到被另一个线程唤醒</p><p>（2）sleep：线程睡眠，sleep()可用于让线程沉睡若干毫秒，sleep（1000）为沉睡一秒钟，而1秒后，线程会自动苏醒，并继续执行后续的代码，sleep（）方法并非一定能运行成功，当线程在挂起状态，由于某种原因打断了，它会抛出一个类型InterruptException的异常。</p><p>（3）yield：功能是暂停当前正在执行的线程方法，让其他线程先执行，<strong>需要注意的是，yield（）方法只会给相同优先级线程一个执行机会</strong></p><p>（4）join：功能：是将几个并行的线程合并成单线程执行。</p><p>（5）interrupt：一个线程运行时，另一个线程可以调用对应的 Thread对象的interrupt()方法中断它。（但它仅仅是通知，什么时候终端还是要我们自己控制的）</p><p><strong>结束线程</strong></p><p>stop（）方法：程序中需要强制终止某线程的生命周期时可以使用stop（）方法。<br>stop方法可以由线程在自己的run（）方法中调用，也可以其他线程在执行方法中调用。<br>stop()方法将会使线程由其他状态进入死亡状态。<br>但不推荐 使用stop（）方法来强制终止线程，因为它将会导致错误发生。例如，如果一个线程正在操作共享数据段，操作过程没有完成即被执行stop（）方法，将会导致数据的不完整！</p><p>destroy（）方法：程序可以使用destroy（）方法来强制结束线程，但是这个方法在结束线程后，将不会释放锁，因此也不推荐使用！</p><p>参数控制法：由于stop（）和的 destroy（）方法在java新版本中已不建议使用，可以使用一个指示run（）方法必须退出的标志来停止一个线程。</p><p>具体步骤如下：</p><p>（1）编写一个类继承Thread类</p><p>（2）在这个类中增加一个布尔变量，并将其值初始化为false。</p><p>（3）覆盖start（）方法，首先将布尔变量的值置为true，然后调用super（）方法，start（）方法。</p><p>（4）提供一个public方法 halt（），它将变量置为false。</p><p>（5）在run（）方法中使用类似下面的while循环：</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">void</span> run <span class="token punctuation">(</span> <span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">while</span><span class="token punctuation">(</span>布尔参数<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    线程要执行的代码<span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>如果这个线程的halt（）方法被调用，则会将布尔参数的值置为假，从而引起run（）方法终止执行，从而结束该线程！</p><h4 id="6、线程的同步"><a href="#6、线程的同步" class="headerlink" title="6、线程的同步"></a>6、线程的同步</h4><p>锁机制</p><p><strong>Synchronized（同步）锁</strong>：<br>synchronized就是一个关键字，它能将代码块锁起来<br>synchronized是一种互斥锁，一次只能允许一个线程进入被锁住的代码块（方法）</p><p><strong>Lock显式锁</strong><br>lock显式锁就是一个接口<br>lock显式锁比synchronized锁的优点就是灵活性高，缺点是需要手动释放锁。</p><p><strong>公平锁</strong>：线程按照它们发出的请求顺序来获取锁<br>非公平锁：synchronizated锁和lock显式锁都是非公平锁，线程发出请求时可以插队来获取锁。</p><p><strong>死锁</strong>：</p><p>（1）当前线程拥有其他线程需要的资源</p><p>（2）当前线程等待其他线程已拥有的资源</p><p>（3）都不放弃拥有的资源</p><p><strong>原因及解决的办法</strong></p><p>（1）线程间交错执行   解决方法：以固定的顺序加锁</p><p>（2）执行某方法时就需要持有锁且不释放<br>解决：缩减同步代码块的范围，最好仅操作共享变量时才加锁</p><p>（3）永久等待   解决：使用定时锁</p><h4 id="7、常用的线程方法"><a href="#7、常用的线程方法" class="headerlink" title="7、常用的线程方法"></a>7、常用的线程方法</h4><p>不需要特别记忆，需要用的时候查询即可</p><table><thead><tr><th>方法</th><th>含义</th></tr></thead><tbody><tr><td>start()</td><td>使该线程开始执行；Java 虚拟机调用该线程的 run 方法。</td></tr><tr><td>run()</td><td>如果该线程是使用独立的 Runnable 运行对象构造的，则调用该 Runnable 对象的 run 方法；否则，该方法不执行任何操作并返回。</td></tr><tr><td>setName()</td><td>改变线程名称，使之与参数 name 相同。</td></tr><tr><td>setPriority()</td><td>更改线程的优先级。</td></tr><tr><td>setDaemon()</td><td>将该线程标记为守护线程或用户线程。</td></tr><tr><td>join()</td><td>等待该线程终止的时间最长为 millis 毫秒</td></tr><tr><td>interrupt()</td><td>中断线程。</td></tr><tr><td>isAlive()</td><td>测试线程是否处于活动状态。</td></tr><tr><td>yield()</td><td>暂停当前正在执行的线程对象，并执行其他线程。</td></tr><tr><td>sleep（)</td><td>在指定的毫秒数内让当前正在执行的线程休眠（暂停执行），此操作受到系统计时器和调度程序精度和准确性的影响。</td></tr></tbody></table><h2 id="Java反射"><a href="#Java反射" class="headerlink" title="Java反射"></a>Java反射</h2><h2 id="Lambda表达式"><a href="#Lambda表达式" class="headerlink" title="Lambda表达式"></a>Lambda表达式</h2><p>从Java8（Java 1.8）开始的新特性，接口中只有一个抽象方法</p><h2 id="JDBC"><a href="#JDBC" class="headerlink" title="JDBC"></a>JDBC</h2><p>1、加载驱动</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">static</span><span class="token punctuation">&#123;</span>    <span class="token keyword">try</span><span class="token punctuation">&#123;</span>        <span class="token keyword">new</span> <span class="token class-name">Driver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>2、创建连接</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">Connection</span> conn <span class="token operator">=</span> <span class="token class-name">DriverManager</span><span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span>url<span class="token operator">:</span><span class="token string">""</span>user<span class="token operator">:</span><span class="token string">""</span>password<span class="token operator">:</span><span class="token string">""</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>3、创建传输</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">Statement</span> st <span class="token operator">=</span> conn<span class="token punctuation">.</span><span class="token function">createStatement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>4、运行SQL语句</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">String</span> sql <span class="token operator">=</span> <span class="token string">"insert into user(username,password) values('admin','12345')"</span><span class="token punctuation">;</span><span class="token keyword">int</span> i <span class="token operator">=</span> statement<span class="token punctuation">.</span><span class="token function">executeUpdate</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>5、处理运行结果</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">ResultSetMetaData</span> rsmd<span class="token operator">=</span> resultSet<span class="token punctuation">.</span><span class="token function">getMetaData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//只有查询需要</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>6、释放资源</p><pre class="line-numbers language-java" data-language="java"><code class="language-java">statement<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>conn<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>全部代码</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DbUtil</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">URL</span> <span class="token operator">=</span> <span class="token string">"jdbc:mysql://localhost:3306/test"</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">USER</span> <span class="token operator">=</span> <span class="token string">"root"</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">PASSWORD</span> <span class="token operator">=</span> <span class="token string">"123456"</span><span class="token punctuation">;</span>        <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">&#123;</span>        <span class="token comment">//1.加载驱动程序</span>        <span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span><span class="token string">"com.mysql.jdbc.Driver"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//2. 获得数据库连接</span>        <span class="token class-name">Connection</span> conn <span class="token operator">=</span> <span class="token class-name">DriverManager</span><span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token constant">URL</span><span class="token punctuation">,</span> <span class="token constant">USER</span><span class="token punctuation">,</span> <span class="token constant">PASSWORD</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//3.操作数据库，实现增删改查</span>        <span class="token class-name">Statement</span> stmt <span class="token operator">=</span> conn<span class="token punctuation">.</span><span class="token function">createStatement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">ResultSet</span> rs <span class="token operator">=</span> stmt<span class="token punctuation">.</span><span class="token function">executeQuery</span><span class="token punctuation">(</span><span class="token string">"SELECT user_name, age FROM test"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//如果有数据，rs.next()返回true</span>        <span class="token keyword">while</span><span class="token punctuation">(</span>rs<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>rs<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">"user_name"</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">" 年龄："</span><span class="token operator">+</span>rs<span class="token punctuation">.</span><span class="token function">getInt</span><span class="token punctuation">(</span><span class="token string">"age"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token comment">//释放资源</span>        stmt<span class="token punctuation">.</span><span class="token function">colse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        conn<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="数组排序"><a href="#数组排序" class="headerlink" title="数组排序"></a>数组排序</h2><h4 id="1、冒泡排序"><a href="#1、冒泡排序" class="headerlink" title="1、冒泡排序"></a>1、冒泡排序</h4><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> arr <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> arr<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> arr<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">></span> arr<span class="token punctuation">[</span>j <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">int</span> t <span class="token operator">=</span> arr<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>            arr<span class="token punctuation">[</span>j <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> arr<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>            arr<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> arr<span class="token punctuation">[</span>j <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token comment">//输出结果为 1 2 3 4</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Mysql基础</title>
      <link href="/2021/11/08/Mysql%E5%9F%BA%E7%A1%80/"/>
      <url>/2021/11/08/Mysql%E5%9F%BA%E7%A1%80/</url>
      
        <content type="html"><![CDATA[<h1 id="Mysql基础"><a href="#Mysql基础" class="headerlink" title="Mysql基础"></a>Mysql基础</h1><img src="/images/Mysql%E5%9F%BA%E7%A1%80/image-20221116111013145.png" alt="黑马程序员-Mysql路线" style="zoom: 40%;box-shadow:rgba(0,0,0,0) 0 1px 5px 0px;" /><h2 id="Mysql-概述"><a href="#Mysql-概述" class="headerlink" title="Mysql 概述"></a>Mysql 概述</h2><h3 id="一、Mysql-数据类型"><a href="#一、Mysql-数据类型" class="headerlink" title="一、Mysql 数据类型"></a>一、Mysql 数据类型</h3><table><thead><tr><th align="center">数据类型</th><th align="center">备注</th></tr></thead><tbody><tr><td align="center">boolean</td><td align="center">在mysql中是以 tinyint 存储的</td></tr><tr><td align="center">int</td><td align="center">最大存储数据约为2亿</td></tr><tr><td align="center">bigint</td><td align="center">和Java中的 long意义相同</td></tr><tr><td align="center">float</td><td align="center">不精确小数运算</td></tr><tr><td align="center">double</td><td align="center">不精确小数运算，<br />可以使用decimal(6,2)精确小数运算,最多6位，小数位2位</td></tr><tr><td align="center">char</td><td align="center">定长字符串，不够用空格补齐，<strong>最大长度为255</strong></td></tr><tr><td align="center">varchar</td><td align="center">变长字符串，可以进行图片路径的存储</td></tr><tr><td align="center">date</td><td align="center">年月日的存储，“2022-8-5”或者20220805都可以</td></tr><tr><td align="center">time</td><td align="center">时分秒的存储</td></tr><tr><td align="center">datetime</td><td align="center">年月日时分秒的存储</td></tr><tr><td align="center">year</td><td align="center">只进行年份的存储。<br />插入0，实际存储0000<br />插入“0”，实际存储2000<br />插入1-69，实际存储2001-2069<br />插入70-99，实际存储2070-2099</td></tr><tr><td align="center">timestamp</td><td align="center">输入9999年份会报错，数据范围比较小</td></tr></tbody></table><h3 id="二、Mysql运算符"><a href="#二、Mysql运算符" class="headerlink" title="二、Mysql运算符"></a>二、Mysql运算符</h3><h4 id="1、算术运算符"><a href="#1、算术运算符" class="headerlink" title="1、算术运算符"></a>1、算术运算符</h4><p>Mysql中有 <code>+ - * /</code> 运算符，注意点：</p><ul><li><p><code>+</code>  会把字符串中的数字提取出来 eg： <code>select 1 + &quot;23abc&quot;</code> , 结果为 24</p></li><li><p>日期按指定位计算，eg：日期类型 - 1000 , 实际上会在 倒数第四位减去1，并不是减去1000毫秒</p></li><li><p>Mysql中没有 <code>+=  -=  *=  /=  ++  --</code> 等相关方法进行字符串拼接</p></li></ul><h4 id="2、关系运算符"><a href="#2、关系运算符" class="headerlink" title="2、关系运算符"></a>2、关系运算符</h4><p>Mysql中有 <code>&gt; &lt; &lt;= &gt;= != &lt;&gt;</code>  等运算符，其中 数字，字符，时间等类型都可以进行比较</p><h4 id="3、逻辑运算符"><a href="#3、逻辑运算符" class="headerlink" title="3、逻辑运算符"></a>3、逻辑运算符</h4><table><thead><tr><th>逻辑运算符</th><th>功能</th></tr></thead><tbody><tr><td>and 或 &amp;&amp;</td><td>并且（多个条件同时成立）</td></tr><tr><td>or 或 | |</td><td>或者（多个条件任意一个成立）</td></tr><tr><td>not 或 !</td><td>非，不是</td></tr></tbody></table><h3 id="三、Mysql-关键词"><a href="#三、Mysql-关键词" class="headerlink" title="三、Mysql 关键词"></a>三、Mysql 关键词</h3><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">空的判断:<span class="token operator">is</span> <span class="token boolean">null</span> 或者 <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span>连续范围查询:<span class="token keyword">where</span> age <span class="token operator">between</span> <span class="token operator">&lt;</span>小的值<span class="token operator">></span> <span class="token operator">and</span> <span class="token operator">&lt;</span>大的值<span class="token operator">></span><span class="token comment">-- 下面语句不报错，但查不到任何信息</span><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> employee <span class="token keyword">where</span> age <span class="token operator">between</span> <span class="token number">30</span> <span class="token operator">and</span> <span class="token number">20</span><span class="token punctuation">;</span>离散范围查询:<span class="token keyword">where</span> age <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">)</span>模糊查询:<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> cat <span class="token keyword">where</span> name <span class="token operator">like</span> <span class="token string">'t%'</span><span class="token punctuation">(</span>第一个字符是t<span class="token punctuation">)</span> 或者 <span class="token operator">like</span> <span class="token string">'_t%'</span><span class="token punctuation">(</span>第二个字符是t<span class="token punctuation">)</span>排序:    <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> cat <span class="token keyword">order</span> <span class="token keyword">by</span> <span class="token keyword">asc</span>  默认升序<span class="token punctuation">(</span>是个子句，前面可以不加<span class="token keyword">where</span><span class="token punctuation">)</span>    <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> cat <span class="token keyword">order</span> <span class="token keyword">by</span> <span class="token keyword">desc</span>   降序显示指定的条数<span class="token punctuation">(</span>修改、删除只能<span class="token number">1</span>个参数<span class="token punctuation">)</span>:<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> cat <span class="token keyword">limit</span> <span class="token number">3</span> <span class="token punctuation">(</span><span class="token keyword">limit</span>需要在后面<span class="token punctuation">)</span><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> cat <span class="token keyword">where</span> age <span class="token operator">>=</span><span class="token number">18</span> <span class="token keyword">limit</span> <span class="token number">3</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> cat <span class="token keyword">where</span> age <span class="token operator">>=</span><span class="token number">18</span> <span class="token keyword">order</span> <span class="token keyword">by</span> <span class="token keyword">desc</span> <span class="token keyword">limit</span> <span class="token number">3</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> cat <span class="token keyword">where</span> age <span class="token operator">>=</span><span class="token number">18</span> <span class="token keyword">order</span> <span class="token keyword">by</span> <span class="token keyword">desc</span> <span class="token keyword">limit</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">(</span>从索引<span class="token number">1</span>开始，取<span class="token number">2</span>条<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="Mysql-语法及分类"><a href="#Mysql-语法及分类" class="headerlink" title="Mysql 语法及分类"></a>Mysql 语法及分类</h2><ul><li>DDL: 数据定义语言，用来定义数据库对象（数据库、表、字段）</li><li>DML: 数据操作语言，用来对数据库表中的数据进行增删改</li><li>DQL: 数据查询语言，用来查询数据库中表的记录</li><li>DCL: 数据控制语言，用来创建数据库用户、控制数据库的控制权限</li></ul><h3 id="一、DDL"><a href="#一、DDL" class="headerlink" title="一、DDL"></a>一、DDL</h3><h4 id="1、创建数据库"><a href="#1、创建数据库" class="headerlink" title="1、创建数据库"></a>1、创建数据库</h4><blockquote><p>UTF8字符集长度为3字节，有些符号占4字节，所以推荐用utf8mb4字符集</p></blockquote><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">create</span> <span class="token keyword">database</span> t1<span class="token punctuation">;</span><span class="token keyword">create</span> <span class="token keyword">database</span> t1 <span class="token keyword">charset</span><span class="token operator">=</span><span class="token string">"utf8mb4"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h4 id="2、查看数据库"><a href="#2、查看数据库" class="headerlink" title="2、查看数据库"></a>2、查看数据库</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">-- 查询所有数据库</span><span class="token keyword">show</span> <span class="token keyword">databases</span><span class="token punctuation">;</span> <span class="token comment">-- 查询当前数据库</span><span class="token keyword">select</span> <span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h4 id="3、使用数据库"><a href="#3、使用数据库" class="headerlink" title="3、使用数据库"></a>3、使用数据库</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">use</span> t1<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="4、删除数据库"><a href="#4、删除数据库" class="headerlink" title="4、删除数据库"></a>4、删除数据库</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">drop</span> <span class="token keyword">database</span> <span class="token punctuation">[</span><span class="token keyword">if</span> <span class="token keyword">exists</span><span class="token punctuation">]</span> t1<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="5、查看表"><a href="#5、查看表" class="headerlink" title="5、查看表"></a>5、查看表</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">show</span> <span class="token keyword">tables</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="6、创建表"><a href="#6、创建表" class="headerlink" title="6、创建表"></a>6、创建表</h4><pre class="line-numbers language-mysql" data-language="mysql"><code class="language-mysql">create table cat(name varchar(20),age int,type varchar(20));<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li>最后一个字段后面没有逗号</li></ul><h4 id="7、查询表结构"><a href="#7、查询表结构" class="headerlink" title="7、查询表结构"></a>7、查询表结构</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">desc</span> <span class="token operator">&lt;</span>表名<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="二、DML"><a href="#二、DML" class="headerlink" title="二、DML"></a>二、DML</h3><h4 id="1、插入数据"><a href="#1、插入数据" class="headerlink" title="1、插入数据"></a>1、插入数据</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">insert</span> <span class="token keyword">into</span> cat <span class="token keyword">values</span><span class="token punctuation">(</span>“tomcat”<span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span>”test”<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">insert</span> <span class="token keyword">into</span> cat<span class="token punctuation">(</span>name<span class="token punctuation">,</span>age<span class="token punctuation">,</span><span class="token keyword">type</span><span class="token punctuation">)</span> <span class="token keyword">values</span><span class="token punctuation">(</span>“tomcat”<span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span>”string”<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token boolean">null</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">"int"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>注意点：</p><ul><li>顺序保存一致</li><li>类型保持一致</li><li>个数保存一致</li><li>字符串和日期类型数据应该包含在引号中</li><li>插入的数据大小应该在字段的规定范围内</li></ul><h4 id="2、修改数据"><a href="#2、修改数据" class="headerlink" title="2、修改数据"></a>2、修改数据</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">update</span> cat <span class="token keyword">set</span> age <span class="token operator">=</span> <span class="token number">3</span> <span class="token keyword">where</span> name <span class="token operator">=</span> <span class="token string">"1"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="3、删除数据"><a href="#3、删除数据" class="headerlink" title="3、删除数据"></a>3、删除数据</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">delete</span> <span class="token keyword">from</span> cat <span class="token keyword">where</span> name <span class="token operator">=</span> “<span class="token number">1</span>”<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="三、DQL"><a href="#三、DQL" class="headerlink" title="三、DQL"></a>三、DQL</h3><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">select</span>字段列表<span class="token keyword">from</span>表名字段<span class="token keyword">where</span>条件列表<span class="token keyword">group</span> <span class="token keyword">by</span>分组字段列表<span class="token keyword">having</span>分组后的条件列表<span class="token keyword">order</span> <span class="token keyword">by</span>排序字段列表<span class="token keyword">limit</span>分页参数<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="四、DCL"><a href="#四、DCL" class="headerlink" title="四、DCL"></a>四、DCL</h3><h4 id="管理用户"><a href="#管理用户" class="headerlink" title="管理用户"></a>管理用户</h4><p>查询用户：</p><pre class="line-numbers language-mysql" data-language="mysql"><code class="language-mysql">use mysql;select * from user;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>创建用户:<br><code>create user &#39;用户名&#39;@&#39;主机名&#39; identified by &#39;密码&#39;;</code></p><p>修改用户密码：<br><code>alter user &#39;用户名&#39;@&#39;主机名&#39; identified with mysql_native_password by &#39;新密码&#39;;</code></p><p>删除用户：<br><code>drop user &#39;用户名&#39;@&#39;主机名&#39;;</code></p><p>例子：</p><pre class="line-numbers language-mysql" data-language="mysql"><code class="language-mysql">-- 创建用户test，只能在当前主机localhost访问create user &#39;test&#39;@&#39;localhost&#39; identified by &#39;123456&#39;;-- 创建用户test，能在任意主机访问create user &#39;test&#39;@&#39;%&#39; identified by &#39;123456&#39;;create user &#39;test&#39; identified by &#39;123456&#39;;-- 修改密码alter user &#39;test&#39;@&#39;localhost&#39; identified with mysql_native_password by &#39;1234&#39;;-- 删除用户drop user &#39;test&#39;@&#39;localhost&#39;;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h5 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h5><ul><li>主机名可以使用 % 通配</li></ul><h4 id="权限控制"><a href="#权限控制" class="headerlink" title="权限控制"></a>权限控制</h4><p>常用权限：</p><table><thead><tr><th>权限</th><th>说明</th></tr></thead><tbody><tr><td>all,all privileges</td><td>所有权限</td></tr><tr><td>select</td><td>查询数据</td></tr><tr><td>insert</td><td>插入数据</td></tr><tr><td>update</td><td>修改数据</td></tr><tr><td>delete</td><td>删除数据</td></tr><tr><td>alter</td><td>修改表</td></tr><tr><td>dpop</td><td>删除数据库&#x2F;表&#x2F;视图</td></tr><tr><td>create</td><td>创建数据库&#x2F;表</td></tr></tbody></table><p>查询权限：<br><code>show grants for&#39;用户名&#39;@&#39;主机名&#39;;</code></p><p>授予权限：<br><code>grant 权限列表 on 数据库名.表名 to &#39;用户名&#39;@&#39;主机名&#39;;</code></p><p>撤销权限：<br><code>revoke 权限列表 on 数据库名.表名 from &#39;用户名&#39;@&#39;主机名&#39;;</code></p><h5 id="注意事项-1"><a href="#注意事项-1" class="headerlink" title="注意事项"></a>注意事项</h5><ul><li>多个权限用逗号分隔</li><li>授权时，数据库名和表名可以用 * 进行通配，代表所有</li></ul><h2 id="Mysql-函数"><a href="#Mysql-函数" class="headerlink" title="Mysql 函数"></a>Mysql 函数</h2><h3 id="一、Mysql-方法"><a href="#一、Mysql-方法" class="headerlink" title="一、Mysql 方法"></a>一、Mysql 方法</h3><h4 id="1、数值类型方法"><a href="#1、数值类型方法" class="headerlink" title="1、数值类型方法"></a>1、数值类型方法</h4><ul><li>pow()</li><li>pi()</li><li>floor()</li><li>ceil()</li><li>rand() 0-1之间</li></ul><h4 id="2、字符串类型方法"><a href="#2、字符串类型方法" class="headerlink" title="2、字符串类型方法"></a>2、字符串类型方法</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">-- 拼接,字符串拼接，将s1, s2, ..., sn拼接成一个字符串</span><span class="token keyword">select</span> concat<span class="token punctuation">(</span><span class="token string">'Hello'</span><span class="token punctuation">,</span> <span class="token string">'World'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">-- 小写,将字符串全部转为小写</span><span class="token keyword">select</span> lower<span class="token punctuation">(</span><span class="token string">'Hello'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">-- 大写,将字符串全部转为大写</span><span class="token keyword">select</span> upper<span class="token punctuation">(</span><span class="token string">'Hello'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">-- 左填充,用字符串pad对str的左边进行填充，达到n个字符串长度</span><span class="token keyword">select</span> lpad<span class="token punctuation">(</span><span class="token string">'01'</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token string">'-'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">-- 右填充，用字符串pad对str的右边进行填充，达到n个字符串长度</span><span class="token keyword">select</span> rpad<span class="token punctuation">(</span><span class="token string">'01'</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token string">'-'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">-- 去除空格,去掉字符串头部和尾部的空格</span><span class="token keyword">select</span> trim<span class="token punctuation">(</span><span class="token string">' Hello World '</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">-- 切片（起始索引为1）,返回从字符串str从start位置起的len个长度的字符串</span><span class="token keyword">select</span> substring<span class="token punctuation">(</span><span class="token string">'Hello World'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="3、日期类型方法"><a href="#3、日期类型方法" class="headerlink" title="3、日期类型方法"></a>3、日期类型方法</h4><ul><li>now()</li><li>curdate()</li><li>curtime()</li></ul><h3 id="二、Mysql聚合函数"><a href="#二、Mysql聚合函数" class="headerlink" title="二、Mysql聚合函数"></a>二、Mysql聚合函数</h3><ul><li>min(&lt;列名&gt;)</li><li>max(&lt;列名&gt;)</li><li>sum(&lt;列名&gt;)</li><li>avg(&lt;列名&gt;)        空值不计入运算</li><li>count(&lt;列名&gt;)    空值不计入运算</li><li>if(10&gt;2,1,2) 如果true为1,false为2</li></ul><h3 id="三、Mysql分组查询"><a href="#三、Mysql分组查询" class="headerlink" title="三、Mysql分组查询"></a>三、Mysql分组查询</h3><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">group</span> <span class="token keyword">by</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token keyword">having</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token keyword">select</span> <span class="token keyword">type</span><span class="token punctuation">,</span><span class="token function">avg</span><span class="token punctuation">(</span>age<span class="token punctuation">)</span> <span class="token keyword">from</span> cat <span class="token keyword">group</span> <span class="token keyword">by</span> <span class="token keyword">type</span> <span class="token keyword">having</span> <span class="token function">avg</span><span class="token punctuation">(</span>age<span class="token punctuation">)</span><span class="token operator">>=</span><span class="token number">5</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>Mysql关键字的顺序如下</p><p>依次为<code>where,group by...having...,order by,limit</code></p><h2 id="Mysql-约束"><a href="#Mysql-约束" class="headerlink" title="Mysql 约束"></a>Mysql 约束</h2><h3 id="一、Mysql约束"><a href="#一、Mysql约束" class="headerlink" title="一、Mysql约束"></a>一、Mysql约束</h3><table><thead><tr><th>约束</th><th>描述</th><th>关键字</th></tr></thead><tbody><tr><td>非空约束</td><td>限制该字段的数据不能为null</td><td>not null</td></tr><tr><td>唯一约束</td><td>保证该字段的所有数据都是唯一、不重复的</td><td>unique</td></tr><tr><td>主键约束</td><td>主键是一行数据的唯一标识，要求非空且唯一</td><td>primary key</td></tr><tr><td>默认约束</td><td>保存数据时，如果未指定该字段的值，则采用默认值</td><td>default</td></tr><tr><td>外键约束</td><td>用来让两张图的数据之间建立连接，保证数据的一致性和完整性</td><td>foreign key</td></tr><tr><td>检查约束（8.0.1版本后）</td><td>保证字段值满足某一个条件</td><td>check</td></tr></tbody></table><p>约束是作用于表中字段上的，可以再创建表&#x2F;修改表的时候添加约束。</p><h3 id="二、Mysql的三范式"><a href="#二、Mysql的三范式" class="headerlink" title="二、Mysql的三范式"></a>二、Mysql的三范式</h3><h4 id="1、第一范式"><a href="#1、第一范式" class="headerlink" title="1、第一范式"></a>1、第一范式</h4><p>数据库表中的所有字段值都是不可分解的原子值</p><h4 id="2、第二范式"><a href="#2、第二范式" class="headerlink" title="2、第二范式"></a>2、第二范式</h4><p>一个表只具有相同特征和行为的一类事物的值，保证一张表只描述一件事情</p><h4 id="3、第三范式"><a href="#3、第三范式" class="headerlink" title="3、第三范式"></a>3、第三范式</h4><p>表中的字段和主键直接对应不依靠其他中间字段，不存在依赖传递，决定某字段值的必须是主键</p><h2 id="Mysql-多表查询"><a href="#Mysql-多表查询" class="headerlink" title="Mysql 多表查询"></a>Mysql 多表查询</h2><h3 id="一、Mysql表连接"><a href="#一、Mysql表连接" class="headerlink" title="一、Mysql表连接"></a>一、Mysql表连接</h3><h4 id="1、内连接"><a href="#1、内连接" class="headerlink" title="1、内连接"></a>1、内连接</h4><p>两个表中满足条件的数据进行展示，不满足条件的不进行展示，两种写法</p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token number">1</span>、<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> a<span class="token punctuation">,</span>b <span class="token keyword">where</span> a<span class="token punctuation">.</span>name <span class="token operator">=</span> b<span class="token punctuation">.</span>name<span class="token number">2</span>、<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> a <span class="token keyword">inner</span> <span class="token keyword">join</span> b <span class="token keyword">on</span> a<span class="token punctuation">.</span>name <span class="token operator">=</span> b<span class="token punctuation">.</span>name<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h4 id="2、外连接"><a href="#2、外连接" class="headerlink" title="2、外连接"></a>2、外连接</h4><p>(1) 左外连接 主表 left 从表 </p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> a <span class="token keyword">left</span> <span class="token keyword">outer</span> <span class="token keyword">join</span> b <span class="token keyword">on</span> a<span class="token punctuation">.</span>name <span class="token operator">=</span> b<span class="token punctuation">.</span>name<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>(2)右外连接 从表 right 主表</p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> b <span class="token keyword">right</span> <span class="token keyword">outer</span> <span class="token keyword">join</span> a <span class="token keyword">on</span> a<span class="token punctuation">.</span>name <span class="token operator">=</span> b<span class="token punctuation">.</span>name<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="3、自连接"><a href="#3、自连接" class="headerlink" title="3、自连接"></a>3、自连接</h4><p>当前表与自身的连接查询，自连接必须使用表别名</p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">-- 查询员工及其所属领导的名字</span><span class="token keyword">select</span> a<span class="token punctuation">.</span>name<span class="token punctuation">,</span> b<span class="token punctuation">.</span>name <span class="token keyword">from</span> employee a<span class="token punctuation">,</span> employee b <span class="token keyword">where</span> a<span class="token punctuation">.</span>manager <span class="token operator">=</span> b<span class="token punctuation">.</span>id<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="Mysql-事务"><a href="#Mysql-事务" class="headerlink" title="Mysql 事务"></a>Mysql 事务</h2><h3 id="一、Mysql事务"><a href="#一、Mysql事务" class="headerlink" title="一、Mysql事务"></a>一、Mysql事务</h3><h4 id="1、事务语法"><a href="#1、事务语法" class="headerlink" title="1、事务语法"></a>1、事务语法</h4><pre class="line-numbers language-none"><code class="language-none">begin;...commit;rollback;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h4 id="2、事务的特性ACID"><a href="#2、事务的特性ACID" class="headerlink" title="2、事务的特性ACID"></a>2、事务的特性ACID</h4><ul><li>原子性(Atomicity)：事务是不可分割的最小操作单元，要么全部成功，要么全部失败</li><li>一致性(Consistency)：事务完成时，必须使所有数据都保持一致状态</li><li>隔离性(Isolation)：数据库系统提供的隔离机制，保证事务在不受外部并发操作影响的独立环境下运行</li><li>持久性(Durability)：事务一旦提交或回滚，它对数据库中的数据的改变就是永久的</li></ul><h4 id="3、事务的隔离级别"><a href="#3、事务的隔离级别" class="headerlink" title="3、事务的隔离级别"></a>3、事务的隔离级别</h4><p>Mysql的默认的隔离级别为可重复读，InnoDB已经消除了幻读</p><table><thead><tr><th>问题</th><th>描述</th></tr></thead><tbody><tr><td>脏读</td><td>一个事务读到另一个事务还没提交的数据</td></tr><tr><td>不可重复读</td><td>一个事务先后读取同一条记录，但两次读取的数据不同</td></tr><tr><td>幻读</td><td>一个事务按照条件查询数据时，没有对应的数据行，但是再插入数据时，又发现这行数据已经存在</td></tr></tbody></table><blockquote><p>这三个问题的详细演示：<a href="https://www.bilibili.com/video/BV1Kr4y1i7ru?p=55cd">https://www.bilibili.com/video/BV1Kr4y1i7ru?p=55cd</a> </p></blockquote><p>并发事务隔离级别：</p><table><thead><tr><th></th><th>隔离级别</th><th>脏读</th><th>不可重复读</th><th>幻读</th></tr></thead><tbody><tr><td>读未提交</td><td>Read uncommitted</td><td>√</td><td>√</td><td>√</td></tr><tr><td>读已提交</td><td>Read committed</td><td>×</td><td>√</td><td>√</td></tr><tr><td>可重复读</td><td>Repeatable Read(默认)</td><td>×</td><td>×</td><td>√</td></tr><tr><td>串行化</td><td>Serializable</td><td>×</td><td>×</td><td>×</td></tr></tbody></table><ul><li>√表示在当前隔离级别下该问题会出现</li><li>Serializable 性能最低；Read uncommitted 性能最高，数据安全性最差</li></ul><p>查看事务隔离级别：<br><code>SELECT @@TRANSACTION_ISOLATION;</code></p><p>设置事务隔离级别：<br><code>SET [ SESSION | GLOBAL ] TRANSACTION ISOLATION LEVEL &#123;READ UNCOMMITTED | READ COMMITTED | REPEATABLE READ | SERIALIZABLE &#125;;</code><br>SESSION 是会话级别，表示只针对当前会话有效，GLOBAL 表示对所有会话有效</p><h2 id="Mysql-视图"><a href="#Mysql-视图" class="headerlink" title="Mysql 视图"></a>Mysql 视图</h2><h3 id="一、Mysql视图"><a href="#一、Mysql视图" class="headerlink" title="一、Mysql视图"></a>一、Mysql视图</h3><p>1、不能在视图中删除、添加、修改</p><p>2、视图基于表存在，若表中数据被清理，则视图不能打开。若添加数据满足连接条件，则视图中也会进行展示。</p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">create</span> <span class="token keyword">view</span> <span class="token operator">&lt;</span>视图名<span class="token operator">></span> <span class="token keyword">as</span> <span class="token keyword">select</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">(</span>查询的结果<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="Mysql-索引"><a href="#Mysql-索引" class="headerlink" title="Mysql 索引"></a>Mysql 索引</h2><h3 id="一、索引创建"><a href="#一、索引创建" class="headerlink" title="一、索引创建"></a>一、索引创建</h3><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">create</span> <span class="token keyword">index</span> <span class="token operator">&lt;</span>索引名<span class="token operator">></span> <span class="token keyword">on</span> <span class="token operator">&lt;</span>表名<span class="token operator">></span><span class="token punctuation">(</span><span class="token operator">&lt;</span>字段名<span class="token operator">></span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>查看效率</p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">explain</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token operator">&lt;</span>表名<span class="token operator">></span> <span class="token keyword">where</span> id <span class="token operator">=</span> <span class="token number">1</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>索引字段表格含义</p><table><thead><tr><th>select_type</th><th>type</th><th>possible_keys</th><th>key</th><th>key_len</th><th>rows</th><th>Extra</th></tr></thead><tbody><tr><td>查询的类型</td><td>获取方式</td><td>可能索引</td><td>真正索引</td><td>索引所占空间</td><td>搜索条数</td><td>其他</td></tr></tbody></table><p>详细索引字段表格含义</p><ul><li><strong>id 执行编号</strong> 标识select所属的行。如果在语句中没子查询或关联查询，只有唯一的select，每行都将显示1。否则，内层的select语句一般会顺序编号，对应于其在原始语句中的位置</li><li><strong>select_type</strong>  显示本行是简单或复杂查询。<ul><li>如果查询有任何复杂的子查询，则最外层标记为PRIMARY(DERIVED、UNION、UNION RESUlT)</li></ul></li><li><strong>table</strong> 访问哪个表</li><li><strong>type</strong> 数据访问&#x2F;读取操作类型<ul><li>(ALL、index、range、ref、eq_ref、const&#x2F;system、NULL)</li></ul></li><li><strong>possible_keys</strong> 揭示哪一些索引可能有利于高效的查找</li><li><strong>key</strong> 显示Mysql最终采用哪个索引来优化查询</li><li><strong>key_len</strong> 显示mysql在索引里使用的字节数</li><li><strong>ref</strong> 显示了之前的表在key列记录的索引中查找值所用的列或常量</li><li><strong>rows</strong> 为了找到所需的行而需要读取的行数，估算值，不精确。通过把所有rows列值相乘，可粗略估算整个查询会检查的行数</li><li><strong>Extra</strong> 额外信息，如using index、filesort等</li></ul><h3 id="二、使用规则"><a href="#二、使用规则" class="headerlink" title="二、使用规则"></a>二、使用规则</h3><h4 id="1、最左前缀法则"><a href="#1、最左前缀法则" class="headerlink" title="1、最左前缀法则"></a>1、最左前缀法则</h4><p>如果索引关联了多列（联合索引），要遵守最左前缀法则，最左前缀法则指的是查询从索引的最左列开始，并且不跳过索引中的列。<br>如果跳跃某一列，索引将部分失效（后面的字段索引失效）。</p><p>联合索引中，出现范围查询（&lt;, &gt;），范围查询右侧的列索引失效。可以用&gt;&#x3D;或者&lt;&#x3D;来规避索引失效问题。</p><h4 id="2、索引失效情况"><a href="#2、索引失效情况" class="headerlink" title="2、索引失效情况"></a>2、索引失效情况</h4><ol><li>在索引列上进行运算操作，索引将失效。如：<code>explain select * from tb_user where substring(phone, 10, 2) = &#39;15&#39;;</code></li><li>字符串类型字段使用时，不加引号，索引将失效。如：<code>explain select * from tb_user where phone = 17799990015;</code>，此处phone的值没有加引号</li><li>模糊查询中，如果仅仅是尾部模糊匹配，索引不会是失效；如果是头部模糊匹配，索引失效。如：<code>explain select * from tb_user where profession like &#39;%工程&#39;;</code>，前后都有 % 也会失效。</li><li>用 or 分割开的条件，如果 or 其中一个条件的列没有索引，那么涉及的索引都不会被用到。</li><li>如果 MySQL 评估使用索引比全表更慢，则不使用索引。</li></ol><h4 id="3、SQL-提示"><a href="#3、SQL-提示" class="headerlink" title="3、SQL 提示"></a>3、SQL 提示</h4><p>是优化数据库的一个重要手段，简单来说，就是在SQL语句中加入一些人为的提示来达到优化操作的目的。</p><p>例如，使用索引：<br><code>explain select * from tb_user use index(idx_user_pro) where profession=&quot;软件工程&quot;;</code><br>不使用哪个索引：<br><code>explain select * from tb_user ignore index(idx_user_pro) where profession=&quot;软件工程&quot;;</code><br>必须使用哪个索引：<br><code>explain select * from tb_user force index(idx_user_pro) where profession=&quot;软件工程&quot;;</code></p><p>use 是建议，实际使用哪个索引 MySQL 还会自己权衡运行速度去更改，force就是无论如何都强制使用该索引。</p><h4 id="4、覆盖索引-amp-回表查询"><a href="#4、覆盖索引-amp-回表查询" class="headerlink" title="4、覆盖索引&amp;回表查询"></a>4、覆盖索引&amp;回表查询</h4><p>尽量使用覆盖索引（查询使用了索引，并且需要返回的列，在该索引中已经全部能找到），减少 select *。</p><p>explain 中 extra 字段含义：<br><code>using index condition</code>：查找使用了索引，但是需要回表查询数据<br><code>using where; using index;</code>：查找使用了索引，但是需要的数据都在索引列中能找到，所以不需要回表查询</p><p>如果在聚集索引中直接能找到对应的行，则直接返回行数据，只需要一次查询，哪怕是select *；如果在辅助索引中找聚集索引，如<code>select id, name from xxx where name=&#39;xxx&#39;;</code>，也只需要通过辅助索引(name)查找到对应的id，返回name和name索引对应的id即可，只需要一次查询；如果是通过辅助索引查找其他字段，则需要回表查询，如<code>select id, name, gender from xxx where name=&#39;xxx&#39;;</code></p><p>所以尽量不要用<code>select *</code>，容易出现回表查询，降低效率，除非有联合索引包含了所有字段</p><p>面试题：一张表，有四个字段（id, username, password, status），由于数据量大，需要对以下SQL语句进行优化，该如何进行才是最优方案：<br><code>select id, username, password from tb_user where username=&#39;itcast&#39;;</code></p><p>解：给username和password字段建立联合索引，则不需要回表查询，直接覆盖索引</p><h4 id="5、前缀索引"><a href="#5、前缀索引" class="headerlink" title="5、前缀索引"></a>5、前缀索引</h4><p>当字段类型为字符串（varchar, text等）时，有时候需要索引很长的字符串，这会让索引变得很大，查询时，浪费大量的磁盘IO，影响查询效率，此时可以只降字符串的一部分前缀，建立索引，这样可以大大节约索引空间，从而提高索引效率。</p><p>语法：<code>create index idx_xxxx on table_name(columnn(n));</code><br>前缀长度：可以根据索引的选择性来决定，而选择性是指不重复的索引值（基数）和数据表的记录总数的比值，索引选择性越高则查询效率越高，唯一索引的选择性是1，这是最好的索引选择性，性能也是最好的。<br>求选择性公式：</p><pre class="line-numbers language-mysql" data-language="mysql"><code class="language-mysql">select count(distinct email) &#x2F; count(*) from tb_user;select count(distinct substring(email, 1, 5)) &#x2F; count(*) from tb_user;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>show index 里面的sub_part可以看到接取的长度</p><h4 id="6、单列索引-amp-联合索引"><a href="#6、单列索引-amp-联合索引" class="headerlink" title="6、单列索引&amp;联合索引"></a>6、单列索引&amp;联合索引</h4><p>单列索引：即一个索引只包含单个列<br>联合索引：即一个索引包含了多个列<br>在业务场景中，如果存在多个查询条件，考虑针对于查询字段建立索引时，建议建立联合索引，而非单列索引。</p><p>单列索引情况：<br><code>explain select id, phone, name from tb_user where phone = &#39;17799990010&#39; and name = &#39;韩信&#39;;</code><br>这句只会用到phone索引字段</p><h5 id="注意事项-2"><a href="#注意事项-2" class="headerlink" title="注意事项"></a>注意事项</h5><ul><li>多条件联合查询时，MySQL优化器会评估哪个字段的索引效率更高，会选择该索引完成本次查询</li></ul><h3 id="三、设计原则"><a href="#三、设计原则" class="headerlink" title="三、设计原则"></a>三、设计原则</h3><ol><li>针对于数据量较大，且查询比较频繁的表建立索引</li><li>针对于常作为查询条件（where）、排序（order by）、分组（group by）操作的字段建立索引</li><li>尽量选择区分度高的列作为索引，尽量建立唯一索引，区分度越高，使用索引的效率越高</li><li>如果是字符串类型的字段，字段长度较长，可以针对于字段的特点，建立前缀索引</li><li>尽量使用联合索引，减少单列索引，查询时，联合索引很多时候可以覆盖索引，节省存储空间，避免回表，提高查询效率</li><li>要控制索引的数量，索引并不是多多益善，索引越多，维护索引结构的代价就越大，会影响增删改的效率</li><li>如果索引列不能存储NULL值，请在创建表时使用NOT NULL约束它。当优化器知道每列是否包含NULL值时，它可以更好地确定哪个索引最有效地用于查询</li></ol><h3 id="四、索引结构"><a href="#四、索引结构" class="headerlink" title="四、索引结构"></a>四、索引结构</h3><table><thead><tr><th>索引结构</th><th>描述</th></tr></thead><tbody><tr><td>B+Tree</td><td>最常见的索引类型，大部分引擎都支持B+树索引</td></tr><tr><td>Hash</td><td>底层数据结构是用哈希表实现，只有精确匹配索引列的查询才有效，不支持范围查询</td></tr><tr><td>R-Tree(空间索引)</td><td>空间索引是 MyISAM 引擎的一个特殊索引类型，主要用于地理空间数据类型，通常使用较少</td></tr><tr><td>Full-Text(全文索引)</td><td>是一种通过建立倒排索引，快速匹配文档的方式，类似于 Lucene, Solr, ES</td></tr></tbody></table><hr><table><thead><tr><th>索引</th><th>InnoDB</th><th>MyISAM</th><th>Memory</th></tr></thead><tbody><tr><td>B+Tree索引</td><td>支持</td><td>支持</td><td>支持</td></tr><tr><td>Hash索引</td><td>不支持</td><td>不支持</td><td>支持</td></tr><tr><td>R-Tree索引</td><td>不支持</td><td>支持</td><td>不支持</td></tr><tr><td>Full-text</td><td>5.6版本后支持</td><td>支持</td><td>不支持</td></tr></tbody></table><h4 id="1、B-Tree"><a href="#1、B-Tree" class="headerlink" title="1、B-Tree"></a>1、B-Tree</h4><img src="https://dhc.pythonanywhere.com/media/editor/二叉树_20220316153214227108.png" alt="二叉树" title="二叉树" style="zoom:50%;box-shadow:rgba(0,0,0,0) 0 1px 5px 0px;" /><p>二叉树的缺点可以用红黑树来解决：</p><img src="https://dhc.pythonanywhere.com/media/editor/红黑树_20220316163142686602.png" alt="红黑树" title="红黑树" style="zoom:50%;box-shadow:rgba(0,0,0,0) 0 1px 5px 0px;" /><p>红黑树也存在大数据量情况下，层级较深，检索速度慢的问题。</p><p>为了解决上述问题，可以使用 B-Tree 结构。<br>B-Tree (多路平衡查找树) 以一棵最大度数（max-degree，指一个节点的子节点个数）为5（5阶）的 b-tree 为例（每个节点最多存储4个key，5个指针）</p><img src="https://dhc.pythonanywhere.com/media/editor/B-Tree结构_20220316163813441163.png" alt="B-Tree结构" style="zoom:67%;box-shadow:rgba(0,0,0,0) 0 1px 5px 0px;" /><blockquote><p>B-Tree 的数据插入过程动画参照：<a href="https://www.bilibili.com/video/BV1Kr4y1i7ru?p=68">https://www.bilibili.com/video/BV1Kr4y1i7ru?p=68</a><br>演示地址：<a href="https://www.cs.usfca.edu/~galles/visualization/BTree.html">https://www.cs.usfca.edu/~galles/visualization/BTree.html</a></p></blockquote><h4 id="2、B-Tree"><a href="#2、B-Tree" class="headerlink" title="2、B+Tree"></a>2、B+Tree</h4><p>结构图：</p><img src="https://dhc.pythonanywhere.com/media/editor/B+Tree结构图_20220316170700591277.png" alt="B+Tree结构图" style="zoom:67%;box-shadow:rgba(0,0,0,0) 0 1px 5px 0px;" /><blockquote><p>演示地址：<a href="https://www.cs.usfca.edu/~galles/visualization/BPlusTree.html">https://www.cs.usfca.edu/~galles/visualization/BPlusTree.html</a></p></blockquote><p>与 B-Tree 的区别：</p><ul><li>所有的数据都会出现在叶子节点</li><li>叶子节点形成一个单向链表</li></ul><p>MySQL 索引数据结构对经典的 B+Tree 进行了优化。在原 B+Tree 的基础上，增加一个指向相邻叶子节点的链表指针，就形成了带有顺序指针的 B+Tree，提高区间访问的性能。</p><img src="https://dhc.pythonanywhere.com/media/editor/结构图_20220316171730865611.png" alt="MySQL B+Tree 结构图" style="zoom:67%;box-shadow:rgba(0,0,0,0) 0 1px 5px 0px;" /><h4 id="3、Hash"><a href="#3、Hash" class="headerlink" title="3、Hash"></a>3、Hash</h4><p>哈希索引就是采用一定的hash算法，将键值换算成新的hash值，映射到对应的槽位上，然后存储在hash表中。<br>如果两个（或多个）键值，映射到一个相同的槽位上，他们就产生了hash冲突（也称为hash碰撞），可以通过链表来解决。</p><img src="https://dhc.pythonanywhere.com/media/editor/Hash索引原理图_20220317143226150679.png" alt="Hash索引原理图" style="zoom: 50%; box-shadow: rgba(0, 0, 0, 0) 0px 1px 5px 0px;" /><p>特点：</p><ul><li>Hash索引只能用于对等比较（&#x3D;、in），不支持范围查询（betwwn、&gt;、&lt;、…）</li><li>无法利用索引完成排序操作</li><li>查询效率高，通常只需要一次检索就可以了，效率通常要高于 B+Tree 索引</li></ul><p>存储引擎支持：</p><ul><li>Memory</li><li>InnoDB: 具有自适应hash功能，hash索引是存储引擎根据 B+Tree 索引在指定条件下自动构建的</li></ul><h4 id="4、面试题"><a href="#4、面试题" class="headerlink" title="4、面试题"></a>4、面试题</h4><ol><li>为什么 InnoDB 存储引擎选择使用 B+Tree 索引结构？</li></ol><ul><li>相对于二叉树，层级更少，搜索效率高</li><li>对于 B-Tree，无论是叶子节点还是非叶子节点，都会保存数据，这样导致一页中存储的键值减少，指针也跟着减少，要同样保存大量数据，只能增加树的高度，导致性能降低</li><li>相对于 Hash 索引，B+Tree 支持范围匹配及排序操作</li></ul><h3 id="五、索引分类"><a href="#五、索引分类" class="headerlink" title="五、索引分类"></a>五、索引分类</h3><table><thead><tr><th>分类</th><th>含义</th><th>特点</th><th>关键字</th></tr></thead><tbody><tr><td>主键索引</td><td>针对于表中主键创建的索引</td><td>默认自动创建，只能有一个</td><td>PRIMARY</td></tr><tr><td>唯一索引</td><td>避免同一个表中某数据列中的值重复</td><td>可以有多个</td><td>UNIQUE</td></tr><tr><td>常规索引</td><td>快速定位特定数据</td><td>可以有多个</td><td></td></tr><tr><td>全文索引</td><td>全文索引查找的是文本中的关键词，而不是比较索引中的值</td><td>可以有多个</td><td>FULLTEXT</td></tr></tbody></table><p>在 InnoDB 存储引擎中，根据索引的存储形式，又可以分为以下两种：</p><table><thead><tr><th>分类</th><th>含义</th><th>特点</th></tr></thead><tbody><tr><td>聚集索引(Clustered Index)</td><td>将数据存储与索引放一块，索引结构的叶子节点保存了行数据</td><td>必须有，而且只有一个</td></tr><tr><td>二级索引(Secondary Index)</td><td>将数据与索引分开存储，索引结构的叶子节点关联的是对应的主键</td><td>可以存在多个</td></tr></tbody></table><p>演示图：</p><img src="https://dhc.pythonanywhere.com/media/editor/原理图_20220318194454880073.png" alt="大致原理" style="zoom: 50%; box-shadow: rgba(0, 0, 0, 0) 0px 1px 5px 0px;" /><img src="https://dhc.pythonanywhere.com/media/editor/演示图_20220319215403721066.png" alt="演示图" title="演示图" style="zoom: 50%; box-shadow: rgba(0, 0, 0, 0) 0px 1px 5px 0px;" /><p>聚集索引选取规则：</p><ul><li>如果存在主键，主键索引就是聚集索引</li><li>如果不存在主键，将使用第一个唯一(UNIQUE)索引作为聚集索引</li><li>如果表没有主键或没有合适的唯一索引，则 InnoDB 会自动生成一个 rowid 作为隐藏的聚集索引</li></ul><p><strong>思考题</strong></p><p>1. 以下 SQL 语句，哪个执行效率高？为什么？</p><pre class="line-numbers language-mysql" data-language="mysql"><code class="language-mysql">select * from user where id &#x3D; 10;select * from user where name &#x3D; &#39;Arm&#39;;-- 备注：id为主键，name字段创建的有索引<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>答：第一条语句，因为第二条需要回表查询，相当于两个步骤。</p><p>2. InnoDB 主键索引的 B+Tree 高度为多少？</p><p>答：假设一行数据大小为1k，一页中可以存储16行这样的数据。InnoDB 的指针占用6个字节的空间，主键假设为bigint，占用字节数为8.<br>可得公式：<code>n * 8 + (n + 1) * 6 = 16 * 1024</code>，其中 8 表示 bigint 占用的字节数，n 表示当前节点存储的key的数量，(n + 1) 表示指针数量（比key多一个）。算出n约为1170。</p><p>如果树的高度为2，那么他能存储的数据量大概为：<code>1171 * 16 = 18736</code>；<br>如果树的高度为3，那么他能存储的数据量大概为：<code>1171 * 1171 * 16 = 21939856</code>。</p><h2 id="SQL-优化"><a href="#SQL-优化" class="headerlink" title="SQL 优化"></a>SQL 优化</h2><h3 id="一、插入数据"><a href="#一、插入数据" class="headerlink" title="一、插入数据"></a>一、插入数据</h3><p>普通插入：</p><ol><li>采用批量插入（一次插入的数据不建议超过1000条）</li><li>手动提交事务</li><li>主键顺序插入</li></ol><p>大批量插入：<br>如果一次性需要插入大批量数据，使用insert语句插入性能较低，此时可以使用MySQL数据库提供的load指令插入。</p><pre class="line-numbers language-mysql" data-language="mysql"><code class="language-mysql"># 客户端连接服务端时，加上参数 --local-infile（这一行在bash&#x2F;cmd界面输入）mysql --local-infile -u root -p# 设置全局参数local_infile为1，开启从本地加载文件导入数据的开关set global local_infile &#x3D; 1;select @@local_infile;# 执行load指令将准备好的数据，加载到表结构中load data local infile &#39;&#x2F;root&#x2F;sql1.log&#39; into table &#39;tb_user&#39; fields terminated by &#39;,&#39; lines terminated by &#39;\n&#39;;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="二、主键优化"><a href="#二、主键优化" class="headerlink" title="二、主键优化"></a>二、主键优化</h3><p>数据组织方式：在InnoDB存储引擎中，表数据都是根据主键顺序组织存放的，这种存储方式的表称为索引组织表（Index organized table, IOT）</p><p>页分裂：页可以为空，也可以填充一般，也可以填充100%，每个页包含了2-N行数据（如果一行数据过大，会行溢出），根据主键排列。<br>页合并：当删除一行记录时，实际上记录并没有被物理删除，只是记录被标记（flaged）为删除并且它的空间变得允许被其他记录声明使用。当页中删除的记录到达 MERGE_THRESHOLD（默认为页的50%），InnoDB会开始寻找最靠近的页（前后）看看是否可以将这两个页合并以优化空间使用。</p><p>MERGE_THRESHOLD：合并页的阈值，可以自己设置，在创建表或创建索引时指定</p><blockquote><p>文字说明不够清晰明了，具体可以看视频里的PPT演示过程：<a href="https://www.bilibili.com/video/BV1Kr4y1i7ru?p=90">https://www.bilibili.com/video/BV1Kr4y1i7ru?p=90</a></p></blockquote><p>主键设计原则：</p><ul><li>满足业务需求的情况下，尽量降低主键的长度</li><li>插入数据时，尽量选择顺序插入，选择使用 AUTO_INCREMENT 自增主键</li><li>尽量不要使用 UUID 做主键或者是其他的自然主键，如身份证号</li><li>业务操作时，避免对主键的修改</li></ul><h3 id="三、order-by优化"><a href="#三、order-by优化" class="headerlink" title="三、order by优化"></a>三、order by优化</h3><ol><li>Using filesort：通过表的索引或全表扫描，读取满足条件的数据行，然后在排序缓冲区 sort buffer 中完成排序操作，所有不是通过索引直接返回排序结果的排序都叫 FileSort 排序</li><li>Using index：通过有序索引顺序扫描直接返回有序数据，这种情况即为 using index，不需要额外排序，操作效率高</li></ol><p>如果order by字段全部使用升序排序或者降序排序，则都会走索引，但是如果一个字段升序排序，另一个字段降序排序，则不会走索引，explain的extra信息显示的是<code>Using index, Using filesort</code>，如果要优化掉Using filesort，则需要另外再创建一个索引，如：<code>create index idx_user_age_phone_ad on tb_user(age asc, phone desc);</code>，此时使用<code>select id, age, phone from tb_user order by age asc, phone desc;</code>会全部走索引</p><p>总结：</p><ul><li>根据排序字段建立合适的索引，多字段排序时，也遵循最左前缀法则</li><li>尽量使用覆盖索引</li><li>多字段排序，一个升序一个降序，此时需要注意联合索引在创建时的规则（ASC&#x2F;DESC）</li><li>如果不可避免出现filesort，大数据量排序时，可以适当增大排序缓冲区大小 sort_buffer_size（默认256k）</li></ul><h3 id="四、group-by优化"><a href="#四、group-by优化" class="headerlink" title="四、group by优化"></a>四、group by优化</h3><ul><li>在分组操作时，可以通过索引来提高效率</li><li>分组操作时，索引的使用也是满足最左前缀法则的</li></ul><p>如索引为<code>idx_user_pro_age_stat</code>，则句式可以是<code>select ... where profession order by age</code>，这样也符合最左前缀法则</p><h3 id="五、limit优化"><a href="#五、limit优化" class="headerlink" title="五、limit优化"></a>五、limit优化</h3><p>常见的问题如<code>limit 2000000, 10</code>，此时需要 MySQL 排序前2000000条记录，但仅仅返回2000000 - 2000010的记录，其他记录丢弃，查询排序的代价非常大。<br>优化方案：一般分页查询时，通过创建覆盖索引能够比较好地提高性能，可以通过覆盖索引加子查询形式进行优化</p><p>例如：</p><pre class="line-numbers language-mysql" data-language="mysql"><code class="language-mysql">-- 此语句耗时很长select * from tb_sku limit 9000000, 10;-- 通过覆盖索引加快速度，直接通过主键索引进行排序及查询select id from tb_sku order by id limit 9000000, 10;-- 下面的语句是错误的，因为 MySQL 不支持 in 里面使用 limit-- select * from tb_sku where id in (select id from tb_sku order by id limit 9000000, 10);-- 通过连表查询即可实现第一句的效果，并且能达到第二句的速度select * from tb_sku as s, (select id from tb_sku order by id limit 9000000, 10) as a where s.id &#x3D; a.id;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="六、count优化"><a href="#六、count优化" class="headerlink" title="六、count优化"></a>六、count优化</h3><p>MyISAM 引擎把一个表的总行数存在了磁盘上，因此执行 count(*) 的时候会直接返回这个数，效率很高（前提是不适用where）；<br>InnoDB 在执行 count(*) 时，需要把数据一行一行地从引擎里面读出来，然后累计计数。<br>优化方案：自己计数，如创建key-value表存储在内存或硬盘，或者是用redis</p><p>count的几种用法：</p><ul><li>如果count函数的参数（count里面写的那个字段）不是NULL（字段值不为NULL），累计值就加一，最后返回累计值</li><li>用法：count(*)、count(主键)、count(字段)、count(1)</li><li>count(主键)跟count(*)一样，因为主键不能为空；count(字段)只计算字段值不为NULL的行；count(1)引擎会为每行添加一个1，然后就count这个1，返回结果也跟count(*)一样；count(null)返回0</li></ul><p>各种用法的性能：</p><ul><li>count(主键)：InnoDB引擎会遍历整张表，把每行的主键id值都取出来，返回给服务层，服务层拿到主键后，直接按行进行累加（主键不可能为空）</li><li>count(字段)：没有not null约束的话，InnoDB引擎会遍历整张表把每一行的字段值都取出来，返回给服务层，服务层判断是否为null，不为null，计数累加；有not null约束的话，InnoDB引擎会遍历整张表把每一行的字段值都取出来，返回给服务层，直接按行进行累加</li><li>count(1)：InnoDB 引擎遍历整张表，但不取值。服务层对于返回的每一层，放一个数字 1 进去，直接按行进行累加</li><li>count(*)：InnoDB 引擎并不会把全部字段取出来，而是专门做了优化，不取值，服务层直接按行进行累加</li></ul><p>按效率排序：count(字段) &lt; count(主键) &lt; count(1) &lt; count(*)，所以尽量使用 count(*)</p><h3 id="七、update优化（避免行锁升级为表锁）"><a href="#七、update优化（避免行锁升级为表锁）" class="headerlink" title="七、update优化（避免行锁升级为表锁）"></a>七、update优化（避免行锁升级为表锁）</h3><p>InnoDB 的行锁是针对索引加的锁，不是针对记录加的锁，并且该索引不能失效，否则会从行锁升级为表锁。</p><p>如以下两条语句：<br><code>update student set no = &#39;123&#39; where id = 1;</code>，这句由于id有主键索引，所以只会锁这一行；<br><code>update student set no = &#39;123&#39; where name = &#39;test&#39;;</code>，这句由于name没有索引，所以会把整张表都锁住进行数据更新，解决方法是给name字段添加索引</p>]]></content>
      
      
      <categories>
          
          <category> Mysql </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Mysql </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>前端基础</title>
      <link href="/2021/11/01/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80/"/>
      <url>/2021/11/01/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80/</url>
      
        <content type="html"><![CDATA[<h1 id="前端三件套基础"><a href="#前端三件套基础" class="headerlink" title="前端三件套基础"></a>前端三件套基础</h1><h2 id="HTML"><a href="#HTML" class="headerlink" title="HTML"></a>HTML</h2><h3 id="一、行元素"><a href="#一、行元素" class="headerlink" title="一、行元素"></a>一、行元素</h3><p>默认和其他标签在同一行上，标签的宽度随着内容的多少而改变</p><h4 id="1、页面的跳转"><a href="#1、页面的跳转" class="headerlink" title="1、页面的跳转"></a>1、页面的跳转</h4><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span> <span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span> <span class="token attr-name">target</span> <span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li><p>href   跳转的链接</p></li><li><p>target打开的方式</p><ul><li>_blank  在新窗口打开</li><li>_self    默认，在当前窗口打开</li></ul></li></ul><h4 id="2、加粗效果"><a href="#2、加粗效果" class="headerlink" title="2、加粗效果"></a>2、加粗效果</h4><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>b</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>b</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>strong</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>strong</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h4 id="3、倾斜效果"><a href="#3、倾斜效果" class="headerlink" title="3、倾斜效果"></a>3、倾斜效果</h4><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>i</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>i</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="4、普通文本显示"><a href="#4、普通文本显示" class="headerlink" title="4、普通文本显示"></a>4、普通文本显示</h4><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="二、块元素"><a href="#二、块元素" class="headerlink" title="二、块元素"></a>二、块元素</h3><p>默认一行，和其他标签不在一行</p><h4 id="1、div标签"><a href="#1、div标签" class="headerlink" title="1、div标签"></a>1、div标签</h4><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="2、标题标签"><a href="#2、标题标签" class="headerlink" title="2、标题标签"></a>2、标题标签</h4><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="3、有序列表"><a href="#3、有序列表" class="headerlink" title="3、有序列表"></a>3、有序列表</h4><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ol</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>A<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ol</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h4 id="4、无序列表"><a href="#4、无序列表" class="headerlink" title="4、无序列表"></a>4、无序列表</h4><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>cicle<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h4 id="5、表格标签"><a href="#5、表格标签" class="headerlink" title="5、表格标签"></a>5、表格标签</h4><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span> <span class="token attr-name">border</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>1px<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>caption</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>caption</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>thead</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>thead</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tbody</span> <span class="token attr-name">align</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>center<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>”200“</span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>100<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tbody</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>table</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="三、行块元素"><a href="#三、行块元素" class="headerlink" title="三、行块元素"></a>三、行块元素</h3><h4 id="1、图片标签"><a href="#1、图片标签" class="headerlink" title="1、图片标签"></a>1、图片标签</h4><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>300<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>400<span class="token punctuation">"</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span> <span class="token attr-name">alt</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span> <span class="token attr-name">title</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li>src 文件地址</li><li>alt 图片不能加载，提示信息</li><li>title 鼠标悬停，提醒信息</li></ul><h4 id="2、视频标签"><a href="#2、视频标签" class="headerlink" title="2、视频标签"></a>2、视频标签</h4><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>video</span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>300<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>400<span class="token punctuation">"</span></span> <span class="token attr-name">controls</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span> <span class="token attr-name">loop</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span> <span class="token attr-name">autoplay</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>video</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li>controls 控制条，值为controls </li><li>loop 循环播放，值为loop</li><li>autoplay 自动播放，值为autoplay</li></ul><h4 id="3、表单元素"><a href="#3、表单元素" class="headerlink" title="3、表单元素"></a>3、表单元素</h4><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>标题<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>跳转位置<span class="token punctuation">"</span></span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            Name:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Name<span class="token punctuation">"</span></span>  <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>请输入用户名<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span>            Password:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>password<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>password<span class="token punctuation">"</span></span>  <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>请输入密码<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span>            单选框:            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>radio<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>sex<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>男<span class="token punctuation">"</span></span> <span class="token attr-name">checked</span><span class="token punctuation">></span></span>男            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>radio<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>sex<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>女<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>女            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span>            多选框:            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>checkbox<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>跑步<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>01<span class="token punctuation">"</span></span> <span class="token attr-name">checked</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>checked<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>跑步            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>checkbox<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>篮球<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>02<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>篮球            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>checkbox<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>健身<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>03<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>健身            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span>            下拉列表：             <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span><span class="token punctuation">></span></span>                 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span><span class="token punctuation">></span></span>18岁以下<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">></span></span>                 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span><span class="token punctuation">></span></span>18-28岁<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">></span></span>                 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span><span class="token punctuation">></span></span>28-38岁<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">></span></span>                 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span><span class="token punctuation">></span></span>38岁以上<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">></span></span>              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Submit<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span>     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="/images/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80/image-20221117101213452.png" alt="表单元素示例" style="zoom: 80%;" /><ul><li><p>input 标签</p><ul><li>name 输入框名字</li><li>type<ul><li>text 普通文本</li><li>password 密文框</li><li>email 邮箱类型</li><li>date 日期类型</li><li>number 数字类型 </li><li>file 上传文件</li><li>radio 单选按钮</li><li>checkbox 多选按钮</li><li>submit 提交按钮</li><li>reset 回退按钮</li><li>button 普通按钮</li></ul></li><li>palceholder 提示信息</li><li>value 默认输入的值</li><li>required 必须输入</li><li>readonly 只读</li><li>hidden   隐藏</li><li>autofocus 数据框被选中进行值的输入</li></ul><p>select标签</p><ul><li>option 下拉框</li></ul></li></ul><h2 id="CSS"><a href="#CSS" class="headerlink" title="CSS"></a>CSS</h2><h3 id="一、CSS的三种写法"><a href="#一、CSS的三种写法" class="headerlink" title="一、CSS的三种写法"></a>一、CSS的三种写法</h3><h4 id="1、内联样式"><a href="#1、内联样式" class="headerlink" title="1、内联样式"></a>1、内联样式</h4><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>标记名</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">CSS属性</span><span class="token punctuation">:</span>属性值<span class="token punctuation">;</span> <span class="token property">CSS属性</span><span class="token punctuation">:</span>属性值<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>标记名</span><span class="token punctuation">></span></span>eg: <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">CSS属性</span><span class="token punctuation">:</span>属性值<span class="token punctuation">;</span> <span class="token property">CSS属性</span><span class="token punctuation">:</span>属性值<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h4 id="2、内部样式"><a href="#2、内部样式" class="headerlink" title="2、内部样式"></a>2、内部样式</h4><p>优先级：id选择器 &gt; class选择器 &gt; 标签选择器</p><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style"><span class="token language-css">        <span class="token comment">/*css中选择器，进行标签的选择*/</span>        <span class="token comment">/* 1. id选择器，通过id属性进行标签的选择*/</span>        <span class="token selector">#id</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>        <span class="token comment">/* 2. class选择器，通过class属性进行标签的选择*/</span>        <span class="token selector">.css选择器的名字</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>        <span class="token comment">/* 3. 标签选择器，通过标签名进行标签的选择*/</span>        <span class="token selector">p</span><span class="token punctuation">&#123;</span><span class="token property">width</span><span class="token punctuation">:</span>100px<span class="token punctuation">&#125;</span>    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="3、外部样式"><a href="#3、外部样式" class="headerlink" title="3、外部样式"></a>3、外部样式</h4><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>css文件的路径<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="二、常用CSS的样式"><a href="#二、常用CSS的样式" class="headerlink" title="二、常用CSS的样式"></a>二、常用CSS的样式</h3><pre class="line-numbers language-css" data-language="css"><code class="language-css">宽 <span class="token property">width</span><span class="token punctuation">:</span>100px<span class="token punctuation">;</span>高 <span class="token property">height</span><span class="token punctuation">:</span>100px<span class="token punctuation">;</span>圆角 <span class="token property">border-radius</span><span class="token punctuation">:</span>30px<span class="token punctuation">;</span>字体 <span class="token property">font-family</span><span class="token punctuation">:</span> <span class="token string">"黑体"</span><span class="token punctuation">;</span>字号 <span class="token property">font-size</span><span class="token punctuation">:</span>30px<span class="token punctuation">;</span>加粗 <span class="token property">font-weight</span><span class="token punctuation">:</span> 100<span class="token punctuation">;</span>倾斜 <span class="token property">font-style</span><span class="token punctuation">:</span> italic<span class="token punctuation">;</span>背景图的位置 <span class="token property">backgroud-position</span><span class="token punctuation">:</span>center<span class="token punctuation">;</span>设置图片不重复填充 <span class="token property">backgroud-repeat</span><span class="token punctuation">:</span>no-repeat<span class="token punctuation">;</span>背景太大，设置图片大小 <span class="token property">backgroud-size</span><span class="token punctuation">:</span>300px 200px<span class="token punctuation">;</span><span class="token property">border</span><span class="token punctuation">:</span> solid 1px black <span class="token comment">/*复合样式*/</span>CSS的定位绝对定位 <span class="token property">position</span><span class="token punctuation">:</span>absloute<span class="token punctuation">;</span> 可以脱离文档流，相对于已经定位的父元素位置改变相对定位 <span class="token property">position</span><span class="token punctuation">:</span>relative<span class="token punctuation">;</span>浮动定位 <span class="token property">position</span><span class="token punctuation">:</span>fixed<span class="token punctuation">;</span>不受滚动条的影响，一直可以显示<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="JavaScript"><a href="#JavaScript" class="headerlink" title="JavaScript"></a>JavaScript</h2><h3 id="一、基本语法"><a href="#一、基本语法" class="headerlink" title="一、基本语法"></a>一、基本语法</h3><h4 id="1、数据类型"><a href="#1、数据类型" class="headerlink" title="1、数据类型"></a>1、数据类型</h4><p>JavaScript:解释型，弱类型，变量定义后数据类型可以更改 </p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">&lt;</span>script<span class="token operator">></span>    <span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">1</span>    <span class="token keyword">const</span> pi <span class="token operator">=</span> <span class="token number">3.14</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token comment">//let 块作用域</span>        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>        <span class="token punctuation">&#125;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="2、方法的定义"><a href="#2、方法的定义" class="headerlink" title="2、方法的定义"></a>2、方法的定义</h4><p>JavaScript方法的定义</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">//第 1 种写法，不需要写数据类型</span><span class="token keyword">function</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span>b</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">return</span> <span class="token punctuation">(</span>a <span class="token operator">+</span> b<span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token comment">//第 2 种写法</span><span class="token keyword">var</span> <span class="token function-variable function">add</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>    <span class="token punctuation">&#125;</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="3、实参数据接收"><a href="#3、实参数据接收" class="headerlink" title="3、实参数据接收"></a>3、实参数据接收</h4><p>JavaScript没有方法重载<strong>（方法名相同，参数列表不同</strong>，但方法调用时可以进行实参数据的接收</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>   console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arguments<span class="token punctuation">)</span><span class="token comment">// 实参数据的接收,以数组下标的方式调用</span><span class="token punctuation">&#125;</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token number">13</span><span class="token punctuation">,</span><span class="token number">14</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="4、可变长数组"><a href="#4、可变长数组" class="headerlink" title="4、可变长数组"></a>4、可变长数组</h4><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">//可变长数组,可以接收任意个的参数</span><span class="token keyword">function</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>rest</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">return</span> <span class="token punctuation">(</span>a <span class="token operator">+</span> b<span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h4 id="5、JavaScript对象"><a href="#5、JavaScript对象" class="headerlink" title="5、JavaScript对象"></a>5、JavaScript对象</h4><p>第一种创建对象的方式，属性可以新增加</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">Cat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">let</span> name    <span class="token keyword">let</span> age    <span class="token keyword">let</span> type    <span class="token keyword">let</span> <span class="token function-variable function">run</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"run method"</span><span class="token punctuation">)</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>cat<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token string">"黑色"</span> <span class="token comment">//属性可以新增加</span><span class="token keyword">let</span> cat <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Cat</span><span class="token punctuation">(</span><span class="token punctuation">)</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>cat<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>第二种创建对象的方式，基于已有的function，固定格式</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">let</span> c <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token literal-property property">name</span> <span class="token operator">:</span> <span class="token string">"test"</span><span class="token punctuation">,</span><span class="token literal-property property">age</span> <span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span><span class="token literal-property property">type</span> <span class="token operator">:</span> <span class="token string">"test2"</span><span class="token punctuation">,</span><span class="token function-variable function">run</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"run method"</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="6、日期的格式化表示"><a href="#6、日期的格式化表示" class="headerlink" title="6、日期的格式化表示"></a>6、日期的格式化表示</h4><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">let</span> d <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">let</span> year <span class="token operator">=</span> d<span class="token punctuation">.</span><span class="token function">getFullYear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">let</span> month <span class="token operator">=</span> <span class="token punctuation">(</span>d<span class="token punctuation">.</span><span class="token function">getMonth</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">padStart</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token string">"0"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">let</span> day <span class="token operator">=</span> d<span class="token punctuation">.</span><span class="token function">getDay</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">padStart</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token string">"0"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">let</span> format <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>year<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">-</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>month<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">-</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>day<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">`</span></span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>format<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="7、JavaScript数组"><a href="#7、JavaScript数组" class="headerlink" title="7、JavaScript数组"></a>7、JavaScript数组</h4><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">let</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token number">33</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">,</span><span class="token number">13</span><span class="token punctuation">,</span><span class="token number">19</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>arr<span class="token punctuation">.</span>length<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span>arr<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment">//末尾添加</span>arr<span class="token punctuation">.</span><span class="token function">unshift</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//首位置添加</span>arr<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">//末尾删除</span>arr<span class="token punctuation">.</span><span class="token function">shift</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">//首位置删除</span>arr<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token comment">//从那个位置开始，删除几个元素</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="8、回调函数"><a href="#8、回调函数" class="headerlink" title="8、回调函数"></a>8、回调函数</h4><p>回调 (callback) 是作为参数传递给另一个函数的函数</p><p>这种技术允许函数调用另一个函数</p><p>回调函数可以在另一个函数完成后运行</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">//a + b之后再进行排序</span><span class="token keyword">let</span> f1 <span class="token operator">=</span> arr<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span>b</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> a<span class="token operator">+</span>b<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token comment">//function可以省略为箭头函数</span><span class="token keyword">let</span> f2 <span class="token operator">=</span> arr<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span>b</span><span class="token punctuation">)</span><span class="token operator">=></span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> a<span class="token operator">+</span>b<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="二、DOM节点"><a href="#二、DOM节点" class="headerlink" title="二、DOM节点"></a>二、DOM节点</h3><h4 id="1、JavaScript-中获取HTML标签"><a href="#1、JavaScript-中获取HTML标签" class="headerlink" title="1、JavaScript 中获取HTML标签"></a>1、JavaScript 中获取HTML标签</h4><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token punctuation">)</span>：根据id获取节点，传入id值，获取节点对象document<span class="token punctuation">.</span><span class="token function">getElementsByName</span><span class="token punctuation">(</span><span class="token punctuation">)</span>：根据name属性获取节点，传入name属性，获取节点集合、数组document<span class="token punctuation">.</span><span class="token function">getElementsByClassName</span><span class="token punctuation">(</span><span class="token punctuation">)</span>：根据<span class="token keyword">class</span>获取节点，传入<span class="token keyword">class</span>的值，获取节点集合、数组document<span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token punctuation">)</span>：根据标签名获取节点，传入标签名的值，获取节点集合、数组document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token punctuation">)</span>：根据类似于css选择器的东西获取，传入字符串形式的选择器，获取节点对象document<span class="token punctuation">.</span><span class="token function">querySelectorAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span>：根据类似于css选择器的东西获取，传入字符串形式的选择器，获取节点集合<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="2、dom节点设置标签值"><a href="#2、dom节点设置标签值" class="headerlink" title="2、dom节点设置标签值"></a>2、dom节点设置标签值</h4><p>dom节点的设置标签值</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">let</span> elementById <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token punctuation">)</span>elementById<span class="token punctuation">.</span>innerText <span class="token operator">=</span> <span class="token string">"js设置的文本"</span>elementById<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token string">"js设置的HTML"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>dom节点的创建,只能拼接成子元素</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">let</span> a <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElementById</span><span class="token punctuation">(</span><span class="token string">"a"</span><span class="token punctuation">)</span>elementById<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>dom节点的删除</p><pre class="line-numbers language-none"><code class="language-none">elementById.remove()<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="3、JavaScript键盘事件"><a href="#3、JavaScript键盘事件" class="headerlink" title="3、JavaScript键盘事件"></a>3、JavaScript键盘事件</h4><p>按键按下事件</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">elementById<span class="token punctuation">.</span><span class="token function-variable function">onkeydown</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//按键按下时执行函数</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>按键抬起事件</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">elementById<span class="token punctuation">.</span><span class="token function-variable function">onkeyup</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//按键抬起时执行函数 </span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>获取焦点事件</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">elementById<span class="token punctuation">.</span><span class="token function-variable function">onfocus</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//获取焦点的事件 </span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>失去焦点事件</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">elementById<span class="token punctuation">.</span><span class="token function-variable function">onblur</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//失去焦点的事件</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>内容改变事件</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">elementById<span class="token punctuation">.</span><span class="token function-variable function">onchange</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//内容改变事件</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h4 id="4、JavaScript鼠标事件"><a href="#4、JavaScript鼠标事件" class="headerlink" title="4、JavaScript鼠标事件"></a>4、JavaScript鼠标事件</h4><p>鼠标点击事件（只针对于鼠标左键）</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">elementById<span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//鼠标点击的事件</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>鼠标按下和抬起（针对于鼠标所有键）</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">elementById<span class="token punctuation">.</span><span class="token function-variable function">onmousedown</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//鼠标按下的事件</span><span class="token punctuation">&#125;</span>elementById<span class="token punctuation">.</span><span class="token function-variable function">onmouseup</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//鼠标抬起的事件</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>鼠标的进入和离开</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">elementById<span class="token punctuation">.</span><span class="token function-variable function">onmouseenter</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//鼠标进入的事件</span><span class="token punctuation">&#125;</span>elementById<span class="token punctuation">.</span><span class="token function-variable function">onmouseleave</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//鼠标离开的事件（放到子元素不算离开）</span><span class="token punctuation">&#125;</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>elementById<span class="token punctuation">.</span><span class="token function-variable function">onmouseover</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">////发生在鼠标指针移动到元素或它的子元素上时</span><span class="token punctuation">&#125;</span>elementById<span class="token punctuation">.</span><span class="token function-variable function">onmouseout</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//鼠标离开的事件（放到子元素算离开）</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="三、BOM对象"><a href="#三、BOM对象" class="headerlink" title="三、BOM对象"></a>三、BOM对象</h3><h4 id="1、弹窗"><a href="#1、弹窗" class="headerlink" title="1、弹窗"></a>1、弹窗</h4><p>普通弹窗</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token function">alert</span><span class="token punctuation">(</span>“只能提醒简单信息”<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>确认框弹窗</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">let</span> f <span class="token operator">=</span> <span class="token function">confirm</span><span class="token punctuation">(</span>“确认框”<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>带输入框的弹窗</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">let</span> f <span class="token operator">=</span> <span class="token function">prompt</span><span class="token punctuation">(</span>“带输入框的弹窗”<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="2、定时器"><a href="#2、定时器" class="headerlink" title="2、定时器"></a>2、定时器</h4><p>一次性定时器</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token number">1000</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>重复定时器</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">let</span> num <span class="token operator">=</span> <span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token function">clearInterval</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="四、数据存储的对象"><a href="#四、数据存储的对象" class="headerlink" title="四、数据存储的对象"></a>四、数据存储的对象</h3><h4 id="1、localStorage-本地存储"><a href="#1、localStorage-本地存储" class="headerlink" title="1、localStorage 本地存储"></a>1、localStorage 本地存储</h4><p>存储到硬盘上，只要不手动删除，数据一致存在</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">//3种设置的方式</span><span class="token comment">//第 1 种</span>localStorage<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span><span class="token string">"key1"</span><span class="token punctuation">,</span><span class="token string">"value1"</span><span class="token punctuation">)</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>localStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">"key1"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">//第 2 种</span>localStorage<span class="token punctuation">.</span>key2 <span class="token operator">=</span> <span class="token string">"value2"</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>localStorage<span class="token punctuation">.</span>key2<span class="token punctuation">)</span><span class="token comment">//第 3 种</span>localStorage<span class="token punctuation">[</span><span class="token string">"key3"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"values3"</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>localStorage<span class="token punctuation">[</span><span class="token string">"key3"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="2、SessionStorage存储"><a href="#2、SessionStorage存储" class="headerlink" title="2、SessionStorage存储"></a>2、SessionStorage存储</h4><p>存储在内存中，临时存储，只要浏览器关闭，数据就会被清理</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">//3种设置的方式</span><span class="token comment">//第 1 种</span>sessionStorage<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span><span class="token string">"key1"</span><span class="token punctuation">,</span><span class="token string">"value1"</span><span class="token punctuation">)</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>sessionStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">"key1"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">//第 2 种</span>sessionStorage<span class="token punctuation">.</span>key2 <span class="token operator">=</span> <span class="token string">"value2"</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>sessionStorage<span class="token punctuation">.</span>key2<span class="token punctuation">)</span><span class="token comment">//第 3 种</span>sessionStorage<span class="token punctuation">[</span><span class="token string">"key3"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"values3"</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>sessionStorage<span class="token punctuation">[</span><span class="token string">"key3"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> 前端 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 前端 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>生日提醒脚本</title>
      <link href="/2021/10/21/%E7%94%9F%E6%97%A5%E6%8F%90%E9%86%92%E8%84%9A%E6%9C%AC/"/>
      <url>/2021/10/21/%E7%94%9F%E6%97%A5%E6%8F%90%E9%86%92%E8%84%9A%E6%9C%AC/</url>
      
        <content type="html"><![CDATA[<h2 id="服务器部署"><a href="#服务器部署" class="headerlink" title="服务器部署"></a>服务器部署</h2><h3 id="一、创建数据库"><a href="#一、创建数据库" class="headerlink" title="一、创建数据库"></a>一、创建数据库</h3><p>1、云服务器Mysql修改密码</p><ul><li>在my.cnf中的[mysqld]下输入</li></ul><pre class="line-numbers language-none"><code class="language-none">skip-grant-tables<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li>终端输入以下命令</li></ul><pre class="line-numbers language-none"><code class="language-none">service mysqld restartmysql -u root -puse mysqlupdate user set password &#x3D; password (&#39;123456&#39;) where user &#x3D; &#39;root&#39;;flush privileges; service mysqld restart<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>在my.cnf中的[mysqld]下删除刚刚输入的代码</li></ul><p>2、创建表</p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token identifier"><span class="token punctuation">`</span>birth<span class="token punctuation">`</span></span> <span class="token punctuation">(</span>  <span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span>  <span class="token identifier"><span class="token punctuation">`</span>isBirthday<span class="token punctuation">`</span></span> <span class="token keyword">tinyint</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>  <span class="token identifier"><span class="token punctuation">`</span>isPreGift<span class="token punctuation">`</span></span> <span class="token keyword">tinyint</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>  <span class="token identifier"><span class="token punctuation">`</span>isLunardate<span class="token punctuation">`</span></span> <span class="token keyword">tinyint</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>  <span class="token identifier"><span class="token punctuation">`</span>name<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>  <span class="token identifier"><span class="token punctuation">`</span>birDate<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>  <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">ENGINE</span><span class="token operator">=</span><span class="token keyword">InnoDB</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token operator">=</span><span class="token number">2</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CHARSET</span><span class="token operator">=</span>utf8<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>3、插入数据</p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token identifier"><span class="token punctuation">`</span>birth<span class="token punctuation">`</span></span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">'1'</span><span class="token punctuation">,</span> <span class="token string">'1'</span><span class="token punctuation">,</span> <span class="token string">'1'</span><span class="token punctuation">,</span> <span class="token string">'1'</span><span class="token punctuation">,</span> <span class="token string">'XX'</span><span class="token punctuation">,</span> <span class="token string">'0824'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>4、远程连接云服务器数据库</p><ul><li>支持root用户允许远程连接mysql数据库</li></ul><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">use</span> mysql<span class="token punctuation">;</span><span class="token keyword">grant</span> <span class="token keyword">all</span> <span class="token keyword">privileges</span> <span class="token keyword">on</span> <span class="token operator">*</span><span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">to</span> <span class="token string">'root'</span><span class="token variable">@'%'</span> identified <span class="token keyword">by</span> <span class="token string">'123456'</span> <span class="token keyword">with</span> <span class="token keyword">grant</span> <span class="token keyword">option</span><span class="token punctuation">;</span>flush <span class="token keyword">privileges</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><ul><li>查看是否修改成功</li></ul><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">select</span> <span class="token keyword">user</span><span class="token punctuation">,</span>host <span class="token keyword">from</span> <span class="token keyword">user</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li><p>远程连接云服务器数据库</p><p>​这个密码是登录服务器SSH密码</p></li></ul><img src="/images/%E7%94%9F%E6%97%A5%E6%8F%90%E9%86%92%E8%84%9A%E6%9C%AC/image-20221027153238411.png" alt="远程连接服务器" style="zoom: 67%;" /><p>​这个密码是登录Mysql的密码，<strong>主机名一定要写localhost的</strong></p><img src="/images/%E7%94%9F%E6%97%A5%E6%8F%90%E9%86%92%E8%84%9A%E6%9C%AC/image-20221027153314029.png" alt="远程连接Mysql" style="zoom:67%;" /><h3 id="二、服务器定时执行脚本"><a href="#二、服务器定时执行脚本" class="headerlink" title="二、服务器定时执行脚本"></a>二、服务器定时执行脚本</h3><p>1、安装crontab</p><pre class="line-numbers language-none"><code class="language-none">yum install cronieyum install crontabs<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>2、开启crontab服务</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">service crond start <span class="token comment">#启动服务</span><span class="token comment">#其他相关命令</span>service crond stop <span class="token comment">#关闭服务</span>service crond restart <span class="token comment">#重启服务</span>service crond <span class="token builtin">reload</span> <span class="token comment">#重新载入配置</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>3、在命令行输入: <code>crontab -e</code>  然后添加相应的任务，<code>:wq</code> 可以保存并退出编辑模式  或是  <code>ctrl+zz</code> 退出</p><p>存放位置在&#x2F;var&#x2F;spool&#x2F;cron&#x2F;root目录下</p><pre class="line-numbers language-none"><code class="language-none">0 7 * * * python3 &#x2F;wxyTest&#x2F;birth.py #每天七点执行* * * * * python3 &#x2F;wxyTest&#x2F;note.py  #每分钟执行一次<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>4、时间的有关语法</p><pre class="line-numbers language-none"><code class="language-none"># Example of job definition:# .---------------- minute (0 - 59)# |  .------------- hour (0 - 23)# |  |  .---------- day of month (1 - 31)# |  |  |  .------- month (1 - 12) OR jan,feb,mar,apr ...# |  |  |  |  .---- day of week (0 - 6) (Sunday&#x3D;0 or 7) OR sun,mon,tue,wed,thu,fri,sat# |  |  |  |  |# *  *  *  *  * command to be executed<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="其他学到知识"><a href="#其他学到知识" class="headerlink" title="其他学到知识"></a>其他学到知识</h3><h4 id="1、导出-x2F-下载依赖"><a href="#1、导出-x2F-下载依赖" class="headerlink" title="1、导出&#x2F;下载依赖"></a>1、导出&#x2F;下载依赖</h4><p><strong>第一种方法</strong></p><p>此命令将会列出当前开发环境所有依赖库到requirements.txt文件中，相对较为冗杂。在项目根目录位置，执行：</p><pre class="line-numbers language-none"><code class="language-none">pip freeze &gt; requirements.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>第二种方法</strong></p><p>使用pipreqs，这个工具的好处是可以通过对项目目录的扫描，自动发现使用了那些类库，自动生成依赖清单。缺点是可能会有些偏差，需要检查并自己调整下。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">pip install pipreqs<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>在项目根目录下运行：<code>pipreqs ./</code>  </p><p>如果是Windows系统，会报编码错误 </p><p>​<code>(UnicodeDecodeError: &#39;gbk&#39; codec can&#39;t decode byte 0xa8 in position 24: illegal multibyte sequence)</code>  </p><p>改成如下命令</p><pre class="line-numbers language-none"><code class="language-none">pipreqs .&#x2F; --encoding&#x3D;utf8<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>生成requirements.txt 文件后，可以根据这个文件下载所有的依赖</p><pre class="line-numbers language-none"><code class="language-none">pip install -r requirements.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="2、查询自己的公网ip"><a href="#2、查询自己的公网ip" class="headerlink" title="2、查询自己的公网ip"></a>2、查询自己的公网ip</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python">curl ifconfig<span class="token punctuation">.</span>me  <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="3、服务器改用465端口发送邮件"><a href="#3、服务器改用465端口发送邮件" class="headerlink" title="3、服务器改用465端口发送邮件"></a>3、服务器改用465端口发送邮件</h4><p>服务器会把25端口封掉，防止发送垃圾邮件，改用465端口发送邮件，可以看一下对比</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># server = smtplib.SMTP('smtp.qq.com')</span>server <span class="token operator">=</span> smtplib<span class="token punctuation">.</span>SMTP_SSL<span class="token punctuation">(</span><span class="token string">'smtp.qq.com'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h4 id="4、编码路径的三种写法"><a href="#4、编码路径的三种写法" class="headerlink" title="4、编码路径的三种写法"></a>4、编码路径的三种写法</h4><ul><li>在路径前面加r，即保持字符原始值的意思。</li></ul><pre class="line-numbers language-none"><code class="language-none">sys.path.append(r‘c:\Users\mshacxiang\VScode_project\web_ddt‘)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li>替换为双反斜杠</li></ul><pre class="line-numbers language-none"><code class="language-none">sys.path.append(‘c:\\Users\\mshacxiang\\VScode_project\\web_ddt‘)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li>替换为正斜杠</li></ul><pre class="line-numbers language-none"><code class="language-none">sys.path.append(‘c:&#x2F;Users&#x2F;mshacxiang&#x2F;VScode_project&#x2F;web_ddt‘)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="5、最稳定的青龙面板2-10-2的安装"><a href="#5、最稳定的青龙面板2-10-2的安装" class="headerlink" title="5、最稳定的青龙面板2.10.2的安装"></a>5、最稳定的青龙面板2.10.2的安装</h4><p>安装在&#x2F;root&#x2F;ql位置下</p><ul><li>安装Doker</li></ul><pre class="line-numbers language-none"><code class="language-none">yum install docker-io –ysudo systemctl start dockersudo systemctl status dockersudo systemctl enable docker<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><ul><li>拉取镜像</li></ul><pre class="line-numbers language-none"><code class="language-none">docker pull ytong825&#x2F;qinglong:2.10.2<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li>创建容器&#x2F;多容器更改容器名，注意： <strong>端口是3885 不是5700 已经做了修改</strong></li></ul><pre class="line-numbers language-none"><code class="language-none">docker run -dit \   -v $PWD&#x2F;ql&#x2F;config:&#x2F;ql&#x2F;config \   -v $PWD&#x2F;ql&#x2F;log:&#x2F;ql&#x2F;log \   -v $PWD&#x2F;ql&#x2F;db:&#x2F;ql&#x2F;db \   -v $PWD&#x2F;ql&#x2F;repo:&#x2F;ql&#x2F;repo \   -v $PWD&#x2F;ql&#x2F;raw:&#x2F;ql&#x2F;raw \   -v $PWD&#x2F;ql&#x2F;scripts:&#x2F;ql&#x2F;scripts \   -v $PWD&#x2F;ql&#x2F;jbot:&#x2F;ql&#x2F;jbot \   -p 3885:5700 \   --name qinglong \   --hostname qinglong \   --restart unless-stopped \   ytong825&#x2F;qinglong:2.10.2<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>配置相关依赖</li><li>NodeJs</li></ul><pre class="line-numbers language-none"><code class="language-none">crypto-jsprettytabledotenvjsdomdate-fnstough-cookietslibws@7.4.3ts-md5jsdom -gjiebafsform-datajson5global-agentpng-js@types&#x2F;noderequiretypescriptjs-base64axios<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>Python3</li></ul><pre class="line-numbers language-none"><code class="language-none">requestscanvasping3jieba<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><ul><li>Linux</li></ul><pre class="line-numbers language-none"><code class="language-none">bizCodebizMsglxml<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><ul><li>拉取KR库</li></ul><pre class="line-numbers language-none"><code class="language-none">定时规则：0 0 1 * *ql repo https:&#x2F;&#x2F;github.com&#x2F;KingRan&#x2F;KR.git &quot;jd_|jx_|jdCookie&quot; &quot;activity|backUp&quot; &quot;^jd[^_]|USER|utils|function|sign|sendNotify|ql|JDJR&quot;定时规则：0 0 1 * *ql repo https:&#x2F;&#x2F;github.com&#x2F;feverrun&#x2F;my_scripts.git &quot;jd_|jx_|jddj_|getCookie|getJDCookie&quot; &quot;backUp&#x2F;activity|backUp&#x2F;card|backUp&#x2F;py|backUp&#x2F;utils&#x2F;|backUp&#x2F;test|jd_fruits.js|jd_pet.js|jd_factory.js|jd_health.js|jd_sgmh.js|jd_dreamFactory.js|jd_plantBean.js&quot; &quot;^(jd|JD|JS)[^_]|USER|sendNotify|utils&quot;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>青龙面板时间设置</li></ul><p>第1个是秒，第2个是分，第3个是时，第4个是每月的哪日，第5个是哪月，第6个是每周的周几。</p><p>不限制的用 * 号替代，定期的时间用 ? 替代，间隔运行时间用“*&#x2F;数字”替代</p><p>同一个时间位多个选项用”,”连接，同一个时间位一个区间用“-”连接。</p><p>每天执行，在天位或者周位用”?”都行，一般设置每天执行一次就行0 0 1 * * ?</p><p>具体示例如下：</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token number">0</span> <span class="token number">0</span> <span class="token number">1</span> <span class="token operator">*</span> <span class="token operator">*</span> ? <span class="token comment">#每天 1 点触发</span><span class="token number">0</span> <span class="token number">10</span> <span class="token number">1</span> ? <span class="token operator">*</span> <span class="token operator">*</span> <span class="token comment">#每天 1:10 触发</span><span class="token operator">*</span><span class="token operator">/</span><span class="token number">5</span> <span class="token operator">*</span> <span class="token operator">*</span> <span class="token operator">*</span> <span class="token operator">*</span> ? <span class="token comment">#每隔 5 秒执行一次</span><span class="token number">0</span> <span class="token operator">*</span><span class="token operator">/</span><span class="token number">1</span> <span class="token operator">*</span> <span class="token operator">*</span> <span class="token operator">*</span> ? <span class="token comment">#每隔 1 分钟执行一次</span><span class="token number">0</span> <span class="token number">0</span> <span class="token number">2</span> <span class="token number">1</span> <span class="token operator">*</span> ? <span class="token operator">*</span> <span class="token comment">#每月 1 日的凌晨 2 点执行一次</span><span class="token number">0</span> <span class="token number">0</span> <span class="token number">1</span> <span class="token operator">*</span> <span class="token operator">*</span> ? <span class="token comment">#每天 23 点执行一次</span><span class="token number">0</span> <span class="token number">0</span> <span class="token number">1</span> <span class="token operator">*</span> <span class="token operator">*</span> ? <span class="token comment">#每天凌晨 1 点执行一次</span><span class="token number">0</span> <span class="token number">0</span> <span class="token number">1</span> <span class="token number">1</span> ? <span class="token operator">*</span> <span class="token comment">#每月 1 日凌晨 1 点执行一次</span><span class="token number">0</span> <span class="token number">26</span><span class="token punctuation">,</span><span class="token number">29</span><span class="token punctuation">,</span><span class="token number">33</span> <span class="token operator">*</span> <span class="token operator">*</span> <span class="token operator">*</span> ? <span class="token comment">#在 26 分、29 分、33 分执行一次</span><span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">13</span><span class="token punctuation">,</span><span class="token number">18</span><span class="token punctuation">,</span><span class="token number">21</span> <span class="token operator">*</span> <span class="token operator">*</span> ? <span class="token comment">#每天的 0 点、13 点、18 点、21 点都执行一次</span><span class="token number">0</span> <span class="token number">0</span> <span class="token number">10</span><span class="token punctuation">,</span><span class="token number">14</span><span class="token punctuation">,</span><span class="token number">16</span> <span class="token operator">*</span> <span class="token operator">*</span> ? <span class="token comment">#每天上午 10 点，下午 2 点，4 点执行一次</span><span class="token number">0</span> <span class="token number">0</span><span class="token operator">/</span><span class="token number">30</span> <span class="token number">9</span><span class="token operator">-</span><span class="token number">17</span> <span class="token operator">*</span> <span class="token operator">*</span> ? <span class="token comment">#每天朝九晚五工作时间内每半小时执行一次</span><span class="token number">0</span> <span class="token operator">*</span> <span class="token number">14</span> <span class="token operator">*</span> <span class="token operator">*</span> ? <span class="token comment">#每天下午 2 点到 2:59 期间的每 1 分钟触发</span><span class="token number">0</span> <span class="token operator">*</span><span class="token operator">/</span><span class="token number">5</span> <span class="token number">14</span> <span class="token operator">*</span> <span class="token operator">*</span> ? <span class="token comment">#每天下午 2 点到 2:55 期间的每 5 分钟触发</span><span class="token number">0</span> <span class="token operator">*</span><span class="token operator">/</span><span class="token number">5</span> <span class="token number">14</span><span class="token punctuation">,</span><span class="token number">18</span> <span class="token operator">*</span> <span class="token operator">*</span> ? <span class="token comment">#每天下午 2 点到 2:55 期间和下午 6 点到 6:55 期间的每 5 分钟触发</span><span class="token number">0</span> <span class="token number">0</span><span class="token operator">-</span><span class="token number">5</span> <span class="token number">14</span> <span class="token operator">*</span> <span class="token operator">*</span> ? <span class="token comment">#每天下午 2 点到 2:05 期间的每 1 分钟触发</span><span class="token number">0</span> <span class="token number">15</span> <span class="token number">10</span> <span class="token number">15</span> ? <span class="token operator">*</span> <span class="token comment">#每月 15 日上午 10:15 触发</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>京东cookie</li></ul><p>JD_COOKIE格式</p><pre class="line-numbers language-none"><code class="language-none">pt_key&#x3D;;pt_pin&#x3D;;&amp;pt_key&#x3D;;pt_pin&#x3D;;&amp;pt_key&#x3D;;pt_pin&#x3D;;&amp;pt_key&#x3D;;pt_pin&#x3D;;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h4 id="6、删除Docker里的容器"><a href="#6、删除Docker里的容器" class="headerlink" title="6、删除Docker里的容器"></a>6、删除Docker里的容器</h4><ul><li>重启docker</li></ul><pre class="line-numbers language-none"><code class="language-none">systemctl restart docker<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li>重启容器</li></ul><pre class="line-numbers language-none"><code class="language-none">docker restart 4b1361a68543<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li>列出所有容器ID</li></ul><pre class="line-numbers language-none"><code class="language-none">docker ps -aq<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li>列出运行的容器ID</li></ul><pre class="line-numbers language-none"><code class="language-none">docker ps<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li>停止所有的容器，这样才能够删除其中的镜像</li></ul><pre class="line-numbers language-none"><code class="language-none">docker stop $(docker ps -a -q) 或者 docker stop $(docker ps -aq) <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li>删除所有容器指令</li></ul><pre class="line-numbers language-none"><code class="language-none">docker rm $(docker ps -a -q) 或者 docker rm $(docker ps -aq) <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li>查看当前镜像</li></ul><pre class="line-numbers language-none"><code class="language-none">docker images<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li>删除镜像，通过镜像的id来指定删除</li></ul><pre class="line-numbers language-none"><code class="language-none">docker rmi &lt;image id&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li>强制删除全部镜像</li></ul><pre class="line-numbers language-none"><code class="language-none">docker rmi -f $(docker images -q)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="7、关闭端口进程"><a href="#7、关闭端口进程" class="headerlink" title="7、关闭端口进程"></a>7、关闭端口进程</h4><p>查看占用了4000端口号的PID</p><pre class="line-numbers language-none"><code class="language-none">netstat -aon|findstr &quot;4000&quot;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>关闭5200PID</p><pre class="line-numbers language-none"><code class="language-none">taskkill &#x2F;pid 5200 -t -f<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> 生活 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 生活 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>树-算法专题</title>
      <link href="/2021/10/20/%E6%A0%91-%E7%AE%97%E6%B3%95%E4%B8%93%E9%A2%98/"/>
      <url>/2021/10/20/%E6%A0%91-%E7%AE%97%E6%B3%95%E4%B8%93%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<h2 id="力扣核心代码变为ACM模式"><a href="#力扣核心代码变为ACM模式" class="headerlink" title="力扣核心代码变为ACM模式"></a>力扣核心代码变为ACM模式</h2><h3 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h3><ul><li><a href="https://www.programmercarl.com/%E5%89%8D%E5%BA%8F/ACM%E6%A8%A1%E5%BC%8F%E5%A6%82%E4%BD%95%E6%9E%84%E5%BB%BA%E4%BA%8C%E5%8F%89%E6%A0%91.html#java">力扣上如何自己构造二叉树输入用例 | 代码随想录 </a></li></ul><h3 id="算法思路"><a href="#算法思路" class="headerlink" title="算法思路"></a>算法思路</h3><p>将要打印的树以Vector数组输入，再遍历一遍，将顺序存储变为链式存储即可。</p><blockquote><p>注意: 结束规则是 i * 2 + 1 &lt; vec.size()，是将下面 if (i * 2 + 1 &lt; vec.size())进行了省略，放到了for循环里面。</p></blockquote><blockquote><p>为什么结束规则不能是i * 2 + 2 &lt; arr.length呢 ?<br>因为如果i * 2 + 2 &lt; arr.length 是结束条件，那么i * 2 + 1这个符合条件的节点就被忽略掉了。<br>例如 [2,7,9,-1,1,9,6,-1,-1,10]  这样的一个二叉树, 最后的10就会被忽略掉。</p></blockquote><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;bits/stdc++.h></span></span>using namespace std<span class="token punctuation">;</span><span class="token keyword">struct</span> <span class="token class-name">TreeNode</span><span class="token punctuation">&#123;</span><span class="token keyword">int</span> val<span class="token punctuation">;</span>TreeNode <span class="token operator">*</span>left<span class="token punctuation">;</span>TreeNode <span class="token operator">*</span>right<span class="token punctuation">;</span><span class="token function">TreeNode</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">val</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">left</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">right</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>TreeNode<span class="token operator">*</span> <span class="token function">construct_binary_tree</span><span class="token punctuation">(</span><span class="token keyword">const</span> vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token operator">&amp;</span>vec<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>vector<span class="token operator">&lt;</span>TreeNode<span class="token operator">*</span><span class="token operator">></span> <span class="token function">vecTree</span><span class="token punctuation">(</span>vec<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>TreeNode<span class="token operator">*</span> root <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> vec<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>TreeNode<span class="token operator">*</span> node <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span> <span class="token keyword">if</span><span class="token punctuation">(</span>vec<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> node <span class="token operator">=</span> new <span class="token function">TreeNode</span><span class="token punctuation">(</span>vec<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>vecTree<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> node<span class="token punctuation">;</span> <span class="token keyword">if</span><span class="token punctuation">(</span>i <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> root <span class="token operator">=</span> node<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">&lt;</span> vec<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">if</span><span class="token punctuation">(</span>vecTree<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>vecTree<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">-></span>left <span class="token operator">=</span> vecTree<span class="token punctuation">[</span>i <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span>i <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token number">2</span> <span class="token operator">&lt;</span> vec<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>vecTree<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">-></span>right <span class="token operator">=</span> vecTree<span class="token punctuation">[</span>i <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">return</span> root<span class="token punctuation">;</span><span class="token punctuation">&#125;</span>class Solution <span class="token punctuation">&#123;</span>public<span class="token operator">:</span>    <span class="token comment">// 层序打印打印二叉树</span>    <span class="token keyword">void</span> <span class="token function">print_binary_tree</span><span class="token punctuation">(</span>TreeNode<span class="token operator">*</span> root<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        queue<span class="token operator">&lt;</span>TreeNode<span class="token operator">*</span><span class="token operator">></span> que<span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>root <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> que<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span><span class="token punctuation">;</span>        vector<span class="token operator">&lt;</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">>></span> result<span class="token punctuation">;</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span>que<span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">int</span> size <span class="token operator">=</span> que<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> vec<span class="token punctuation">;</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> size<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                TreeNode<span class="token operator">*</span> node <span class="token operator">=</span> que<span class="token punctuation">.</span><span class="token function">front</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                que<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>node <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    vec<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>node<span class="token operator">-></span>val<span class="token punctuation">)</span><span class="token punctuation">;</span>                    que<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>node<span class="token operator">-></span>left<span class="token punctuation">)</span><span class="token punctuation">;</span>                    que<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>node<span class="token operator">-></span>right<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>                <span class="token comment">// 这里的处理逻辑是为了把null节点打印出来，用-1 表示null</span>                <span class="token keyword">else</span> vec<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            result<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>vec<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> result<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> result<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                cout <span class="token operator">&lt;&lt;</span> result<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            cout <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> vec <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    TreeNode<span class="token operator">*</span> root <span class="token operator">=</span> <span class="token function">construct_binary_tree</span><span class="token punctuation">(</span>vec<span class="token punctuation">)</span><span class="token punctuation">;</span>    Solution solution<span class="token punctuation">;</span>solution<span class="token punctuation">.</span><span class="token function">print_binary_tree</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="二叉树的最大深度"><a href="#二叉树的最大深度" class="headerlink" title="二叉树的最大深度"></a>二叉树的最大深度</h2><h3 id="相关链接"><a href="#相关链接" class="headerlink" title="相关链接"></a>相关链接</h3><ul><li><a href="https://leetcode.cn/problems/maximum-depth-of-binary-tree/">二叉树的最大深度</a></li></ul><h3 id="相关题目"><a href="#相关题目" class="headerlink" title="相关题目"></a>相关题目</h3><p>给定一个二叉树，找出其最大深度。</p><p>二叉树的深度为根节点到最远叶子节点的最长路径上的节点数。</p><p><strong>说明:</strong> 叶子节点是指没有子节点的节点。</p><p><strong>示例:</strong> 给定二叉树 <code>[3,9,20,null,null,15,7]</code>，返回它的最大深度 3 。</p><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">  3 / \9  20  /  \ 15   7<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="解题思路"><a href="#解题思路" class="headerlink" title="解题思路"></a>解题思路</h3><h4 id="写法1"><a href="#写法1" class="headerlink" title="写法1"></a>写法1</h4><ul><li>递归的参数：根结点与递归的层数</li><li>返回条件是：当前为叶子节点 或是 返回左右子树的深度最大值</li><li>进行递归的条件是：左右子树不为空</li></ul><pre class="line-numbers language-c" data-language="c"><code class="language-c">class Solution <span class="token punctuation">&#123;</span>public<span class="token operator">:</span>    <span class="token keyword">int</span> <span class="token function">dfs</span><span class="token punctuation">(</span>TreeNode<span class="token operator">*</span> root<span class="token punctuation">,</span> <span class="token keyword">int</span> cnt<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>root<span class="token operator">-></span>left <span class="token operator">==</span> nullptr <span class="token operator">&amp;&amp;</span> root<span class="token operator">-></span>right <span class="token operator">==</span> nullptr<span class="token punctuation">)</span> <span class="token keyword">return</span> cnt<span class="token punctuation">;</span>        <span class="token keyword">int</span> l <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> r <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>root<span class="token operator">-></span>left<span class="token punctuation">)</span>  l <span class="token operator">=</span> <span class="token function">dfs</span><span class="token punctuation">(</span>root<span class="token operator">-></span>left<span class="token punctuation">,</span> cnt <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>root<span class="token operator">-></span>right<span class="token punctuation">)</span> r <span class="token operator">=</span> <span class="token function">dfs</span><span class="token punctuation">(</span>root<span class="token operator">-></span>right<span class="token punctuation">,</span> cnt <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token function">max</span><span class="token punctuation">(</span>l<span class="token punctuation">,</span> r<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">int</span> <span class="token function">maxDepth</span><span class="token punctuation">(</span>TreeNode<span class="token operator">*</span> root<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>root<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token function">dfs</span><span class="token punctuation">(</span>root<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="写法2"><a href="#写法2" class="headerlink" title="写法2"></a>写法2</h4><p>但是写法1太过冗余，可以继续进行精简</p><ul><li>递归的参数：根结点与递归的层数，需要注意：<ul><li>如果初始传入递归层数参数为1，当递归到空节点时应该为返回上一层的层数，结束条件应该为return cnt - 1;</li><li>如果初始递归层数参数为0，当递归到空节点时正好为返回当层的层数，结束条件应该为return cnt；</li></ul></li><li>返回条件是：当前节点为空节点 或是 返回左右子树的深度最大值</li><li>递归的条件可以进行取消，因为节点为空节点才进行返回</li></ul><pre class="line-numbers language-c" data-language="c"><code class="language-c">class Solution <span class="token punctuation">&#123;</span>public<span class="token operator">:</span>    <span class="token keyword">int</span> <span class="token function">dfs</span><span class="token punctuation">(</span>TreeNode<span class="token operator">*</span> root<span class="token punctuation">,</span> <span class="token keyword">int</span> cnt<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>root<span class="token punctuation">)</span> <span class="token keyword">return</span> cnt<span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token function">max</span><span class="token punctuation">(</span><span class="token function">dfs</span><span class="token punctuation">(</span>root<span class="token operator">-></span>left<span class="token punctuation">,</span> cnt <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">dfs</span><span class="token punctuation">(</span>root<span class="token operator">-></span>right<span class="token punctuation">,</span> cnt <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">int</span> <span class="token function">maxDepth</span><span class="token punctuation">(</span>TreeNode<span class="token operator">*</span> root<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>root<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token function">dfs</span><span class="token punctuation">(</span>root<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="写法3"><a href="#写法3" class="headerlink" title="写法3"></a>写法3</h4><p>写法2仍然多定义了dfs函数，显得冗余，可以不定义dfs函数，将cnt层数这个参数提取出来，直接在maxDepth进行递归。</p><pre class="line-numbers language-c" data-language="c"><code class="language-c">class Solution <span class="token punctuation">&#123;</span>public<span class="token operator">:</span>    <span class="token keyword">int</span> <span class="token function">maxDepth</span><span class="token punctuation">(</span>TreeNode<span class="token operator">*</span> root<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>root<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token function">max</span><span class="token punctuation">(</span><span class="token function">maxDepth</span><span class="token punctuation">(</span>root<span class="token operator">-></span>left<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">maxDepth</span><span class="token punctuation">(</span>root<span class="token operator">-></span>right<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="二叉树每层的最大值"><a href="#二叉树每层的最大值" class="headerlink" title="二叉树每层的最大值"></a>二叉树每层的最大值</h2><h3 id="相关链接-1"><a href="#相关链接-1" class="headerlink" title="相关链接"></a>相关链接</h3><ul><li><a href="https://leetcode.cn/problems/hPov7L/">二叉树每层的最大值</a></li></ul><h3 id="相关题目-1"><a href="#相关题目-1" class="headerlink" title="相关题目"></a>相关题目</h3><p>给定一棵二叉树的根节点 <code>root</code> ，请找出该二叉树中每一层的最大值。</p><p><strong>示例1：</strong></p><pre class="line-numbers language-none"><code class="language-none">输入: root &#x3D; [1,3,2,5,3,null,9]输出: [1,3,9]解释:          1         &#x2F; \        3   2       &#x2F; \   \        5   3   9 <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="解题思路-1"><a href="#解题思路-1" class="headerlink" title="解题思路"></a>解题思路</h3><h4 id="写法1-1"><a href="#写法1-1" class="headerlink" title="写法1"></a>写法1</h4><p>深度优先遍历，思路与求二叉树最大值一样，但是多传递一个h参数表示当前的高度，通过当时h来找到此时这层高度存储的最大值，进行比较。需要注意的是，当第一次结果数组等于树的高度时候，要在结果数组内放入当前元素，以后才能通过下标访问！</p><pre class="line-numbers language-c" data-language="c"><code class="language-c">class Solution <span class="token punctuation">&#123;</span>public<span class="token operator">:</span>    <span class="token keyword">void</span> <span class="token function">dfs</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token operator">&amp;</span> res<span class="token punctuation">,</span> TreeNode<span class="token operator">*</span> root<span class="token punctuation">,</span> <span class="token keyword">int</span> h<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> h<span class="token punctuation">)</span> res<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>root<span class="token operator">-></span>val<span class="token punctuation">)</span><span class="token punctuation">;</span>        res<span class="token punctuation">[</span>h<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">max</span><span class="token punctuation">(</span>res<span class="token punctuation">[</span>h<span class="token punctuation">]</span><span class="token punctuation">,</span> root<span class="token operator">-></span>val<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>root<span class="token operator">-></span>left<span class="token punctuation">)</span> <span class="token function">dfs</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> root<span class="token operator">-></span>left<span class="token punctuation">,</span> h <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>root<span class="token operator">-></span>right<span class="token punctuation">)</span>  <span class="token function">dfs</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> root<span class="token operator">-></span>right<span class="token punctuation">,</span> h <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token function">largestValues</span><span class="token punctuation">(</span>TreeNode<span class="token operator">*</span> root<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>root<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>        vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> res<span class="token punctuation">;</span>        <span class="token function">dfs</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> root<span class="token punctuation">,</span> h<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> res<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="写法2-1"><a href="#写法2-1" class="headerlink" title="写法2"></a>写法2</h4><p>广度优先遍历，与深度优先遍历一个一个比较不同的是，广度优先遍历是通过一层一层的比较的</p><pre class="line-numbers language-c" data-language="c"><code class="language-c">class Solution <span class="token punctuation">&#123;</span>public<span class="token operator">:</span>    vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token function">largestValues</span><span class="token punctuation">(</span>TreeNode<span class="token operator">*</span> root<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>root<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>        vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> res<span class="token punctuation">;</span>        queue<span class="token operator">&lt;</span>TreeNode<span class="token operator">*</span><span class="token operator">></span> q<span class="token punctuation">;</span>        q<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token operator">!</span>q<span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">int</span> len <span class="token operator">=</span> q<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">int</span> MAX <span class="token operator">=</span> INT_MIN<span class="token punctuation">;</span>            <span class="token keyword">while</span><span class="token punctuation">(</span>len<span class="token operator">--</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token keyword">auto</span> t <span class="token operator">=</span> q<span class="token punctuation">.</span><span class="token function">front</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                q<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                MAX <span class="token operator">=</span> <span class="token function">max</span><span class="token punctuation">(</span>MAX<span class="token punctuation">,</span> t<span class="token operator">-></span>val<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>t<span class="token operator">-></span>left<span class="token punctuation">)</span> q<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>t<span class="token operator">-></span>left<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>t<span class="token operator">-></span>right<span class="token punctuation">)</span> q<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>t<span class="token operator">-></span>right<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            res<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>MAX<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> res<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="二叉树最底层最左边的值"><a href="#二叉树最底层最左边的值" class="headerlink" title="二叉树最底层最左边的值"></a>二叉树最底层最左边的值</h2><h3 id="相关链接-2"><a href="#相关链接-2" class="headerlink" title="相关链接"></a>相关链接</h3><ul><li><a href="https://leetcode.cn/problems/LwUNpT/">二叉树最底层最左边的值</a></li></ul><h3 id="相关题目-2"><a href="#相关题目-2" class="headerlink" title="相关题目"></a>相关题目</h3><p>给定一个二叉树的 <strong>根节点</strong> <code>root</code>，请找出该二叉树的 <strong>最底层 最左边</strong> 节点的值。</p><p>假设二叉树中至少有一个节点。</p><p><strong>示例1：</strong></p><img src="/images/%E6%A0%91-%E7%AE%97%E6%B3%95%E4%B8%93%E9%A2%98/image-20221101100946583.png" alt="示例1" style="zoom: 50%;box-shadow:rgba(0,0,0,0) 0 0px 0px 0px;" /><pre class="line-numbers language-none"><code class="language-none">输入: root &#x3D; [2,1,3]输出: 1<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><strong>示例2：</strong></p><img src="/images/%E6%A0%91-%E7%AE%97%E6%B3%95%E4%B8%93%E9%A2%98/image-20221101101037177.png" alt="示例2" style="zoom:55%;box-shadow:rgba(0,0,0,0) 0 0px 0px 0px;" /><pre class="line-numbers language-none"><code class="language-none">输入: [1,2,3,4,null,5,6,null,null,7]输出: 7<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="解答思路"><a href="#解答思路" class="headerlink" title="解答思路"></a>解答思路</h3><h4 id="写法1-2"><a href="#写法1-2" class="headerlink" title="写法1"></a>写法1</h4><p>深度优先遍历：当最大高度超过当前高度后才开始更新 最底层 最左边 的值</p><pre class="line-numbers language-c" data-language="c"><code class="language-c">class Solution <span class="token punctuation">&#123;</span>public<span class="token operator">:</span>    <span class="token keyword">int</span> cur_val <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> max_h <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">void</span> <span class="token function">dfs</span><span class="token punctuation">(</span>TreeNode<span class="token operator">*</span> root<span class="token punctuation">,</span><span class="token keyword">int</span> h<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>root<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>         h<span class="token operator">++</span><span class="token punctuation">;</span>        <span class="token function">dfs</span><span class="token punctuation">(</span>root<span class="token operator">-></span>left<span class="token punctuation">,</span> h<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">dfs</span><span class="token punctuation">(</span>root<span class="token operator">-></span>right<span class="token punctuation">,</span> h<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>h <span class="token operator">></span> max_h<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            max_h <span class="token operator">=</span> h<span class="token punctuation">;</span>            cur_val <span class="token operator">=</span> root<span class="token operator">-></span>val<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">int</span> <span class="token function">findBottomLeftValue</span><span class="token punctuation">(</span>TreeNode<span class="token operator">*</span> root<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">dfs</span><span class="token punctuation">(</span>root<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> cur_val<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>需要注意的是</strong></p><p><code>h++</code>应该写在遍历左右子树之前，不应该在<code>dfs(root-&gt;left, ++h);dfs(root-&gt;right, ++h);</code>，后者会在遍历左子树后再加左子树的高度上加1，导致错误。</p><h4 id="写法2-2"><a href="#写法2-2" class="headerlink" title="写法2"></a>写法2</h4><p>在遍历一个节点时，需要先把它的非空右子节点放入队列，然后再把它的非空左子节点放入队列，这样才能保证从右到左遍历每一层的节点。广度优先搜索所遍历的最后一个节点的值就是最底层最左边节点的值。</p><pre class="line-numbers language-c" data-language="c"><code class="language-c">class Solution <span class="token punctuation">&#123;</span>public<span class="token operator">:</span>    <span class="token keyword">int</span> <span class="token function">findBottomLeftValue</span><span class="token punctuation">(</span>TreeNode<span class="token operator">*</span> root<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        queue<span class="token operator">&lt;</span>TreeNode<span class="token operator">*</span><span class="token operator">></span> q<span class="token punctuation">;</span>        q<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> val<span class="token punctuation">;</span>        <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token operator">!</span>q<span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            TreeNode<span class="token operator">*</span> t <span class="token operator">=</span> q<span class="token punctuation">.</span><span class="token function">front</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            q<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            val <span class="token operator">=</span> t<span class="token operator">-></span>val<span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>t<span class="token operator">-></span>right<span class="token punctuation">)</span> q<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>t<span class="token operator">-></span>right<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>t<span class="token operator">-></span>left<span class="token punctuation">)</span> q<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>t<span class="token operator">-></span>left<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> val<span class="token punctuation">;</span>     <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="易错点"><a href="#易错点" class="headerlink" title="易错点"></a>易错点</h4><p>二叉树的 <strong>最底层 最左边</strong> 节点的值不一定就是<strong>最左边</strong>的点，如下图示例2所示，最左边的点为4，最底层最左边点为 7，两者并不相同，并且求最左边的点可以重新出题为<strong>返回先序遍历的第一个点</strong>。</p><img src="/images/%E6%A0%91-%E7%AE%97%E6%B3%95%E4%B8%93%E9%A2%98/image-20221101101037177.png" alt="示例2" style="zoom:55%;box-shadow:rgba(0,0,0,0) 0 0px 0px 0px;" /><p>求最左边的点代码如下，可以出题为<strong>返回先序遍历的第一个点</strong></p><pre class="line-numbers language-c" data-language="c"><code class="language-c">class Solution <span class="token punctuation">&#123;</span>public<span class="token operator">:</span>    <span class="token keyword">int</span> <span class="token function">findBottomLeftValue</span><span class="token punctuation">(</span>TreeNode<span class="token operator">*</span> root<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">auto</span> t <span class="token operator">=</span> root<span class="token punctuation">;</span>        <span class="token keyword">while</span><span class="token punctuation">(</span>t<span class="token operator">-></span>left <span class="token operator">||</span> t<span class="token operator">-></span>right<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">while</span><span class="token punctuation">(</span>t<span class="token operator">-></span>left<span class="token punctuation">)</span> t <span class="token operator">=</span> t<span class="token operator">-></span>left<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> t<span class="token operator">-></span>val<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>如果是<strong>返回后序遍历的第一个点，</strong>求法如下：</p><pre class="line-numbers language-c" data-language="c"><code class="language-c">class Solution <span class="token punctuation">&#123;</span>public<span class="token operator">:</span>    <span class="token keyword">int</span> <span class="token function">findBottomLeftValue</span><span class="token punctuation">(</span>TreeNode<span class="token operator">*</span> root<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">auto</span> t <span class="token operator">=</span> root<span class="token punctuation">;</span>        <span class="token keyword">while</span><span class="token punctuation">(</span>t<span class="token operator">-></span>left <span class="token operator">||</span> t<span class="token operator">-></span>right<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">while</span><span class="token punctuation">(</span>t<span class="token operator">-></span>left<span class="token punctuation">)</span> t <span class="token operator">=</span> t<span class="token operator">-></span>left<span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>t<span class="token operator">-></span>right<span class="token punctuation">)</span> t <span class="token operator">=</span> t<span class="token operator">-></span>right<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> t<span class="token operator">-></span>val<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> 算法 </category>
          
          <category> C++ </category>
          
          <category> 树 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 算法 </tag>
            
            <tag> C++ </tag>
            
            <tag> 树 </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
